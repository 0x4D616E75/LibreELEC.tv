diff -Naur xorg-server-20091215/composite/Makefile.in xorg-server-20091215.patch/composite/Makefile.in
--- xorg-server-20091215/composite/Makefile.in	2009-12-15 20:10:05.000000000 +0100
+++ xorg-server-20091215.patch/composite/Makefile.in	2009-12-15 23:04:50.392321137 +0100
@@ -290,6 +290,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/config/config-backends.h xorg-server-20091215.patch/config/config-backends.h
--- xorg-server-20091215/config/config-backends.h	2009-12-14 23:34:15.000000000 +0100
+++ xorg-server-20091215.patch/config/config-backends.h	2009-12-15 23:04:05.471323673 +0100
@@ -26,8 +26,18 @@
 #ifdef HAVE_DIX_CONFIG_H
 #include <dix-config.h>
 #endif
+#include "input.h"
 
-#ifdef CONFIG_NEED_DBUS
+void remove_devices(const char *backend, const char *config_info);
+BOOL device_is_duplicate(const char *config_info);
+void add_option(InputOption **options, const char *key, const char *value);
+
+#ifdef CONFIG_UDEV
+int config_udev_init(void);
+void config_udev_fini(void);
+#else
+
+# ifdef CONFIG_NEED_DBUS
 #include <dbus/dbus.h>
 
 typedef void (*config_dbus_core_connect_hook)(DBusConnection *connection,
@@ -46,14 +56,15 @@
 void config_dbus_core_fini(void);
 int config_dbus_core_add_hook(struct config_dbus_core_hook *hook);
 void config_dbus_core_remove_hook(struct config_dbus_core_hook *hook);
-#endif
+# endif
 
-#ifdef CONFIG_DBUS_API
+# ifdef CONFIG_DBUS_API
 int config_dbus_init(void);
 void config_dbus_fini(void);
-#endif
+# endif
 
-#ifdef CONFIG_HAL
+# ifdef CONFIG_HAL
 int config_hal_init(void);
 void config_hal_fini(void);
+# endif
 #endif
diff -Naur xorg-server-20091215/config/config.c xorg-server-20091215.patch/config/config.c
--- xorg-server-20091215/config/config.c	2009-12-14 23:34:15.000000000 +0100
+++ xorg-server-20091215.patch/config/config.c	2009-12-15 23:04:05.472323723 +0100
@@ -28,13 +28,17 @@
 #endif
 
 #include "os.h"
+#include "inputstr.h"
 #include "hotplug.h"
 #include "config-backends.h"
 
 void
 config_init(void)
 {
-#if defined(CONFIG_DBUS_API) || defined(CONFIG_HAL)
+#ifdef CONFIG_UDEV
+    if (!config_udev_init())
+        ErrorF("[config] failed to initialise udev\n");
+#elif defined(CONFIG_NEED_DBUS)
     if (config_dbus_core_init()) {
 # ifdef CONFIG_DBUS_API
        if (!config_dbus_init())
@@ -54,7 +58,9 @@
 void
 config_fini(void)
 {
-#if defined(CONFIG_DBUS_API) || defined(CONFIG_HAL)
+#if defined(CONFIG_UDEV)
+    config_udev_fini();
+#elif defined(CONFIG_NEED_DBUS)
 # ifdef CONFIG_HAL
     config_hal_fini();
 # endif
@@ -64,3 +70,70 @@
     config_dbus_core_fini();
 #endif
 }
+
+static void
+remove_device(const char *backend, DeviceIntPtr dev)
+{
+    /* this only gets called for devices that have already been added */
+    LogMessage(X_INFO, "config/%s: removing device %s\n", backend, dev->name);
+
+    /* Call PIE here so we don't try to dereference a device that's
+     * already been removed. */
+    OsBlockSignals();
+    ProcessInputEvents();
+    DeleteInputDeviceRequest(dev);
+    OsReleaseSignals();
+}
+
+void
+remove_devices(const char *backend, const char *config_info)
+{
+    DeviceIntPtr dev, next;
+
+    for (dev = inputInfo.devices; dev; dev = next) {
+        next = dev->next;
+        if (dev->config_info && strcmp(dev->config_info, config_info) == 0)
+            remove_device(backend, dev);
+    }
+    for (dev = inputInfo.off_devices; dev; dev = next) {
+        next = dev->next;
+        if (dev->config_info && strcmp(dev->config_info, config_info) == 0)
+            remove_device(backend, dev);
+    }
+}
+
+BOOL
+device_is_duplicate(const char *config_info)
+{
+    DeviceIntPtr dev;
+
+    for (dev = inputInfo.devices; dev; dev = dev->next)
+    {
+        if (dev->config_info && (strcmp(dev->config_info, config_info) == 0))
+            return TRUE;
+    }
+
+    for (dev = inputInfo.off_devices; dev; dev = dev->next)
+    {
+        if (dev->config_info && (strcmp(dev->config_info, config_info) == 0))
+            return TRUE;
+    }
+
+    return FALSE;
+}
+
+void
+add_option(InputOption **options, const char *key, const char *value)
+{
+    if (!value || *value == '\0')
+        return;
+
+    for (; *options; options = &(*options)->next)
+        ;
+    *options = xcalloc(sizeof(**options), 1);
+    if (!*options) /* Yeesh. */
+        return;
+    (*options)->key = xstrdup(key);
+    (*options)->value = xstrdup(value);
+    (*options)->next = NULL;
+}
diff -Naur xorg-server-20091215/config/hal.c xorg-server-20091215.patch/config/hal.c
--- xorg-server-20091215/config/hal.c	2009-12-14 23:34:15.000000000 +0100
+++ xorg-server-20091215.patch/config/hal.c	2009-12-15 23:04:05.472323723 +0100
@@ -58,25 +58,9 @@
     char* options;
 };
 
-
-static void
-remove_device(DeviceIntPtr dev)
-{
-    /* this only gets called for devices that have already been added */
-    LogMessage(X_INFO, "config/hal: removing device %s\n", dev->name);
-
-    /* Call PIE here so we don't try to dereference a device that's
-     * already been removed. */
-    OsBlockSignals();
-    ProcessInputEvents();
-    DeleteInputDeviceRequest(dev);
-    OsReleaseSignals();
-}
-
 static void
 device_removed(LibHalContext *ctx, const char *udi)
 {
-    DeviceIntPtr dev, next;
     char *value;
 
     value = xalloc(strlen(udi) + 5); /* "hal:" + NULL */
@@ -84,36 +68,11 @@
         return;
     sprintf(value, "hal:%s", udi);
 
-    for (dev = inputInfo.devices; dev; dev = next) {
-	next = dev->next;
-        if (dev->config_info && strcmp(dev->config_info, value) == 0)
-            remove_device(dev);
-    }
-    for (dev = inputInfo.off_devices; dev; dev = next) {
-	next = dev->next;
-        if (dev->config_info && strcmp(dev->config_info, value) == 0)
-            remove_device(dev);
-    }
+    remove_devices("hal", value);
 
     xfree(value);
 }
 
-static void
-add_option(InputOption **options, const char *key, const char *value)
-{
-    if (!value || *value == '\0')
-        return;
-
-    for (; *options; options = &(*options)->next)
-        ;
-    *options = xcalloc(sizeof(**options), 1);
-    if (!*options) /* Yeesh. */
-        return;
-    (*options)->key = xstrdup(key);
-    (*options)->value = xstrdup(value);
-    (*options)->next = NULL;
-}
-
 static char *
 get_prop_string(LibHalContext *hal_ctx, const char *udi, const char *name)
 {
@@ -166,26 +125,6 @@
     return ret;
 }
 
-static BOOL
-device_is_duplicate(char *config_info)
-{
-    DeviceIntPtr dev;
-
-    for (dev = inputInfo.devices; dev; dev = dev->next)
-    {
-        if (dev->config_info && (strcmp(dev->config_info, config_info) == 0))
-            return TRUE;
-    }
-
-    for (dev = inputInfo.off_devices; dev; dev = dev->next)
-    {
-        if (dev->config_info && (strcmp(dev->config_info, config_info) == 0))
-            return TRUE;
-    }
-
-    return FALSE;
-}
-
 static void
 device_added(LibHalContext *hal_ctx, const char *udi)
 {
diff -Naur xorg-server-20091215/config/Makefile.am xorg-server-20091215.patch/config/Makefile.am
--- xorg-server-20091215/config/Makefile.am	2009-12-14 23:34:15.000000000 +0100
+++ xorg-server-20091215.patch/config/Makefile.am	2009-12-15 23:04:05.470323484 +0100
@@ -3,10 +3,18 @@
 noinst_LTLIBRARIES = libconfig.la
 libconfig_la_SOURCES = config.c config-backends.h
 
+if CONFIG_UDEV
+
+AM_CFLAGS += @UDEV_CFLAGS@
+libconfig_la_SOURCES += udev.c
+libconfig_la_LIBADD = @UDEV_LIBS@
+
+else
+
 if CONFIG_NEED_DBUS
 AM_CFLAGS += @DBUS_CFLAGS@
 libconfig_la_SOURCES += dbus-core.c
-endif
+libconfig_la_LIBADD = @DBUS_LIBS@
 
 if CONFIG_DBUS_API
 dbusconfigdir = $(sysconfdir)/dbus-1/system.d
@@ -16,7 +24,13 @@
 endif
 
 if CONFIG_HAL
+AM_CFLAGS += @HAL_CFLAGS@
 libconfig_la_SOURCES += hal.c
+libconfig_la_LIBADD += @HAL_LIBS@
 endif
 
+endif # CONFIG_NEED_DBUS
+
+endif # !CONFIG_UDEV
+
 EXTRA_DIST = xorg-server.conf x11-input.fdi
diff -Naur xorg-server-20091215/config/Makefile.in xorg-server-20091215.patch/config/Makefile.in
--- xorg-server-20091215/config/Makefile.in	2009-12-15 20:10:06.000000000 +0100
+++ xorg-server-20091215.patch/config/Makefile.in	2009-12-15 23:04:50.575321129 +0100
@@ -35,10 +35,14 @@
 POST_UNINSTALL = :
 build_triplet = @build@
 host_triplet = @host@
-@CONFIG_NEED_DBUS_TRUE@am__append_1 = @DBUS_CFLAGS@
-@CONFIG_NEED_DBUS_TRUE@am__append_2 = dbus-core.c
-@CONFIG_DBUS_API_TRUE@am__append_3 = dbus.c
-@CONFIG_HAL_TRUE@am__append_4 = hal.c
+@CONFIG_UDEV_TRUE@am__append_1 = @UDEV_CFLAGS@
+@CONFIG_UDEV_TRUE@am__append_2 = udev.c
+@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@am__append_3 = @DBUS_CFLAGS@
+@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@am__append_4 = dbus-core.c
+@CONFIG_DBUS_API_TRUE@@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@am__append_5 = dbus.c
+@CONFIG_HAL_TRUE@@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@am__append_6 = @HAL_CFLAGS@
+@CONFIG_HAL_TRUE@@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@am__append_7 = hal.c
+@CONFIG_HAL_TRUE@@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@am__append_8 = @HAL_LIBS@
 subdir = config
 DIST_COMMON = $(srcdir)/Makefile.am $(srcdir)/Makefile.in
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
@@ -61,14 +65,18 @@
 CONFIG_CLEAN_FILES =
 CONFIG_CLEAN_VPATH_FILES =
 LTLIBRARIES = $(noinst_LTLIBRARIES)
-libconfig_la_LIBADD =
-am__libconfig_la_SOURCES_DIST = config.c config-backends.h dbus-core.c \
-	dbus.c hal.c
-@CONFIG_NEED_DBUS_TRUE@am__objects_1 = dbus-core.lo
-@CONFIG_DBUS_API_TRUE@am__objects_2 = dbus.lo
-@CONFIG_HAL_TRUE@am__objects_3 = hal.lo
+am__DEPENDENCIES_1 =
+@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@libconfig_la_DEPENDENCIES = $(am__DEPENDENCIES_1)
+@CONFIG_UDEV_TRUE@libconfig_la_DEPENDENCIES = $(am__DEPENDENCIES_1)
+am__libconfig_la_SOURCES_DIST = config.c config-backends.h udev.c \
+	dbus-core.c dbus.c hal.c
+@CONFIG_UDEV_TRUE@am__objects_1 = udev.lo
+@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@am__objects_2 =  \
+@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@	dbus-core.lo
+@CONFIG_DBUS_API_TRUE@@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@am__objects_3 = dbus.lo
+@CONFIG_HAL_TRUE@@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@am__objects_4 = hal.lo
 am_libconfig_la_OBJECTS = config.lo $(am__objects_1) $(am__objects_2) \
-	$(am__objects_3)
+	$(am__objects_3) $(am__objects_4)
 libconfig_la_OBJECTS = $(am_libconfig_la_OBJECTS)
 AM_V_lt = $(am__v_lt_$(V))
 am__v_lt_ = $(am__v_lt_$(AM_DEFAULT_VERBOSITY))
@@ -297,6 +305,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
@@ -420,12 +430,17 @@
 top_build_prefix = @top_build_prefix@
 top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
-AM_CFLAGS = @DIX_CFLAGS@ $(am__append_1)
+AM_CFLAGS = @DIX_CFLAGS@ $(am__append_1) $(am__append_3) \
+	$(am__append_6)
 noinst_LTLIBRARIES = libconfig.la
 libconfig_la_SOURCES = config.c config-backends.h $(am__append_2) \
-	$(am__append_3) $(am__append_4)
-@CONFIG_DBUS_API_TRUE@dbusconfigdir = $(sysconfdir)/dbus-1/system.d
-@CONFIG_DBUS_API_TRUE@dbusconfig_DATA = xorg-server.conf
+	$(am__append_4) $(am__append_5) $(am__append_7)
+@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@libconfig_la_LIBADD =  \
+@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@	@DBUS_LIBS@ \
+@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@	$(am__append_8)
+@CONFIG_UDEV_TRUE@libconfig_la_LIBADD = @UDEV_LIBS@ $(am__append_8)
+@CONFIG_DBUS_API_TRUE@@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@dbusconfigdir = $(sysconfdir)/dbus-1/system.d
+@CONFIG_DBUS_API_TRUE@@CONFIG_NEED_DBUS_TRUE@@CONFIG_UDEV_FALSE@dbusconfig_DATA = xorg-server.conf
 EXTRA_DIST = xorg-server.conf x11-input.fdi
 all: all-am
 
@@ -483,6 +498,7 @@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/dbus-core.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/dbus.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/hal.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/udev.Plo@am__quote@
 
 .c.o:
 @am__fastdepCC_TRUE@	$(AM_V_CC)$(COMPILE) -MT $@ -MD -MP -MF $(DEPDIR)/$*.Tpo -c -o $@ $<
diff -Naur xorg-server-20091215/config/udev.c xorg-server-20091215.patch/config/udev.c
--- xorg-server-20091215/config/udev.c	1970-01-01 01:00:00.000000000 +0100
+++ xorg-server-20091215.patch/config/udev.c	2009-12-15 23:04:05.473321747 +0100
@@ -0,0 +1,245 @@
+/*
+ * Copyright Â© 2009 Julien Cristau
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a
+ * copy of this software and associated documentation files (the "Software"),
+ * to deal in the Software without restriction, including without limitation
+ * the rights to use, copy, modify, merge, publish, distribute, sublicense,
+ * and/or sell copies of the Software, and to permit persons to whom the
+ * Software is furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice (including the next
+ * paragraph) shall be included in all copies or substantial portions of the
+ * Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
+ * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
+ * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
+ * DEALINGS IN THE SOFTWARE.
+ *
+ * Author: Julien Cristau <jcristau at debian.org>
+ */
+
+#ifdef HAVE_DIX_CONFIG_H
+#include <dix-config.h>
+#endif
+
+#include <libudev.h>
+
+#include "input.h"
+#include "inputstr.h"
+#include "hotplug.h"
+#include "config-backends.h"
+#include "os.h"
+
+#define UDEV_XKB_PROP_KEY "xkb"
+#define UDEV_PROP_KEY "x11_options."
+
+static struct udev_monitor *udev_monitor;
+
+static void
+device_added(struct udev_device *udev_device)
+{
+    const char *path = NULL, *driver = NULL, *name = NULL;
+    char *config_info = NULL;
+    const char *syspath;
+    const char *key, *value, *tmp;
+    InputOption *options = NULL, *tmpo;
+    DeviceIntPtr dev = NULL;
+    struct udev_list_entry *set, *entry;
+    struct udev_device *parent;
+    int rc;
+
+    driver = udev_device_get_property_value(udev_device, "x11_driver");
+
+    path = udev_device_get_devnode(udev_device);
+
+    syspath = udev_device_get_syspath(udev_device);
+
+    parent = udev_device_get_parent(udev_device);
+    if (parent)
+        name = udev_device_get_property_value(parent, "NAME");
+    else
+        name = "(unnamed)";
+
+    if (!driver || !path || !syspath)
+        return;
+    options = xcalloc(sizeof(*options), 1);
+    if (!options)
+        return;
+
+    options->key = xstrdup("_source");
+    options->value = xstrdup("server/udev");
+    if (!options->key || !options->value)
+        goto unwind;
+
+    add_option(&options, "path", path);
+    add_option(&options, "device", path);
+    add_option(&options, "driver", driver);
+
+    config_info = Xprintf("udev:%s", syspath);
+    if (!config_info)
+        goto unwind;
+
+    if (device_is_duplicate(config_info)) {
+        LogMessage(X_WARNING, "config/udev: device %s already added. "
+                              "Ignoring.\n", name);
+        goto unwind;
+    }
+
+    set = udev_device_get_properties_list_entry(udev_device);
+    udev_list_entry_foreach(entry, set) {
+        key = udev_list_entry_get_name(entry);
+        if (!key)
+            continue;
+        if (!strncasecmp(key, UDEV_PROP_KEY, sizeof(UDEV_PROP_KEY) - 1)) {
+            value = udev_list_entry_get_value(entry);
+            add_option(&options, key + sizeof(UDEV_PROP_KEY) - 1, value);
+        } else if (!strncasecmp(key, UDEV_XKB_PROP_KEY,
+                                sizeof(UDEV_XKB_PROP_KEY) - 1)) {
+            tmp = key + sizeof(UDEV_XKB_PROP_KEY) - 1;
+            value = udev_list_entry_get_value(entry);
+            if (!strcasecmp(tmp, "rules"))
+                add_option(&options, "xkb_rules", value);
+            else if (!strcasecmp(tmp, "layout"))
+                add_option(&options, "xkb_layout", value);
+            else if (!strcasecmp(tmp, "variant"))
+                add_option(&options, "xkb_variant", value);
+            else if (!strcasecmp(tmp, "model"))
+                add_option(&options, "xkb_model", value);
+            else if (!strcasecmp(tmp, "options"))
+                add_option(&options, "xkb_options", value);
+        }
+    }
+    add_option(&options, "name", name);
+    LogMessage(X_INFO, "config/udev: Adding input device %s (%s)\n",
+               name, path);
+    rc = NewInputDeviceRequest(options, &dev);
+    if (rc != Success)
+        goto unwind;
+
+    for (; dev; dev = dev->next) {
+        xfree(dev->config_info);
+        dev->config_info = xstrdup(config_info);
+    }
+
+ unwind:
+    xfree(config_info);
+    while (!dev && (tmpo = options)) {
+        options = tmpo->next;
+        xfree(tmpo->key);
+        xfree(tmpo->value);
+        xfree(tmpo);
+    }
+
+    return;
+}
+
+static void
+device_removed(struct udev_device *device)
+{
+    char *value;
+    const char *syspath = udev_device_get_syspath(device);
+
+    value = Xprintf("udev:%s", syspath);
+    if (!value)
+        return;
+
+    remove_devices("udev", value);
+
+    xfree(value);
+}
+
+static void
+wakeup_handler(pointer data, int err, pointer read_mask)
+{
+    int udev_fd = udev_monitor_get_fd(udev_monitor);
+    struct udev_device *udev_device;
+    const char *action;
+
+    if (err < 0)
+        return;
+
+    if (FD_ISSET(udev_fd, (fd_set *)read_mask)) {
+        udev_device = udev_monitor_receive_device(udev_monitor);
+        if (!udev_device)
+            return;
+        action = udev_device_get_action(udev_device);
+        if (!action)
+            ;
+        else if (!strcmp(action, "add"))
+            device_added(udev_device);
+        else if (!strcmp(action, "remove"))
+            device_removed(udev_device);
+        udev_device_unref(udev_device);
+    }
+}
+
+static void
+block_handler(pointer data, struct timeval **tv, pointer read_mask)
+{
+}
+
+int
+config_udev_init(void)
+{
+    struct udev *udev;
+    struct udev_enumerate *enumerate;
+    struct udev_list_entry *devices, *device;
+    int rc;
+
+    udev = udev_new();
+    if (!udev)
+        return 0;
+    udev_monitor = udev_monitor_new_from_netlink(udev, "udev");
+    if (!udev_monitor)
+        return 0;
+    rc = udev_monitor_filter_add_match_subsystem_devtype(udev_monitor,
+                                                         "input", NULL);
+    if (rc < 0)
+        return 0;
+
+    if (udev_monitor_enable_receiving(udev_monitor)) {
+        ErrorF("config/udev: failed to bind the udev monitor\n");
+	return 0;
+    }
+
+    enumerate = udev_enumerate_new(udev);
+    if (!enumerate)
+        return 0;
+    udev_enumerate_add_match_subsystem(enumerate, "input");
+    udev_enumerate_scan_devices(enumerate);
+    devices = udev_enumerate_get_list_entry(enumerate);
+    udev_list_entry_foreach(device, devices) {
+        const char *syspath = udev_list_entry_get_name(device);
+        struct udev_device *udev_device = udev_device_new_from_syspath(udev, syspath);
+        device_added(udev_device);
+        udev_device_unref(udev_device);
+    }
+    udev_enumerate_unref(enumerate);
+
+    RegisterBlockAndWakeupHandlers(block_handler, wakeup_handler, NULL);
+    AddGeneralSocket(udev_monitor_get_fd(udev_monitor));
+
+    return 1;
+}
+
+void
+config_udev_fini(void)
+{
+    struct udev *udev;
+
+    if (!udev_monitor)
+        return;
+
+    udev = udev_monitor_get_udev(udev_monitor);
+
+    RemoveGeneralSocket(udev_monitor_get_fd(udev_monitor));
+    RemoveBlockAndWakeupHandlers(block_handler, wakeup_handler, udev_monitor);
+    udev_monitor_unref(udev_monitor);
+    udev_monitor = NULL;
+    udev_unref(udev);
+}
diff -Naur xorg-server-20091215/config/x11-input.rules xorg-server-20091215.patch/config/x11-input.rules
--- xorg-server-20091215/config/x11-input.rules	1970-01-01 01:00:00.000000000 +0100
+++ xorg-server-20091215.patch/config/x11-input.rules	2009-12-15 23:04:05.473321747 +0100
@@ -0,0 +1,14 @@
+SUBSYSTEM!="input", GOTO="x11_input_end"
+ACTION!="change|add", GOTO="x11_input_end"
+KERNEL!="event*", GOTO="x11_input_end"
+
+# use the evdev driver by default
+ENV{x11_driver}="evdev"
+
+# set xkb layout if we have keys
+ENV{ID_INPUT_KEY}=="?*", ENV{xkblayout}="us"
+
+# use synaptics for touchpads
+ENV{ID_INPUT_TOUCHPAD}=="?*", ENV{x11_driver}="synaptics"
+
+LABEL="x11_input_end"
diff -Naur xorg-server-20091215/config.log xorg-server-20091215.patch/config.log
diff -Naur xorg-server-20091215/configure xorg-server-20091215.patch/configure
--- xorg-server-20091215/configure	2009-12-15 20:09:57.000000000 +0100
+++ xorg-server-20091215.patch/configure	2009-12-15 23:04:43.971321371 +0100
@@ -1067,6 +1067,10 @@
 HAVE_DBUS_TRUE
 DBUS_LIBS
 DBUS_CFLAGS
+CONFIG_UDEV_FALSE
+CONFIG_UDEV_TRUE
+UDEV_LIBS
+UDEV_CFLAGS
 INSTALL_LIBXF86CONFIG_FALSE
 INSTALL_LIBXF86CONFIG_TRUE
 MAKE_HTML
@@ -1360,6 +1364,7 @@
 enable_dbe
 enable_xf86bigfont
 enable_dpms
+enable_config_udev
 enable_config_dbus
 enable_config_hal
 enable_xfree86_utils
@@ -1401,6 +1406,8 @@
 PKG_CONFIG
 YACC
 YFLAGS
+UDEV_CFLAGS
+UDEV_LIBS
 DBUS_CFLAGS
 DBUS_LIBS
 HAL_CFLAGS
@@ -2148,6 +2155,7 @@
   --disable-dbe           Build DBE extension (default: enabled)
   --disable-xf86bigfont   Build XF86 Big Font extension (default: disabled)
   --disable-dpms          Build DPMS extension (default: enabled)
+  --enable-config-udev    Build udev support (default: auto)
   --enable-config-dbus    Build D-BUS API support (default: no)
   --disable-config-hal    Build HAL support (default: auto)
   --enable-xfree86-utils  Build xfree86 DDX utilities (default: enabled)
@@ -2266,6 +2274,8 @@
   YFLAGS      The list of arguments that will be passed by default to $YACC.
               This script will default YFLAGS to the empty string to avoid a
               default value of `-d' given by some make applications.
+  UDEV_CFLAGS C compiler flags for UDEV, overriding pkg-config
+  UDEV_LIBS   linker flags for UDEV, overriding pkg-config
   DBUS_CFLAGS C compiler flags for DBUS, overriding pkg-config
   DBUS_LIBS   linker flags for DBUS, overriding pkg-config
   HAL_CFLAGS  C compiler flags for HAL, overriding pkg-config
@@ -7652,13 +7662,13 @@
 else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
-  (eval echo "\"\$as_me:7655: $ac_compile\"" >&5)
+  (eval echo "\"\$as_me:7665: $ac_compile\"" >&5)
   (eval "$ac_compile" 2>conftest.err)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:7658: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
+  (eval echo "\"\$as_me:7668: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
   (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:7661: output\"" >&5)
+  (eval echo "\"\$as_me:7671: output\"" >&5)
   cat conftest.out >&5
   if $GREP 'External.*some_variable' conftest.out > /dev/null; then
     lt_cv_nm_interface="MS dumpbin"
@@ -8849,7 +8859,7 @@
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 8852 "configure"' > conftest.$ac_ext
+  echo '#line 8862 "configure"' > conftest.$ac_ext
   if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -10186,11 +10196,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:10189: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:10199: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:10193: \$? = $ac_status" >&5
+   echo "$as_me:10203: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -10525,11 +10535,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:10528: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:10538: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:10532: \$? = $ac_status" >&5
+   echo "$as_me:10542: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -10630,11 +10640,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:10633: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:10643: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:10637: \$? = $ac_status" >&5
+   echo "$as_me:10647: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -10685,11 +10695,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:10688: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:10698: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:10692: \$? = $ac_status" >&5
+   echo "$as_me:10702: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -13488,7 +13498,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 13491 "configure"
+#line 13501 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -13584,7 +13594,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 13587 "configure"
+#line 13597 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -21481,6 +21491,13 @@
   DPMSExtension=yes
 fi
 
+# Check whether --enable-config-udev was given.
+if test "${enable_config_udev+set}" = set; then
+  enableval=$enable_config_udev; CONFIG_UDEV=$enableval
+else
+  CONFIG_UDEV=auto
+fi
+
 # Check whether --enable-config-dbus was given.
 if test "${enable_config_dbus+set}" = set; then
   enableval=$enable_config_dbus; CONFIG_DBUS_API=$enableval
@@ -22997,6 +23014,107 @@
 LIBXTST="xtst >= 1.0.99.2"
 LIBPCIACCESS="pciaccess >= 0.8.0"
 LIBGLIB="glib-2.0 >= 2.16"
+LIBUDEV="libudev >= 143"
+
+if test "x$CONFIG_UDEV" = xyes &&
+ { test "x$CONFIG_DBUS_API" = xyes || test "x$CONFIG_HAL" = xyes; }; then
+	{ { $as_echo "$as_me:$LINENO: error: Hotplugging through both libudev and dbus/hal not allowed" >&5
+$as_echo "$as_me: error: Hotplugging through both libudev and dbus/hal not allowed" >&2;}
+   { (exit 1); exit 1; }; }
+fi
+
+
+pkg_failed=no
+{ $as_echo "$as_me:$LINENO: checking for UDEV" >&5
+$as_echo_n "checking for UDEV... " >&6; }
+
+if test -n "$UDEV_CFLAGS"; then
+    pkg_cv_UDEV_CFLAGS="$UDEV_CFLAGS"
+ elif test -n "$PKG_CONFIG"; then
+    if test -n "$PKG_CONFIG" && \
+    { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \"\$LIBUDEV\"") >&5
+  ($PKG_CONFIG --exists --print-errors "$LIBUDEV") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; then
+  pkg_cv_UDEV_CFLAGS=`$PKG_CONFIG --cflags "$LIBUDEV" 2>/dev/null`
+else
+  pkg_failed=yes
+fi
+ else
+    pkg_failed=untried
+fi
+if test -n "$UDEV_LIBS"; then
+    pkg_cv_UDEV_LIBS="$UDEV_LIBS"
+ elif test -n "$PKG_CONFIG"; then
+    if test -n "$PKG_CONFIG" && \
+    { ($as_echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \"\$LIBUDEV\"") >&5
+  ($PKG_CONFIG --exists --print-errors "$LIBUDEV") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; then
+  pkg_cv_UDEV_LIBS=`$PKG_CONFIG --libs "$LIBUDEV" 2>/dev/null`
+else
+  pkg_failed=yes
+fi
+ else
+    pkg_failed=untried
+fi
+
+
+
+if test $pkg_failed = yes; then
+
+if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
+        _pkg_short_errors_supported=yes
+else
+        _pkg_short_errors_supported=no
+fi
+        if test $_pkg_short_errors_supported = yes; then
+	        UDEV_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors "$LIBUDEV" 2>&1`
+        else
+	        UDEV_PKG_ERRORS=`$PKG_CONFIG --print-errors "$LIBUDEV" 2>&1`
+        fi
+	# Put the nasty error message in config.log where it belongs
+	echo "$UDEV_PKG_ERRORS" >&5
+
+	{ $as_echo "$as_me:$LINENO: result: no" >&5
+$as_echo "no" >&6; }
+                HAVE_LIBUDEV=no
+elif test $pkg_failed = untried; then
+	HAVE_LIBUDEV=no
+else
+	UDEV_CFLAGS=$pkg_cv_UDEV_CFLAGS
+	UDEV_LIBS=$pkg_cv_UDEV_LIBS
+        { $as_echo "$as_me:$LINENO: result: yes" >&5
+$as_echo "yes" >&6; }
+	HAVE_LIBUDEV=yes
+fi
+if test "x$CONFIG_UDEV" = xauto; then
+	CONFIG_UDEV="$HAVE_LIBUDEV"
+fi
+ if test "x$CONFIG_UDEV" = xyes; then
+  CONFIG_UDEV_TRUE=
+  CONFIG_UDEV_FALSE='#'
+else
+  CONFIG_UDEV_TRUE='#'
+  CONFIG_UDEV_FALSE=
+fi
+
+if test "x$CONFIG_UDEV" = xyes; then
+	CONFIG_DBUS_API=no
+	CONFIG_HAL=no
+	if ! test "x$HAVE_LIBUDEV" = xyes; then
+		{ { $as_echo "$as_me:$LINENO: error: udev configuration API requested, but libudev is not installed" >&5
+$as_echo "$as_me: error: udev configuration API requested, but libudev is not installed" >&2;}
+   { (exit 1); exit 1; }; }
+	fi
+
+cat >>confdefs.h <<\_ACEOF
+#define CONFIG_UDEV 1
+_ACEOF
+
+fi
 
 
 pkg_failed=no
@@ -23189,7 +23307,6 @@
 #define CONFIG_HAL 1
 _ACEOF
 
-        REQUIRED_LIBS="$REQUIRED_LIBS hal"
 	CONFIG_NEED_DBUS="yes"
 fi
  if test "x$CONFIG_HAL" = xyes; then
@@ -23202,7 +23319,6 @@
 
 
 if test "x$CONFIG_NEED_DBUS" = xyes; then
-	REQUIRED_LIBS="$REQUIRED_LIBS dbus-1"
 
 cat >>confdefs.h <<\_ACEOF
 #define CONFIG_NEED_DBUS 1
@@ -32411,6 +32527,13 @@
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${CONFIG_UDEV_TRUE}" && test -z "${CONFIG_UDEV_FALSE}"; then
+  { { $as_echo "$as_me:$LINENO: error: conditional \"CONFIG_UDEV\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+$as_echo "$as_me: error: conditional \"CONFIG_UDEV\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${HAVE_DBUS_TRUE}" && test -z "${HAVE_DBUS_FALSE}"; then
   { { $as_echo "$as_me:$LINENO: error: conditional \"HAVE_DBUS\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
diff -Naur xorg-server-20091215/configure.ac xorg-server-20091215.patch/configure.ac
--- xorg-server-20091215/configure.ac	2009-12-14 23:34:15.000000000 +0100
+++ xorg-server-20091215.patch/configure.ac	2009-12-15 23:04:05.474321448 +0100
@@ -615,6 +615,7 @@
 AC_ARG_ENABLE(dbe,            AS_HELP_STRING([--disable-dbe], [Build DBE extension (default: enabled)]), [DBE=$enableval], [DBE=yes])
 AC_ARG_ENABLE(xf86bigfont,    AS_HELP_STRING([--disable-xf86bigfont], [Build XF86 Big Font extension (default: disabled)]), [XF86BIGFONT=$enableval], [XF86BIGFONT=no])
 AC_ARG_ENABLE(dpms,           AS_HELP_STRING([--disable-dpms], [Build DPMS extension (default: enabled)]), [DPMSExtension=$enableval], [DPMSExtension=yes])
+AC_ARG_ENABLE(config-udev,    AS_HELP_STRING([--enable-config-udev], [Build udev support (default: auto)]), [CONFIG_UDEV=$enableval], [CONFIG_UDEV=auto])
 AC_ARG_ENABLE(config-dbus,    AS_HELP_STRING([--enable-config-dbus], [Build D-BUS API support (default: no)]), [CONFIG_DBUS_API=$enableval], [CONFIG_DBUS_API=no])
 AC_ARG_ENABLE(config-hal,     AS_HELP_STRING([--disable-config-hal], [Build HAL support (default: auto)]), [CONFIG_HAL=$enableval], [CONFIG_HAL=auto])
 AC_ARG_ENABLE(xfree86-utils,     AS_HELP_STRING([--enable-xfree86-utils], [Build xfree86 DDX utilities (default: enabled)]), [XF86UTILS=$enableval], [XF86UTILS=yes])
@@ -772,6 +773,26 @@
 LIBXTST="xtst >= 1.0.99.2"
 LIBPCIACCESS="pciaccess >= 0.8.0"
 LIBGLIB="glib-2.0 >= 2.16"
+LIBUDEV="libudev >= 143"
+
+if test "x$CONFIG_UDEV" = xyes &&
+ { test "x$CONFIG_DBUS_API" = xyes || test "x$CONFIG_HAL" = xyes; }; then
+	AC_MSG_ERROR([Hotplugging through both libudev and dbus/hal not allowed])
+fi
+
+PKG_CHECK_MODULES(UDEV, $LIBUDEV, [HAVE_LIBUDEV=yes], [HAVE_LIBUDEV=no])
+if test "x$CONFIG_UDEV" = xauto; then
+	CONFIG_UDEV="$HAVE_LIBUDEV"
+fi
+AM_CONDITIONAL(CONFIG_UDEV, [test "x$CONFIG_UDEV" = xyes])
+if test "x$CONFIG_UDEV" = xyes; then
+	CONFIG_DBUS_API=no
+	CONFIG_HAL=no
+	if ! test "x$HAVE_LIBUDEV" = xyes; then
+		AC_MSG_ERROR([udev configuration API requested, but libudev is not installed])
+	fi
+	AC_DEFINE(CONFIG_UDEV, 1, [Use libudev for input hotplug])
+fi
 
 dnl HAVE_DBUS is true if we actually have the D-Bus library, whereas
 dnl CONFIG_DBUS_API is true if we want to enable the D-Bus config
@@ -805,13 +826,11 @@
 	fi
 
 	AC_DEFINE(CONFIG_HAL, 1, [Use the HAL hotplug API])
-        REQUIRED_LIBS="$REQUIRED_LIBS hal"
 	CONFIG_NEED_DBUS="yes"
 fi
 AM_CONDITIONAL(CONFIG_HAL, [test "x$CONFIG_HAL" = xyes])
 
 if test "x$CONFIG_NEED_DBUS" = xyes; then
-	REQUIRED_LIBS="$REQUIRED_LIBS dbus-1"
         AC_DEFINE(CONFIG_NEED_DBUS, 1, [Use D-Bus for input hotplug])
 fi
 AM_CONDITIONAL(CONFIG_NEED_DBUS, [test "x$CONFIG_NEED_DBUS" = xyes])
diff -Naur xorg-server-20091215/damageext/Makefile.in xorg-server-20091215.patch/damageext/Makefile.in
--- xorg-server-20091215/damageext/Makefile.in	2009-12-15 20:10:06.000000000 +0100
+++ xorg-server-20091215.patch/damageext/Makefile.in	2009-12-15 23:04:50.735321449 +0100
@@ -263,6 +263,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/dbe/Makefile.in xorg-server-20091215.patch/dbe/Makefile.in
--- xorg-server-20091215/dbe/Makefile.in	2009-12-15 20:10:06.000000000 +0100
+++ xorg-server-20091215.patch/dbe/Makefile.in	2009-12-15 23:04:50.904321304 +0100
@@ -289,6 +289,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/dix/Makefile.in xorg-server-20091215.patch/dix/Makefile.in
--- xorg-server-20091215/dix/Makefile.in	2009-12-15 20:10:06.000000000 +0100
+++ xorg-server-20091215.patch/dix/Makefile.in	2009-12-15 23:04:51.092321264 +0100
@@ -303,6 +303,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/doc/Makefile.in xorg-server-20091215.patch/doc/Makefile.in
--- xorg-server-20091215/doc/Makefile.in	2009-12-15 20:10:06.000000000 +0100
+++ xorg-server-20091215.patch/doc/Makefile.in	2009-12-15 23:04:51.242321227 +0100
@@ -266,6 +266,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/exa/Makefile.in xorg-server-20091215.patch/exa/Makefile.in
--- xorg-server-20091215/exa/Makefile.in	2009-12-15 20:10:07.000000000 +0100
+++ xorg-server-20091215.patch/exa/Makefile.in	2009-12-15 23:04:51.414321792 +0100
@@ -294,6 +294,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/fb/Makefile.in xorg-server-20091215.patch/fb/Makefile.in
--- xorg-server-20091215/fb/Makefile.in	2009-12-15 20:10:07.000000000 +0100
+++ xorg-server-20091215.patch/fb/Makefile.in	2009-12-15 23:04:51.949321561 +0100
@@ -319,6 +319,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/glx/Makefile.in xorg-server-20091215.patch/glx/Makefile.in
--- xorg-server-20091215/glx/Makefile.in	2009-12-15 20:10:08.000000000 +0100
+++ xorg-server-20091215.patch/glx/Makefile.in	2009-12-15 23:04:52.132321412 +0100
@@ -283,6 +283,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/dmx/config/Makefile.in xorg-server-20091215.patch/hw/dmx/config/Makefile.in
--- xorg-server-20091215/hw/dmx/config/Makefile.in	2009-12-15 20:10:08.000000000 +0100
+++ xorg-server-20091215.patch/hw/dmx/config/Makefile.in	2009-12-15 23:04:52.714321276 +0100
@@ -325,6 +325,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/dmx/doc/Makefile.in xorg-server-20091215.patch/hw/dmx/doc/Makefile.in
--- xorg-server-20091215/hw/dmx/doc/Makefile.in	2009-12-15 20:10:08.000000000 +0100
+++ xorg-server-20091215.patch/hw/dmx/doc/Makefile.in	2009-12-15 23:04:52.868321575 +0100
@@ -260,6 +260,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/dmx/examples/Makefile.in xorg-server-20091215.patch/hw/dmx/examples/Makefile.in
--- xorg-server-20091215/hw/dmx/examples/Makefile.in	2009-12-15 20:10:09.000000000 +0100
+++ xorg-server-20091215.patch/hw/dmx/examples/Makefile.in	2009-12-15 23:04:53.184321312 +0100
@@ -367,6 +367,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/dmx/glxProxy/Makefile.in xorg-server-20091215.patch/hw/dmx/glxProxy/Makefile.in
--- xorg-server-20091215/hw/dmx/glxProxy/Makefile.in	2009-12-15 20:10:09.000000000 +0100
+++ xorg-server-20091215.patch/hw/dmx/glxProxy/Makefile.in	2009-12-15 23:04:53.352321326 +0100
@@ -274,6 +274,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/dmx/input/Makefile.in xorg-server-20091215.patch/hw/dmx/input/Makefile.in
--- xorg-server-20091215/hw/dmx/input/Makefile.in	2009-12-15 20:10:09.000000000 +0100
+++ xorg-server-20091215.patch/hw/dmx/input/Makefile.in	2009-12-15 23:04:53.528321249 +0100
@@ -288,6 +288,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/dmx/Makefile.in xorg-server-20091215.patch/hw/dmx/Makefile.in
--- xorg-server-20091215/hw/dmx/Makefile.in	2009-12-15 20:10:08.000000000 +0100
+++ xorg-server-20091215.patch/hw/dmx/Makefile.in	2009-12-15 23:04:52.489321228 +0100
@@ -352,6 +352,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/kdrive/ephyr/Makefile.in xorg-server-20091215.patch/hw/kdrive/ephyr/Makefile.in
--- xorg-server-20091215/hw/kdrive/ephyr/Makefile.in	2009-12-15 20:10:10.000000000 +0100
+++ xorg-server-20091215.patch/hw/kdrive/ephyr/Makefile.in	2009-12-15 23:04:53.873321376 +0100
@@ -326,6 +326,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/kdrive/fake/Makefile.in xorg-server-20091215.patch/hw/kdrive/fake/Makefile.in
--- xorg-server-20091215/hw/kdrive/fake/Makefile.in	2009-12-15 20:10:10.000000000 +0100
+++ xorg-server-20091215.patch/hw/kdrive/fake/Makefile.in	2009-12-15 23:04:54.046321219 +0100
@@ -272,6 +272,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/kdrive/fbdev/Makefile.in xorg-server-20091215.patch/hw/kdrive/fbdev/Makefile.in
--- xorg-server-20091215/hw/kdrive/fbdev/Makefile.in	2009-12-15 20:10:10.000000000 +0100
+++ xorg-server-20091215.patch/hw/kdrive/fbdev/Makefile.in	2009-12-15 23:04:54.219321622 +0100
@@ -273,6 +273,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/kdrive/linux/Makefile.in xorg-server-20091215.patch/hw/kdrive/linux/Makefile.in
--- xorg-server-20091215/hw/kdrive/linux/Makefile.in	2009-12-15 20:10:10.000000000 +0100
+++ xorg-server-20091215.patch/hw/kdrive/linux/Makefile.in	2009-12-15 23:04:54.386321167 +0100
@@ -268,6 +268,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/kdrive/Makefile.in xorg-server-20091215.patch/hw/kdrive/Makefile.in
--- xorg-server-20091215/hw/kdrive/Makefile.in	2009-12-15 20:10:09.000000000 +0100
+++ xorg-server-20091215.patch/hw/kdrive/Makefile.in	2009-12-15 23:04:53.671321283 +0100
@@ -276,6 +276,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/kdrive/src/kinput.c xorg-server-20091215.patch/hw/kdrive/src/kinput.c
--- xorg-server-20091215/hw/kdrive/src/kinput.c	2009-12-14 23:34:15.000000000 +0100
+++ xorg-server-20091215.patch/hw/kdrive/src/kinput.c	2009-12-15 23:04:05.475321637 +0100
@@ -2280,6 +2280,14 @@
             return BadValue;
         }
 #endif
+#ifdef CONFIG_UDEV
+        else if (strcmp(option->key, "_source") == 0 &&
+                 strcmp(option->value, "server/udev") == 0)
+        {
+            ErrorF("Ignoring device from udev.\n");
+            return BadValue;
+        }
+#endif
     }
 
     if (!ki && !pi) {
diff -Naur xorg-server-20091215/hw/kdrive/src/Makefile.in xorg-server-20091215.patch/hw/kdrive/src/Makefile.in
--- xorg-server-20091215/hw/kdrive/src/Makefile.in	2009-12-15 20:10:11.000000000 +0100
+++ xorg-server-20091215.patch/hw/kdrive/src/Makefile.in	2009-12-15 23:04:54.571321465 +0100
@@ -273,6 +273,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/Makefile.in xorg-server-20091215.patch/hw/Makefile.in
--- xorg-server-20091215/hw/Makefile.in	2009-12-15 20:10:08.000000000 +0100
+++ xorg-server-20091215.patch/hw/Makefile.in	2009-12-15 23:04:52.278321315 +0100
@@ -276,6 +276,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/vfb/Makefile.in xorg-server-20091215.patch/hw/vfb/Makefile.in
--- xorg-server-20091215/hw/vfb/Makefile.in	2009-12-15 20:10:11.000000000 +0100
+++ xorg-server-20091215.patch/hw/vfb/Makefile.in	2009-12-15 23:04:54.787321554 +0100
@@ -310,6 +310,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/common/Makefile.in xorg-server-20091215.patch/hw/xfree86/common/Makefile.in
--- xorg-server-20091215/hw/xfree86/common/Makefile.in	2009-12-15 20:10:11.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/common/Makefile.in	2009-12-15 23:04:55.179321354 +0100
@@ -315,6 +315,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/common/xf86Config.c xorg-server-20091215.patch/hw/xfree86/common/xf86Config.c
--- xorg-server-20091215/hw/xfree86/common/xf86Config.c	2009-12-14 23:34:15.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/common/xf86Config.c	2009-12-15 23:04:05.476321896 +0100
@@ -1453,12 +1453,19 @@
     }
 
     if (xf86Info.allowEmptyInput && !(foundPointer && foundKeyboard)) {
-#ifdef CONFIG_HAL
-	xf86Msg(X_INFO, "The server relies on HAL to provide the list of "
+#if defined(CONFIG_HAL) || defined(CONFIG_UDEV)
+	const char *config_backend;
+#if defined(CONFIG_HAL)
+	config_backend = "HAL";
+#else
+	config_backend = "udev";
+#endif
+	xf86Msg(X_INFO, "The server relies on %s to provide the list of "
 	                "input devices.\n\tIf no devices become available, "
-	                "reconfigure HAL or disable AutoAddDevices.\n");
+	                "reconfigure %s or disable AutoAddDevices.\n",
+			config_backend, config_backend);
 #else
-	xf86Msg(X_INFO, "HAL is disabled and no input devices were configured.\n"
+	xf86Msg(X_INFO, "Hotplugging is disabled and no input devices were configured.\n"
 			"\tTry disabling AllowEmptyInput.\n");
 #endif
     }
diff -Naur xorg-server-20091215/hw/xfree86/common/xf86Globals.c xorg-server-20091215.patch/hw/xfree86/common/xf86Globals.c
--- xorg-server-20091215/hw/xfree86/common/xf86Globals.c	2009-12-14 23:34:15.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/common/xf86Globals.c	2009-12-15 23:04:05.477321527 +0100
@@ -132,7 +132,7 @@
     .kbdCustomKeycodes          = FALSE,
     .disableRandR               = FALSE,
     .randRFrom                  = X_DEFAULT,
-#ifdef CONFIG_HAL
+#if defined(CONFIG_HAL) || defined(CONFIG_UDEV)
     .allowEmptyInput            = TRUE,
     .autoAddDevices             = TRUE,
     .autoEnableDevices          = TRUE
diff -Naur xorg-server-20091215/hw/xfree86/common/xf86Xinput.c xorg-server-20091215.patch/hw/xfree86/common/xf86Xinput.c
--- xorg-server-20091215/hw/xfree86/common/xf86Xinput.c	2009-12-14 23:34:15.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/common/xf86Xinput.c	2009-12-15 23:04:05.477321527 +0100
@@ -605,9 +605,9 @@
             }
         }
 
-        /* Right now, the only automatic config we know of is HAL. */
         if (strcmp(option->key, "_source") == 0 &&
-            strcmp(option->value, "server/hal") == 0) {
+            (strcmp(option->value, "server/hal") == 0 ||
+             strcmp(option->value, "server/udev") == 0)) {
             is_auto = 1;
             if (!xf86Info.autoAddDevices) {
                 rval = BadMatch;
diff -Naur xorg-server-20091215/hw/xfree86/ddc/Makefile.in xorg-server-20091215.patch/hw/xfree86/ddc/Makefile.in
--- xorg-server-20091215/hw/xfree86/ddc/Makefile.in	2009-12-15 20:10:12.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/ddc/Makefile.in	2009-12-15 23:04:55.349321327 +0100
@@ -289,6 +289,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/dixmods/extmod/Makefile.in xorg-server-20091215.patch/hw/xfree86/dixmods/extmod/Makefile.in
--- xorg-server-20091215/hw/xfree86/dixmods/extmod/Makefile.in	2009-12-15 20:10:12.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/dixmods/extmod/Makefile.in	2009-12-15 23:04:55.774321505 +0100
@@ -297,6 +297,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/dixmods/Makefile.in xorg-server-20091215.patch/hw/xfree86/dixmods/Makefile.in
--- xorg-server-20091215/hw/xfree86/dixmods/Makefile.in	2009-12-15 20:10:12.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/dixmods/Makefile.in	2009-12-15 23:04:55.596320926 +0100
@@ -377,6 +377,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/doc/devel/Makefile.in xorg-server-20091215.patch/hw/xfree86/doc/devel/Makefile.in
--- xorg-server-20091215/hw/xfree86/doc/devel/Makefile.in	2009-12-15 20:10:13.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/doc/devel/Makefile.in	2009-12-15 23:04:56.049321162 +0100
@@ -240,6 +240,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/doc/Makefile.in xorg-server-20091215.patch/hw/xfree86/doc/Makefile.in
--- xorg-server-20091215/hw/xfree86/doc/Makefile.in	2009-12-15 20:10:12.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/doc/Makefile.in	2009-12-15 23:04:55.916321347 +0100
@@ -277,6 +277,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/doc/man/Makefile.in xorg-server-20091215.patch/hw/xfree86/doc/man/Makefile.in
--- xorg-server-20091215/hw/xfree86/doc/man/Makefile.in	2009-12-15 20:10:13.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/doc/man/Makefile.in	2009-12-15 23:04:56.198321352 +0100
@@ -266,6 +266,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/doc/sgml/Makefile.in xorg-server-20091215.patch/hw/xfree86/doc/sgml/Makefile.in
--- xorg-server-20091215/hw/xfree86/doc/sgml/Makefile.in	2009-12-15 20:10:13.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/doc/sgml/Makefile.in	2009-12-15 23:04:56.340321615 +0100
@@ -260,6 +260,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/dri/Makefile.in xorg-server-20091215.patch/hw/xfree86/dri/Makefile.in
--- xorg-server-20091215/hw/xfree86/dri/Makefile.in	2009-12-15 20:10:13.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/dri/Makefile.in	2009-12-15 23:04:56.530321322 +0100
@@ -292,6 +292,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/dri2/Makefile.in xorg-server-20091215.patch/hw/xfree86/dri2/Makefile.in
--- xorg-server-20091215/hw/xfree86/dri2/Makefile.in	2009-12-15 20:10:13.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/dri2/Makefile.in	2009-12-15 23:04:56.713321799 +0100
@@ -291,6 +291,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/exa/Makefile.in xorg-server-20091215.patch/hw/xfree86/exa/Makefile.in
--- xorg-server-20091215/hw/xfree86/exa/Makefile.in	2009-12-15 20:10:14.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/exa/Makefile.in	2009-12-15 23:04:56.890321350 +0100
@@ -295,6 +295,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/fbdevhw/Makefile.in xorg-server-20091215.patch/hw/xfree86/fbdevhw/Makefile.in
--- xorg-server-20091215/hw/xfree86/fbdevhw/Makefile.in	2009-12-15 20:10:14.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/fbdevhw/Makefile.in	2009-12-15 23:04:57.076321556 +0100
@@ -300,6 +300,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/i2c/Makefile.in xorg-server-20091215.patch/hw/xfree86/i2c/Makefile.in
--- xorg-server-20091215/hw/xfree86/i2c/Makefile.in	2009-12-15 20:10:14.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/i2c/Makefile.in	2009-12-15 23:04:57.299321502 +0100
@@ -341,6 +341,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/int10/Makefile.in xorg-server-20091215.patch/hw/xfree86/int10/Makefile.in
--- xorg-server-20091215/hw/xfree86/int10/Makefile.in	2009-12-15 20:10:14.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/int10/Makefile.in	2009-12-15 23:04:57.495321436 +0100
@@ -305,6 +305,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/loader/Makefile.in xorg-server-20091215.patch/hw/xfree86/loader/Makefile.in
--- xorg-server-20091215/hw/xfree86/loader/Makefile.in	2009-12-15 20:10:14.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/loader/Makefile.in	2009-12-15 23:04:57.663321379 +0100
@@ -265,6 +265,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/Makefile.in xorg-server-20091215.patch/hw/xfree86/Makefile.in
--- xorg-server-20091215/hw/xfree86/Makefile.in	2009-12-15 20:10:11.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/Makefile.in	2009-12-15 23:04:54.982321299 +0100
@@ -323,6 +323,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/modes/Makefile.in xorg-server-20091215.patch/hw/xfree86/modes/Makefile.in
--- xorg-server-20091215/hw/xfree86/modes/Makefile.in	2009-12-15 20:10:15.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/modes/Makefile.in	2009-12-15 23:04:57.838321179 +0100
@@ -295,6 +295,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/os-support/bsd/Makefile.in xorg-server-20091215.patch/hw/xfree86/os-support/bsd/Makefile.in
--- xorg-server-20091215/hw/xfree86/os-support/bsd/Makefile.in	2009-12-15 20:10:15.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/os-support/bsd/Makefile.in	2009-12-15 23:04:58.274321340 +0100
@@ -289,6 +289,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/os-support/bus/Makefile.in xorg-server-20091215.patch/hw/xfree86/os-support/bus/Makefile.in
--- xorg-server-20091215/hw/xfree86/os-support/bus/Makefile.in	2009-12-15 20:10:15.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/os-support/bus/Makefile.in	2009-12-15 23:04:58.452321499 +0100
@@ -297,6 +297,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/os-support/hurd/Makefile.in xorg-server-20091215.patch/hw/xfree86/os-support/hurd/Makefile.in
--- xorg-server-20091215/hw/xfree86/os-support/hurd/Makefile.in	2009-12-15 20:10:16.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/os-support/hurd/Makefile.in	2009-12-15 23:04:58.661321798 +0100
@@ -265,6 +265,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/os-support/linux/Makefile.in xorg-server-20091215.patch/hw/xfree86/os-support/linux/Makefile.in
--- xorg-server-20091215/hw/xfree86/os-support/linux/Makefile.in	2009-12-15 20:10:16.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/os-support/linux/Makefile.in	2009-12-15 23:04:58.896321497 +0100
@@ -290,6 +290,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/os-support/Makefile.in xorg-server-20091215.patch/hw/xfree86/os-support/Makefile.in
--- xorg-server-20091215/hw/xfree86/os-support/Makefile.in	2009-12-15 20:10:15.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/os-support/Makefile.in	2009-12-15 23:04:58.013321539 +0100
@@ -326,6 +326,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/os-support/misc/Makefile.in xorg-server-20091215.patch/hw/xfree86/os-support/misc/Makefile.in
--- xorg-server-20091215/hw/xfree86/os-support/misc/Makefile.in	2009-12-15 20:10:16.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/os-support/misc/Makefile.in	2009-12-15 23:04:59.061321709 +0100
@@ -263,6 +263,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/os-support/sco/Makefile.in xorg-server-20091215.patch/hw/xfree86/os-support/sco/Makefile.in
--- xorg-server-20091215/hw/xfree86/os-support/sco/Makefile.in	2009-12-15 20:10:16.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/os-support/sco/Makefile.in	2009-12-15 23:04:59.195321154 +0100
@@ -237,6 +237,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/os-support/solaris/Makefile.in xorg-server-20091215.patch/hw/xfree86/os-support/solaris/Makefile.in
--- xorg-server-20091215/hw/xfree86/os-support/solaris/Makefile.in	2009-12-15 20:10:17.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/os-support/solaris/Makefile.in	2009-12-15 23:04:59.425321515 +0100
@@ -312,6 +312,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/os-support/sysv/Makefile.in xorg-server-20091215.patch/hw/xfree86/os-support/sysv/Makefile.in
--- xorg-server-20091215/hw/xfree86/os-support/sysv/Makefile.in	2009-12-15 20:10:17.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/os-support/sysv/Makefile.in	2009-12-15 23:04:59.560321288 +0100
@@ -237,6 +237,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/parser/Makefile.in xorg-server-20091215.patch/hw/xfree86/parser/Makefile.in
--- xorg-server-20091215/hw/xfree86/parser/Makefile.in	2009-12-15 20:10:17.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/parser/Makefile.in	2009-12-15 23:04:59.852321576 +0100
@@ -320,6 +320,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/ramdac/Makefile.in xorg-server-20091215.patch/hw/xfree86/ramdac/Makefile.in
--- xorg-server-20091215/hw/xfree86/ramdac/Makefile.in	2009-12-15 20:10:17.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/ramdac/Makefile.in	2009-12-15 23:05:00.025320997 +0100
@@ -289,6 +289,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/shadowfb/Makefile.in xorg-server-20091215.patch/hw/xfree86/shadowfb/Makefile.in
--- xorg-server-20091215/hw/xfree86/shadowfb/Makefile.in	2009-12-15 20:10:17.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/shadowfb/Makefile.in	2009-12-15 23:05:00.199321375 +0100
@@ -292,6 +292,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/utils/cvt/Makefile.in xorg-server-20091215.patch/hw/xfree86/utils/cvt/Makefile.in
--- xorg-server-20091215/hw/xfree86/utils/cvt/Makefile.in	2009-12-15 20:10:18.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/utils/cvt/Makefile.in	2009-12-15 23:05:00.531321200 +0100
@@ -325,6 +325,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/utils/gtf/Makefile.in xorg-server-20091215.patch/hw/xfree86/utils/gtf/Makefile.in
--- xorg-server-20091215/hw/xfree86/utils/gtf/Makefile.in	2009-12-15 20:10:18.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/utils/gtf/Makefile.in	2009-12-15 23:05:00.723321283 +0100
@@ -324,6 +324,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/utils/Makefile.in xorg-server-20091215.patch/hw/xfree86/utils/Makefile.in
--- xorg-server-20091215/hw/xfree86/utils/Makefile.in	2009-12-15 20:10:18.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/utils/Makefile.in	2009-12-15 23:05:00.338321208 +0100
@@ -277,6 +277,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/vbe/Makefile.in xorg-server-20091215.patch/hw/xfree86/vbe/Makefile.in
--- xorg-server-20091215/hw/xfree86/vbe/Makefile.in	2009-12-15 20:10:18.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/vbe/Makefile.in	2009-12-15 23:05:00.894321165 +0100
@@ -291,6 +291,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/vgahw/Makefile.in xorg-server-20091215.patch/hw/xfree86/vgahw/Makefile.in
--- xorg-server-20091215/hw/xfree86/vgahw/Makefile.in	2009-12-15 20:10:19.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/vgahw/Makefile.in	2009-12-15 23:05:01.068321124 +0100
@@ -291,6 +291,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/x86emu/Makefile.in xorg-server-20091215.patch/hw/xfree86/x86emu/Makefile.in
--- xorg-server-20091215/hw/xfree86/x86emu/Makefile.in	2009-12-15 20:10:19.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/x86emu/Makefile.in	2009-12-15 23:05:01.234321315 +0100
@@ -264,6 +264,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/xaa/Makefile.in xorg-server-20091215.patch/hw/xfree86/xaa/Makefile.in
--- xorg-server-20091215/hw/xfree86/xaa/Makefile.in	2009-12-15 20:10:19.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/xaa/Makefile.in	2009-12-15 23:05:01.433321395 +0100
@@ -311,6 +311,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xfree86/xf8_16bpp/Makefile.in xorg-server-20091215.patch/hw/xfree86/xf8_16bpp/Makefile.in
--- xorg-server-20091215/hw/xfree86/xf8_16bpp/Makefile.in	2009-12-15 20:10:19.000000000 +0100
+++ xorg-server-20091215.patch/hw/xfree86/xf8_16bpp/Makefile.in	2009-12-15 23:05:01.605321115 +0100
@@ -292,6 +292,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xnest/Makefile.in xorg-server-20091215.patch/hw/xnest/Makefile.in
--- xorg-server-20091215/hw/xnest/Makefile.in	2009-12-15 20:10:20.000000000 +0100
+++ xorg-server-20091215.patch/hw/xnest/Makefile.in	2009-12-15 23:05:01.827321356 +0100
@@ -313,6 +313,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xquartz/bundle/Makefile.in xorg-server-20091215.patch/hw/xquartz/bundle/Makefile.in
--- xorg-server-20091215/hw/xquartz/bundle/Makefile.in	2009-12-15 20:10:20.000000000 +0100
+++ xorg-server-20091215.patch/hw/xquartz/bundle/Makefile.in	2009-12-15 23:05:02.342321374 +0100
@@ -270,6 +270,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xquartz/doc/Makefile.in xorg-server-20091215.patch/hw/xquartz/doc/Makefile.in
--- xorg-server-20091215/hw/xquartz/doc/Makefile.in	2009-12-15 20:10:21.000000000 +0100
+++ xorg-server-20091215.patch/hw/xquartz/doc/Makefile.in	2009-12-15 23:05:02.488321272 +0100
@@ -266,6 +266,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xquartz/GL/Makefile.in xorg-server-20091215.patch/hw/xquartz/GL/Makefile.in
--- xorg-server-20091215/hw/xquartz/GL/Makefile.in	2009-12-15 20:10:20.000000000 +0100
+++ xorg-server-20091215.patch/hw/xquartz/GL/Makefile.in	2009-12-15 23:05:01.993321338 +0100
@@ -264,6 +264,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xquartz/mach-startup/Makefile.in xorg-server-20091215.patch/hw/xquartz/mach-startup/Makefile.in
--- xorg-server-20091215/hw/xquartz/mach-startup/Makefile.in	2009-12-15 20:10:21.000000000 +0100
+++ xorg-server-20091215.patch/hw/xquartz/mach-startup/Makefile.in	2009-12-15 23:05:02.671321327 +0100
@@ -301,6 +301,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xquartz/Makefile.in xorg-server-20091215.patch/hw/xquartz/Makefile.in
--- xorg-server-20091215/hw/xquartz/Makefile.in	2009-12-15 20:10:20.000000000 +0100
+++ xorg-server-20091215.patch/hw/xquartz/Makefile.in	2009-12-15 23:05:02.193321537 +0100
@@ -317,6 +317,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xquartz/pbproxy/Makefile.in xorg-server-20091215.patch/hw/xquartz/pbproxy/Makefile.in
--- xorg-server-20091215/hw/xquartz/pbproxy/Makefile.in	2009-12-15 20:10:21.000000000 +0100
+++ xorg-server-20091215.patch/hw/xquartz/pbproxy/Makefile.in	2009-12-15 23:05:02.860321819 +0100
@@ -292,6 +292,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xquartz/xpr/Makefile.in xorg-server-20091215.patch/hw/xquartz/xpr/Makefile.in
--- xorg-server-20091215/hw/xquartz/xpr/Makefile.in	2009-12-15 20:10:21.000000000 +0100
+++ xorg-server-20091215.patch/hw/xquartz/xpr/Makefile.in	2009-12-15 23:05:03.026321241 +0100
@@ -265,6 +265,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/hw/xwin/Makefile.in xorg-server-20091215.patch/hw/xwin/Makefile.in
--- xorg-server-20091215/hw/xwin/Makefile.in	2009-12-15 20:10:21.000000000 +0100
+++ xorg-server-20091215.patch/hw/xwin/Makefile.in	2009-12-15 23:05:03.289321209 +0100
@@ -388,6 +388,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/include/dix-config.h.in xorg-server-20091215.patch/include/dix-config.h.in
--- xorg-server-20091215/include/dix-config.h.in	2009-12-14 23:34:15.000000000 +0100
+++ xorg-server-20091215.patch/include/dix-config.h.in	2009-12-15 23:04:05.478321507 +0100
@@ -396,6 +396,9 @@
 /* Support D-Bus */
 #undef HAVE_DBUS
 
+/* Use libudev for input hotplug */
+#undef CONFIG_UDEV
+
 /* Use D-Bus for input hotplug */
 #undef CONFIG_NEED_DBUS
 
diff -Naur xorg-server-20091215/include/do-not-use-config.h.in xorg-server-20091215.patch/include/do-not-use-config.h.in
--- xorg-server-20091215/include/do-not-use-config.h.in	2009-12-15 20:10:01.000000000 +0100
+++ xorg-server-20091215.patch/include/do-not-use-config.h.in	2009-12-15 23:04:46.000000000 +0100
@@ -36,6 +36,9 @@
 /* Use D-Bus for input hotplug */
 #undef CONFIG_NEED_DBUS
 
+/* Use libudev for input hotplug */
+#undef CONFIG_UDEV
+
 /* Define to one of `_getb67', `GETB67', `getb67' for Cray-2 and Cray-YMP
    systems. This function is required for `alloca.c' support on those systems.
    */
diff -Naur xorg-server-20091215/include/do-not-use-config.h.in~ xorg-server-20091215.patch/include/do-not-use-config.h.in~
--- xorg-server-20091215/include/do-not-use-config.h.in~	1970-01-01 01:00:00.000000000 +0100
+++ xorg-server-20091215.patch/include/do-not-use-config.h.in~	2009-12-15 20:10:01.000000000 +0100
@@ -0,0 +1,761 @@
+/* include/do-not-use-config.h.in.  Generated from configure.ac by autoheader.  */
+
+/* Define if building universal (internal helper macro) */
+#undef AC_APPLE_UNIVERSAL_BUILD
+
+/* Build AIGLX loader */
+#undef AIGLX
+
+/* Default base font path */
+#undef BASE_FONT_PATH
+
+/* Support BigRequests extension */
+#undef BIGREQS
+
+/* Define to 1 if `struct sockaddr_in' has a `sin_len' member */
+#undef BSD44SOCKETS
+
+/* Builder address */
+#undef BUILDERADDR
+
+/* Builder string */
+#undef BUILDERSTRING
+
+/* Default font path */
+#undef COMPILEDDEFAULTFONTPATH
+
+/* Support Composite Extension */
+#undef COMPOSITE
+
+/* Use the D-Bus input configuration API */
+#undef CONFIG_DBUS_API
+
+/* Use the HAL hotplug API */
+#undef CONFIG_HAL
+
+/* Use D-Bus for input hotplug */
+#undef CONFIG_NEED_DBUS
+
+/* Define to one of `_getb67', `GETB67', `getb67' for Cray-2 and Cray-YMP
+   systems. This function is required for `alloca.c' support on those systems.
+   */
+#undef CRAY_STACKSEG_END
+
+/* System is BSD-like */
+#undef CSRG_BASED
+
+/* Simple debug messages */
+#undef CYGDEBUG
+
+/* Debug window manager */
+#undef CYGMULTIWINDOW_DEBUG
+
+/* Debug messages for window handling */
+#undef CYGWINDOWING_DEBUG
+
+/* Define to 1 if using `alloca.c'. */
+#undef C_ALLOCA
+
+/* Support Damage extension */
+#undef DAMAGE
+
+/* Support DBE extension */
+#undef DBE
+
+/* Use ddxBeforeReset */
+#undef DDXBEFORERESET
+
+/* Use OsVendorVErrorF */
+#undef DDXOSVERRORF
+
+/* Enable debugging code */
+#undef DEBUG
+
+/* Default library install path */
+#undef DEFAULT_LIBRARY_PATH
+
+/* Default log location */
+#undef DEFAULT_LOGPREFIX
+
+/* Default module search path */
+#undef DEFAULT_MODULE_PATH
+
+/* Support DGA extension */
+#undef DGA
+
+/* Support DPMS extension */
+#undef DPMSExtension
+
+/* Build DRI2 extension */
+#undef DRI2
+
+/* Build DRI2 AIGLX loader */
+#undef DRI2_AIGLX
+
+/* Default DRI driver path */
+#undef DRI_DRIVER_PATH
+
+/* Build GLX extension */
+#undef GLXEXT
+
+/* Support XDM-AUTH*-1 */
+#undef HASXDMAUTH
+
+/* System has /dev/xf86 aperture driver */
+#undef HAS_APERTURE_DRV
+
+/* Cygwin has /dev/windows for signaling new win32 messages */
+#undef HAS_DEVWINDOWS
+
+/* Have the 'getdtablesize' function. */
+#undef HAS_GETDTABLESIZE
+
+/* Have the 'getifaddrs' function. */
+#undef HAS_GETIFADDRS
+
+/* Have the 'getpeereid' function. */
+#undef HAS_GETPEEREID
+
+/* Have the 'getpeerucred' function. */
+#undef HAS_GETPEERUCRED
+
+/* Have the 'mmap' function. */
+#undef HAS_MMAP
+
+/* Define to 1 if NetBSD built-in MTRR support is available */
+#undef HAS_MTRR_BUILTIN
+
+/* MTRR support available */
+#undef HAS_MTRR_SUPPORT
+
+/* Support SHM */
+#undef HAS_SHM
+
+/* Have the 'strlcpy' function */
+#undef HAS_STRLCPY
+
+/* Use Windows sockets */
+#undef HAS_WINSOCK
+
+/* Define to 1 if you have `alloca', as a function or macro. */
+#undef HAVE_ALLOCA
+
+/* Define to 1 if you have <alloca.h> and it should be used (not on Ultrix).
+   */
+#undef HAVE_ALLOCA_H
+
+/* Define to 1 if you have the <asm/mtrr.h> header file. */
+#undef HAVE_ASM_MTRR_H
+
+/* Define to 1 if you have the `authdes_create' function. */
+#undef HAVE_AUTHDES_CREATE
+
+/* Define to 1 if you have the `authdes_seccreate' function. */
+#undef HAVE_AUTHDES_SECCREATE
+
+/* "Have avc_netlink_acquire_fd" */
+#undef HAVE_AVC_NETLINK_ACQUIRE_FD
+
+/* Has backtrace support */
+#undef HAVE_BACKTRACE
+
+/* Define to 1 if you have the <byteswap.h> header file. */
+#undef HAVE_BYTESWAP_H
+
+/* Have the 'cbrt' function */
+#undef HAVE_CBRT
+
+/* Define to 1 if you have the `clock_gettime' function. */
+#undef HAVE_CLOCK_GETTIME
+
+/* Define to 1 if you have the <dbm.h> header file. */
+#undef HAVE_DBM_H
+
+/* Have D-Bus support */
+#undef HAVE_DBUS
+
+/* Define to 1 if you have the <dirent.h> header file, and it defines `DIR'.
+   */
+#undef HAVE_DIRENT_H
+
+/* Define to 1 if you have the <dlfcn.h> header file. */
+#undef HAVE_DLFCN_H
+
+/* Define to 1 if you don't have `vprintf' but do have `_doprnt.' */
+#undef HAVE_DOPRNT
+
+/* Have execinfo.h */
+#undef HAVE_EXECINFO_H
+
+/* Define to 1 if you have the <fcntl.h> header file. */
+#undef HAVE_FCNTL_H
+
+/* Define to 1 if you have the `ffs' function. */
+#undef HAVE_FFS
+
+/* Define to 1 if you have the `geteuid' function. */
+#undef HAVE_GETEUID
+
+/* Define to 1 if you have the `getisax' function. */
+#undef HAVE_GETISAX
+
+/* Define to 1 if you have the `getopt' function. */
+#undef HAVE_GETOPT
+
+/* Define to 1 if you have the `getopt_long' function. */
+#undef HAVE_GETOPT_LONG
+
+/* Define to 1 if you have the `getuid' function. */
+#undef HAVE_GETUID
+
+/* Define to 1 if you have the `getzoneid' function. */
+#undef HAVE_GETZONEID
+
+/* Define to 1 if you have the <inttypes.h> header file. */
+#undef HAVE_INTTYPES_H
+
+/* Define to 1 if you have the `audit' library (-laudit). */
+#undef HAVE_LIBAUDIT
+
+/* Define to 1 if you have the <libaudit.h> header file. */
+#undef HAVE_LIBAUDIT_H
+
+/* Define to 1 if you have the `m' library (-lm). */
+#undef HAVE_LIBM
+
+/* Define to 1 if you have the `selinux' library (-lselinux). */
+#undef HAVE_LIBSELINUX
+
+/* Define to 1 if you have the `link' function. */
+#undef HAVE_LINK
+
+/* Define to 1 if you have the <linux/agpgart.h> header file. */
+#undef HAVE_LINUX_AGPGART_H
+
+/* Define to 1 if you have the <linux/apm_bios.h> header file. */
+#undef HAVE_LINUX_APM_BIOS_H
+
+/* Define to 1 if you have the <linux/fb.h> header file. */
+#undef HAVE_LINUX_FB_H
+
+/* Define to 1 if you have the <machine/mtrr.h> header file. */
+#undef HAVE_MACHINE_MTRR_H
+
+/* Define to 1 if you have the `memmove' function. */
+#undef HAVE_MEMMOVE
+
+/* Define to 1 if you have the <memory.h> header file. */
+#undef HAVE_MEMORY_H
+
+/* Define to 1 if you have the `memset' function. */
+#undef HAVE_MEMSET
+
+/* Define to 1 if you have the `mkstemp' function. */
+#undef HAVE_MKSTEMP
+
+/* Define to 1 if you have the <ndbm.h> header file. */
+#undef HAVE_NDBM_H
+
+/* Define to 1 if you have the <ndir.h> header file, and it defines `DIR'. */
+#undef HAVE_NDIR_H
+
+/* Define to 1 if you have the `pci_device_enable' function. */
+#undef HAVE_PCI_DEVICE_ENABLE
+
+/* Define to 1 if you have the `pci_device_is_boot_vga' function. */
+#undef HAVE_PCI_DEVICE_IS_BOOT_VGA
+
+/* Define to 1 if you have the `pci_device_vgaarb_init' function. */
+#undef HAVE_PCI_DEVICE_VGAARB_INIT
+
+/* Define to 1 if you have the `pci_system_init_dev_mem' function. */
+#undef HAVE_PCI_SYSTEM_INIT_DEV_MEM
+
+/* Define to 1 if you have the <rpcsvc/dbm.h> header file. */
+#undef HAVE_RPCSVC_DBM_H
+
+/* Define to 1 if you have the <selinux/avc.h> header file. */
+#undef HAVE_SELINUX_AVC_H
+
+/* Define to 1 if you have the <selinux/selinux.h> header file. */
+#undef HAVE_SELINUX_SELINUX_H
+
+/* Use CommonCrypto SHA1 functions */
+#undef HAVE_SHA1_IN_COMMONCRYPTO
+
+/* Use libc SHA1 functions */
+#undef HAVE_SHA1_IN_LIBC
+
+/* Use libgcrypt SHA1 functions */
+#undef HAVE_SHA1_IN_LIBGCRYPT
+
+/* Use libmd SHA1 functions */
+#undef HAVE_SHA1_IN_LIBMD
+
+/* Use libsha1 for SHA1 */
+#undef HAVE_SHA1_IN_LIBSHA1
+
+/* Define to 1 if you have the `shmctl64' function. */
+#undef HAVE_SHMCTL64
+
+/* Define to 1 if the system has the type `socklen_t'. */
+#undef HAVE_SOCKLEN_T
+
+/* Define to 1 if you have the <stdint.h> header file. */
+#undef HAVE_STDINT_H
+
+/* Define to 1 if you have the <stdlib.h> header file. */
+#undef HAVE_STDLIB_H
+
+/* Define to 1 if you have the `strcasestr' function. */
+#undef HAVE_STRCASESTR
+
+/* Define to 1 if you have the `strchr' function. */
+#undef HAVE_STRCHR
+
+/* Define to 1 if you have the <strings.h> header file. */
+#undef HAVE_STRINGS_H
+
+/* Define to 1 if you have the <string.h> header file. */
+#undef HAVE_STRING_H
+
+/* Define to 1 if you have the <stropts.h> header file. */
+#undef HAVE_STROPTS_H
+
+/* Define to 1 if you have the `strrchr' function. */
+#undef HAVE_STRRCHR
+
+/* Define to 1 if you have the `strtol' function. */
+#undef HAVE_STRTOL
+
+/* Define to 1 if SYSV IPC is available */
+#undef HAVE_SYSV_IPC
+
+/* Define to 1 if you have the <sys/agpgart.h> header file. */
+#undef HAVE_SYS_AGPGART_H
+
+/* Define to 1 if you have the <sys/agpio.h> header file. */
+#undef HAVE_SYS_AGPIO_H
+
+/* Define to 1 if you have the <sys/dir.h> header file, and it defines `DIR'.
+   */
+#undef HAVE_SYS_DIR_H
+
+/* Define to 1 if you have the <sys/io.h> header file. */
+#undef HAVE_SYS_IO_H
+
+/* Define to 1 if you have the <sys/kd.h> header file. */
+#undef HAVE_SYS_KD_H
+
+/* Define to 1 if you have the <sys/linker.h> header file. */
+#undef HAVE_SYS_LINKER_H
+
+/* Define to 1 if you have the <sys/memrange.h> header file. */
+#undef HAVE_SYS_MEMRANGE_H
+
+/* Define to 1 if you have the <sys/ndir.h> header file, and it defines `DIR'.
+   */
+#undef HAVE_SYS_NDIR_H
+
+/* Define to 1 if you have the <sys/stat.h> header file. */
+#undef HAVE_SYS_STAT_H
+
+/* Define to 1 if you have the <sys/types.h> header file. */
+#undef HAVE_SYS_TYPES_H
+
+/* Define to 1 if you have the <sys/vm86.h> header file. */
+#undef HAVE_SYS_VM86_H
+
+/* Define to 1 if you have the <sys/vt.h> header file. */
+#undef HAVE_SYS_VT_H
+
+/* Define to 1 if you have the <unistd.h> header file. */
+#undef HAVE_UNISTD_H
+
+/* Define to 1 if you have the `vprintf' function. */
+#undef HAVE_VPRINTF
+
+/* Define to 1 if you have the `vsnprintf' function. */
+#undef HAVE_VSNPRINTF
+
+/* Define to 1 if you have the `walkcontext' function. */
+#undef HAVE_WALKCONTEXT
+
+/* Support IPv6 for TCP connections */
+#undef IPv6
+
+/* Build kdrive ddx */
+#undef KDRIVEDDXACTIONS
+
+/* Build fbdev-based kdrive server */
+#undef KDRIVEFBDEV
+
+/* Build Kdrive X server */
+#undef KDRIVESERVER
+
+/* Prefix to use for launchd identifiers */
+#undef LAUNCHD_ID_PREFIX
+
+/* Support os-specific local connections */
+#undef LOCALCONN
+
+/* Define to the sub-directory in which libtool stores uninstalled libraries.
+   */
+#undef LT_OBJDIR
+
+/* Support MIT-SHM extension */
+#undef MITSHM
+
+/* Have monotonic clock from clock_gettime() */
+#undef MONOTONIC_CLOCK
+
+/* Build Multibuffer extension */
+#undef MULTIBUFFER
+
+/* Do not have 'strcasecmp'. */
+#undef NEED_STRCASECMP
+
+/* Do not have 'strcasestr'. */
+#undef NEED_STRCASESTR
+
+/* Do not have 'strncasecmp'. */
+#undef NEED_STRNCASECMP
+
+/* Need XFree86 helper functions */
+#undef NEED_XF86_PROTOTYPES
+
+/* Need XFree86 typedefs */
+#undef NEED_XF86_TYPES
+
+/* Define to 1 if modules should avoid the libcwrapper */
+#undef NO_LIBCWRAPPER
+
+/* Use an empty root cursor */
+#undef NULL_ROOT_CURSOR
+
+/* Operating System Name */
+#undef OSNAME
+
+/* Operating System Vendor */
+#undef OSVENDOR
+
+/* Name of package */
+#undef PACKAGE
+
+/* Define to the address where bug reports for this package should be sent. */
+#undef PACKAGE_BUGREPORT
+
+/* Define to the full name of this package. */
+#undef PACKAGE_NAME
+
+/* Define to the full name and version of this package. */
+#undef PACKAGE_STRING
+
+/* Define to the one symbol short name of this package. */
+#undef PACKAGE_TARNAME
+
+/* Define to the version of this package. */
+#undef PACKAGE_VERSION
+
+/* Major version of this package */
+#undef PACKAGE_VERSION_MAJOR
+
+/* Minor version of this package */
+#undef PACKAGE_VERSION_MINOR
+
+/* Patch version of this package */
+#undef PACKAGE_VERSION_PATCHLEVEL
+
+/* Internal define for Xinerama */
+#undef PANORAMIX
+
+/* System has PC console */
+#undef PCCONS_SUPPORT
+
+/* Default PCI text file ID path */
+#undef PCI_TXT_IDS_PATH
+
+/* System has PC console */
+#undef PCVT_SUPPORT
+
+/* Overall prefix */
+#undef PROJECTROOT
+
+/* Support RANDR extension */
+#undef RANDR
+
+/* Make PROJECT_ROOT relative to the xserver location */
+#undef RELOCATE_PROJECTROOT
+
+/* Support RENDER extension */
+#undef RENDER
+
+/* Support X resource extension */
+#undef RES
+
+/* Define as the return type of signal handlers (`int' or `void'). */
+#undef RETSIGTYPE
+
+/* Build Rootless code */
+#undef ROOTLESS
+
+/* Support MIT-SCREEN-SAVER extension */
+#undef SCREENSAVER
+
+/* Support Secure RPC ("SUN-DES-1") authentication for X11 clients */
+#undef SECURE_RPC
+
+/* Server miscellaneous config path */
+#undef SERVER_MISC_CONFIG_PATH
+
+/* Support SHAPE extension */
+#undef SHAPE
+
+/* The size of `unsigned long', as computed by sizeof. */
+#undef SIZEOF_UNSIGNED_LONG
+
+/* If using the C implementation of alloca, define if you know the
+   direction of stack growth for your system; otherwise it will be
+   automatically deduced at runtime.
+	STACK_DIRECTION > 0 => grows toward higher addresses
+	STACK_DIRECTION < 0 => grows toward lower addresses
+	STACK_DIRECTION = 0 => direction of growth unknown */
+#undef STACK_DIRECTION
+
+/* Build a standalone xpbproxy */
+#undef STANDALONE_XPBPROXY
+
+/* Define to 1 if you have the ANSI C header files. */
+#undef STDC_HEADERS
+
+/* Define to 1 on systems derived from System V Release 4 */
+#undef SVR4
+
+/* System has syscons console */
+#undef SYSCONS_SUPPORT
+
+/* Support TCP socket connections */
+#undef TCPCONN
+
+/* Have tslib support */
+#undef TSLIB
+
+/* Enable unit tests */
+#undef UNITTESTS
+
+/* Support UNIX socket connections */
+#undef UNIXCONN
+
+/* NetBSD PIO alpha IO */
+#undef USE_ALPHA_PIO
+
+/* BSD AMD64 iopl */
+#undef USE_AMD64_IOPL
+
+/* BSD /dev/io */
+#undef USE_DEV_IO
+
+/* BSD i386 iopl */
+#undef USE_I386_IOPL
+
+/* Use SIGIO handlers for input device events by default */
+#undef USE_SIGIO_BY_DEFAULT
+
+/* Define to use byteswap macros from <sys/endian.h> */
+#undef USE_SYS_ENDIAN_H
+
+/* Vendor man version */
+#undef VENDOR_MAN_VERSION
+
+/* Vendor name */
+#undef VENDOR_NAME
+
+/* Vendor name */
+#undef VENDOR_NAME_SHORT
+
+/* Vendor release */
+#undef VENDOR_RELEASE
+
+/* Version number of package */
+#undef VERSION
+
+/* Building vgahw module */
+#undef WITH_VGAHW
+
+/* Define WORDS_BIGENDIAN to 1 if your processor stores words with the most
+   significant byte first (like Motorola and SPARC, unlike Intel). */
+#if defined AC_APPLE_UNIVERSAL_BUILD
+# if defined __BIG_ENDIAN__
+#  define WORDS_BIGENDIAN 1
+# endif
+#else
+# ifndef WORDS_BIGENDIAN
+#  undef WORDS_BIGENDIAN
+# endif
+#endif
+
+/* System has wscons console */
+#undef WSCONS_SUPPORT
+
+/* Build X-ACE extension */
+#undef XACE
+
+/* Build XCalibrate extension */
+#undef XCALIBRATE
+
+/* Support XCMisc extension */
+#undef XCMISC
+
+/* Build Security extension */
+#undef XCSECURITY
+
+/* Support XDM Control Protocol */
+#undef XDMCP
+
+/* Support XF86 Big font extension */
+#undef XF86BIGFONT
+
+/* Name of configuration file */
+#undef XF86CONFIGFILE
+
+/* Build DRI extension */
+#undef XF86DRI
+
+/* Support XFree86 Video Mode extension */
+#undef XF86VIDMODE
+
+/* Support XFixes extension */
+#undef XFIXES
+
+/* Building loadable XFree86 server */
+#undef XFree86LOADER
+
+/* Building XFree86 server */
+#undef XFree86Server
+
+/* Build XDGA support */
+#undef XFreeXDGA
+
+/* Support Xinerama extension */
+#undef XINERAMA
+
+/* Path to XKB data */
+#undef XKB_BASE_DIRECTORY
+
+/* Path to XKB bin dir */
+#undef XKB_BIN_DIRECTORY
+
+/* Default XKB layout */
+#undef XKB_DFLT_LAYOUT
+
+/* Default XKB model */
+#undef XKB_DFLT_MODEL
+
+/* Default XKB options */
+#undef XKB_DFLT_OPTIONS
+
+/* Default XKB ruleset */
+#undef XKB_DFLT_RULES
+
+/* Default XKB variant */
+#undef XKB_DFLT_VARIANT
+
+/* Path to XKB output dir */
+#undef XKM_OUTPUT_DIR
+
+/* Building Xorg server */
+#undef XORGSERVER
+
+/* Vendor release */
+#undef XORG_DATE
+
+/* Vendor man version */
+#undef XORG_MAN_VERSION
+
+/* Building Xorg server */
+#undef XORG_SERVER
+
+/* Current Xorg version */
+#undef XORG_VERSION_CURRENT
+
+/* Have Quartz */
+#undef XQUARTZ
+
+/* Support application updating through sparkle. */
+#undef XQUARTZ_SPARKLE
+
+/* Support Record extension */
+#undef XRECORD
+
+/* Build registry module */
+#undef XREGISTRY
+
+/* Build SELinux extension */
+#undef XSELINUX
+
+/* Define to 1 if the DTrace Xserver provider probes should be built in. */
+#undef XSERVER_DTRACE
+
+/* Use libpciaccess for all pci manipulation */
+#undef XSERVER_LIBPCIACCESS
+
+/* Support XSync extension */
+#undef XSYNC
+
+/* Support XTest extension */
+#undef XTEST
+
+/* Support Xv extension */
+#undef XV
+
+/* Vendor name */
+#undef XVENDORNAME
+
+/* Short vendor name */
+#undef XVENDORNAMESHORT
+
+/* Build Xv extension */
+#undef XvExtension
+
+/* Build XvMC extension */
+#undef XvMCExtension
+
+/* Define to 1 if `lex' declares `yytext' as a `char *' by default, not a
+   `char[]'. */
+#undef YYTEXT_POINTER
+
+/* Number of bits in a file offset, on hosts where this is settable. */
+#undef _FILE_OFFSET_BITS
+
+/* Enable GNU and other extensions to the C environment for glibc */
+#undef _GNU_SOURCE
+
+/* Define for large files, on AIX-style hosts. */
+#undef _LARGE_FILES
+
+/* Define to 1 if unsigned long is 64 bits. */
+#undef _XSERVER64
+
+/* Vendor web address for support */
+#undef __VENDORDWEBSUPPORT__
+
+/* Name of configuration file */
+#undef __XCONFIGFILE__
+
+/* Name of X server */
+#undef __XSERVERNAME__
+
+/* Define to 16-bit byteswap macro */
+#undef bswap_16
+
+/* Define to 32-bit byteswap macro */
+#undef bswap_32
+
+/* Define to 64-bit byteswap macro */
+#undef bswap_64
+
+/* Define to empty if `const' does not conform to ANSI C. */
+#undef const
+
+/* Define to `int' if <sys/types.h> does not define. */
+#undef pid_t
diff -Naur xorg-server-20091215/include/Makefile.in xorg-server-20091215.patch/include/Makefile.in
--- xorg-server-20091215/include/Makefile.in	2009-12-15 20:10:22.000000000 +0100
+++ xorg-server-20091215.patch/include/Makefile.in	2009-12-15 23:05:03.454321280 +0100
@@ -274,6 +274,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/Makefile.in xorg-server-20091215.patch/Makefile.in
--- xorg-server-20091215/Makefile.in	2009-12-15 20:10:26.000000000 +0100
+++ xorg-server-20091215.patch/Makefile.in	2009-12-15 23:05:06.249321425 +0100
@@ -315,6 +315,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/mi/Makefile.in xorg-server-20091215.patch/mi/Makefile.in
--- xorg-server-20091215/mi/Makefile.in	2009-12-15 20:10:22.000000000 +0100
+++ xorg-server-20091215.patch/mi/Makefile.in	2009-12-15 23:05:03.638321106 +0100
@@ -299,6 +299,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/miext/cw/Makefile.in xorg-server-20091215.patch/miext/cw/Makefile.in
--- xorg-server-20091215/miext/cw/Makefile.in	2009-12-15 20:10:22.000000000 +0100
+++ xorg-server-20091215.patch/miext/cw/Makefile.in	2009-12-15 23:05:03.949321283 +0100
@@ -263,6 +263,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/miext/damage/Makefile.in xorg-server-20091215.patch/miext/damage/Makefile.in
--- xorg-server-20091215/miext/damage/Makefile.in	2009-12-15 20:10:23.000000000 +0100
+++ xorg-server-20091215.patch/miext/damage/Makefile.in	2009-12-15 23:05:04.122321749 +0100
@@ -289,6 +289,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/miext/Makefile.in xorg-server-20091215.patch/miext/Makefile.in
--- xorg-server-20091215/miext/Makefile.in	2009-12-15 20:10:22.000000000 +0100
+++ xorg-server-20091215.patch/miext/Makefile.in	2009-12-15 23:05:03.782321324 +0100
@@ -279,6 +279,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/miext/rootless/Makefile.in xorg-server-20091215.patch/miext/rootless/Makefile.in
--- xorg-server-20091215/miext/rootless/Makefile.in	2009-12-15 20:10:23.000000000 +0100
+++ xorg-server-20091215.patch/miext/rootless/Makefile.in	2009-12-15 23:05:04.289321570 +0100
@@ -264,6 +264,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/miext/shadow/Makefile.in xorg-server-20091215.patch/miext/shadow/Makefile.in
--- xorg-server-20091215/miext/shadow/Makefile.in	2009-12-15 20:10:23.000000000 +0100
+++ xorg-server-20091215.patch/miext/shadow/Makefile.in	2009-12-15 23:05:04.466321537 +0100
@@ -294,6 +294,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/os/Makefile.in xorg-server-20091215.patch/os/Makefile.in
--- xorg-server-20091215/os/Makefile.in	2009-12-15 20:10:23.000000000 +0100
+++ xorg-server-20091215.patch/os/Makefile.in	2009-12-15 23:05:04.656321449 +0100
@@ -288,6 +288,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/randr/Makefile.in xorg-server-20091215.patch/randr/Makefile.in
--- xorg-server-20091215/randr/Makefile.in	2009-12-15 20:10:24.000000000 +0100
+++ xorg-server-20091215.patch/randr/Makefile.in	2009-12-15 23:05:04.834321536 +0100
@@ -298,6 +298,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/record/Makefile.in xorg-server-20091215.patch/record/Makefile.in
--- xorg-server-20091215/record/Makefile.in	2009-12-15 20:10:24.000000000 +0100
+++ xorg-server-20091215.patch/record/Makefile.in	2009-12-15 23:05:05.000321586 +0100
@@ -263,6 +263,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/render/Makefile.in xorg-server-20091215.patch/render/Makefile.in
--- xorg-server-20091215/render/Makefile.in	2009-12-15 20:10:24.000000000 +0100
+++ xorg-server-20091215.patch/render/Makefile.in	2009-12-15 23:05:05.176321224 +0100
@@ -292,6 +292,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/test/Makefile.in xorg-server-20091215.patch/test/Makefile.in
--- xorg-server-20091215/test/Makefile.in	2009-12-15 20:10:24.000000000 +0100
+++ xorg-server-20091215.patch/test/Makefile.in	2009-12-15 23:05:05.374321601 +0100
@@ -334,6 +334,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/test/xi2/Makefile.in xorg-server-20091215.patch/test/xi2/Makefile.in
--- xorg-server-20091215/test/xi2/Makefile.in	2009-12-15 20:10:25.000000000 +0100
+++ xorg-server-20091215.patch/test/xi2/Makefile.in	2009-12-15 23:05:05.721338437 +0100
@@ -401,6 +401,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/Xext/Makefile.in xorg-server-20091215.patch/Xext/Makefile.in
--- xorg-server-20091215/Xext/Makefile.in	2009-12-15 20:10:05.000000000 +0100
+++ xorg-server-20091215.patch/Xext/Makefile.in	2009-12-15 23:04:50.046321584 +0100
@@ -364,6 +364,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/xfixes/Makefile.in xorg-server-20091215.patch/xfixes/Makefile.in
--- xorg-server-20091215/xfixes/Makefile.in	2009-12-15 20:10:25.000000000 +0100
+++ xorg-server-20091215.patch/xfixes/Makefile.in	2009-12-15 23:05:05.898321362 +0100
@@ -290,6 +290,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/Xi/Makefile.in xorg-server-20091215.patch/Xi/Makefile.in
--- xorg-server-20091215/Xi/Makefile.in	2009-12-15 20:10:05.000000000 +0100
+++ xorg-server-20091215.patch/Xi/Makefile.in	2009-12-15 23:04:50.225321169 +0100
@@ -274,6 +274,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
diff -Naur xorg-server-20091215/xkb/Makefile.in xorg-server-20091215.patch/xkb/Makefile.in
--- xorg-server-20091215/xkb/Makefile.in	2009-12-15 20:10:25.000000000 +0100
+++ xorg-server-20091215.patch/xkb/Makefile.in	2009-12-15 23:05:06.086321104 +0100
@@ -299,6 +299,8 @@
 STRIP = @STRIP@
 TSLIB_CFLAGS = @TSLIB_CFLAGS@
 TSLIB_LIBS = @TSLIB_LIBS@
+UDEV_CFLAGS = @UDEV_CFLAGS@
+UDEV_LIBS = @UDEV_LIBS@
 UTILS_SYS_LIBS = @UTILS_SYS_LIBS@
 VENDOR_NAME_SHORT = @VENDOR_NAME_SHORT@
 VERSION = @VERSION@
