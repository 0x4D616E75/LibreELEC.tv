#!/bin/sh

. config/options

$SCRIPTS/build toolchain

cd $BUILD/$1*

cp -R mkspecs/linux-g++ mkspecs/linux-g++-cross
cp -R mkspecs/common/g++.conf mkspecs/common/g++-cross.conf
sed -i -e "s|g++.conf|g++-cross.conf|" mkspecs/linux-g++-cross/qmake.conf

sed -i -e "s|^QMAKE_INCDIR_X11[[:space:]]*=.*$|QMAKE_INCDIR_X11 = $SYSROOT_PREFIX/usr/include|" \
       -e "s|^QMAKE_LIBDIR_X11[[:space:]]*=.*$|QMAKE_LIBDIR_X11 = $SYSROOT_PREFIX/usr/lib|" \
       -e "s|^QMAKE_INCDIR_OPENGL[[:space:]]*=.*$|QMAKE_INCDIR_OPENGL = $SYSROOT_PREFIX/usr/include|" \
       -e "s|^QMAKE_LIBDIR_OPENGL[[:space:]]*=.*$|QMAKE_LIBDIR_OPENGL = $SYSROOT_PREFIX/usr/lib|" \
       -e "s|^QMAKE_AR[[:space:]]*=.*$|QMAKE_AR = ${TARGET_PREFIX}ar cqs|" \
       -e "s|^QMAKE_OBJCOPY[[:space:]]*=.*$|QMAKE_OBJCOPY = ${TARGET_PREFIX}objcopy|" \
       -e "s|^QMAKE_RANLIB[[:space:]]*=.*$|QMAKE_RANLIB = ${TARGET_PREFIX}ranlib|" \
       -e "s|^QMAKE_STRIP[[:space:]]*=.*$|QMAKE_STRIP = ${TARGET_PREFIX}strip|" \
       mkspecs/common/linux.conf

sed -i	-e "s|^QMAKE_CC[[:space:]]*=.*$|QMAKE_CC = $HOST_CC|" \
       -e "s|^QMAKE_CXX[[:space:]]*=.*$|QMAKE_CXX = $HOST_CXX|" \
       -e "s|^QMAKE_LINK[[:space:]]*=.*$|QMAKE_LINK = $HOST_CXX|" \
       -e "s|^QMAKE_LINK_SHLIB[[:space:]]*=.*$|QMAKE_LINK_SHLIB = $HOST_CXX|" \
       -e "s|^QMAKE_LINK_C[[:space:]]*=.*$|QMAKE_LINK_C = $HOST_CC|" \
       -e "s|^QMAKE_LINK_C_SHLIB[[:space:]]*=.*$|QMAKE_LINK_C_SHLIB = $HOST_CC|" \
       mkspecs/common/g++.conf

sed -i	-e "s|^QMAKE_CC[[:space:]]*=.*$|QMAKE_CC = $TARGET_CC|" \
       -e "s|^QMAKE_CXX[[:space:]]*=.*$|QMAKE_CXX = $TARGET_CXX|" \
       -e "s|^QMAKE_LINK[[:space:]]*=.*$|QMAKE_LINK = $TARGET_CXX|" \
       -e "s|^QMAKE_LINK_SHLIB[[:space:]]*=.*$|QMAKE_LINK_SHLIB = $TARGET_CXX|" \
       -e "s|^QMAKE_LINK_C[[:space:]]*=.*$|QMAKE_LINK_C = $TARGET_CC|" \
       -e "s|^QMAKE_LINK_C_SHLIB[[:space:]]*=.*$|QMAKE_LINK_C_SHLIB = $TARGET_CC|" \
       -e "s|^QMAKE_CFLAGS[[:space:]]*=.*$|QMAKE_CFLAGS = $TARGET_CFLAGS|" \
       -e "s|^QMAKE_CFLAGS_RELEASE[[:space:]]*=.*$|QMAKE_CFLAGS_RELEASE = $TARGET_CFLAGS|" \
       mkspecs/common/g++-cross.conf

sed -i	-e 's/^CFG_IPV6=auto/CFG_IPV6=no/' \
       -e 's/^CFG_IPV6IFNAME=auto/CFG_IPV6IFNAME=no/' \
       -e 's/^CFG_XINERAMA=auto/CFG_XINERAMA=no/' \
       configure

#-e "s|^QMAKE_INCDIR[[:space:]]*=.*$|QMAKE_INCDIR = $SYSROOT_PREFIX/usr/include|" \
#-e "s|^QMAKE_LIBDIR[[:space:]]*=.*$|QMAKE_LIBDIR = $SYSROOT_PREFIX/usr/lib|" \