#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build SDL
$SCRIPTS/build zlib
$SCRIPTS/build libpng
$SCRIPTS/build Mesa

export force_arch="$TARGET_CPU" \
export CC_FOR_BUILD="$HOST_CC" \
export CXX_FOR_BUILD="$HOST_CXX" \
export CPPFLAGS_FOR_BUILD="$HOST_CPPFLAGS" \
export CFLAGS_FOR_BUILD="$HOST_CFLAGS" \
export CXXFLAGS_FOR_BUILD="$HOST_CXXFLAGS" \
export LDFLAGS_FOR_BUILD="$HOST_LDFLAGS" \
export SDL_CONFIG=$ROOT/$TOOLCHAIN/bin/sdl-config

cd $PKG_BUILD/src

$AUTORECONF
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=/usr \
            --sysconfdir=/etc \
            --enable-release \
            --disable-debug \
            --disable-debugger \
            --disable-cpucheck \
            --disable-sdltest \
            --enable-opengl \
            --with-opengl-prefix=$SYSROOT_PREFIX/usr \
            --enable-jma \
            --enable-libpng \
            --with-libpng-prefix=$SYSROOT_PREFIX/usr \
            --with-zlib-prefix=$SYSROOT_PREFIX/usr \
            --with-x \

make
