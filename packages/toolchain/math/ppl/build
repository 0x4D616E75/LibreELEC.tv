#!/bin/sh

. config/options

$SCRIPTS/install ccache
$SCRIPTS/build gmp

setup_toolchain host

cd $BUILD/$1*

mkdir -p objdir
cd objdir

../configure --host=$HOST_NAME \
             --build=$HOST_NAME \
             --target=$TARGET_NAME \
             --prefix=$ROOT/$TOOLCHAIN \
             --disable-shared \
             --enable-static \
             --enable-interfaces="c,cxx" \
             --disable-optimization \
             --with-libgmp-prefix="$ROOT/$TOOLCHAIN" \
             --with-libgmpxx-prefix="$ROOT/$TOOLCHAIN" \

make

mkdir -p $ROOT/$TOOLCHAIN/lib
  cp -PR interfaces/C/.libs/libppl_c.a $ROOT/$TOOLCHAIN/lib
  cp -PR src/.libs/libppl.a $ROOT/$TOOLCHAIN/lib
  cp -PR Watchdog/src/.libs/libpwl.a $ROOT/$TOOLCHAIN/lib

mkdir -p $ROOT/$TOOLCHAIN/include
  cp -PR interfaces/C/ppl_c.h $ROOT/$TOOLCHAIN/include
  cp -PR src/ppl.hh $ROOT/$TOOLCHAIN/include
  cp -PR Watchdog/src/pwl.hh $ROOT/$TOOLCHAIN/include
