#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build gettext
$SCRIPTS/build dbus
$SCRIPTS/build glib
$SCRIPTS/build expat

cd $PKG_BUILD

export ac_cv_have_abstract_sockets=yes
export ac_cv_func_posix_getpwnam_r=yes
export have_abstract_sockets=yes

export CFLAGS="$CFLAGS -I$SYSROOT_PREFIX/usr/include"
export LDFLAGS="$LDFLAGS -L$SYSROOT_PREFIX/usr/lib"

./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=/usr \
            --sysconfdir=/etc \
            --localstatedir=/var \
            --disable-static \
            --enable-shared \
            --disable-tests \
            --disable-doxygen-docs \
            --enable-asserts=no \

make -C dbus SUBDIRS="."

make -C dbus DESTDIR=$SYSROOT_PREFIX install-libdbus_glibHEADERS
make -C dbus DESTDIR=$SYSROOT_PREFIX install-libLTLIBRARIES
make DESTDIR=$SYSROOT_PREFIX install-pkgconfigDATA
