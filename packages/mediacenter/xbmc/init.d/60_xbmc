# starting XBMC
#
# runlevels: openelec

. /etc/profile

progress "starting XBMC"

  XBMC_ARGS="--standalone -fs --lircdev /dev/lircd"

  [ -f /usr/bin/autoupdate ] && /usr/bin/autoupdate &

  while true; do

    DISPLAY=:0.0 xbmc $XBMC_ARGS > /dev/null 2>&1
    RET=$?
    echo "Exited with code $RET"

    [ "$RET" == 0 ] && sync && poweroff
    [ "$RET" == 64 ] && sync && poweroff
    [ "$RET" == 66 ] && sync && reboot

    usleep 250000
  done
