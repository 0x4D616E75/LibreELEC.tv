From c8fda2e4646fede5dc243b36f3497ec4f3228e68 Mon Sep 17 00:00:00 2001
From: Oleg Oshmyan <chortos@inbox.lv>
Date: Fri, 4 Apr 2014 22:56:56 +0300
Subject: [PATCH] Fix libass ass_read_memory() signature

---
 xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitlesLibass.cpp | 2 +-
 xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitlesLibass.h   | 2 +-
 xbmc/cores/dvdplayer/DVDSubtitles/DllLibass.h            | 3 ++-
 3 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitlesLibass.cpp b/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitlesLibass.cpp
index 37c9b09..73a7995 100644
--- a/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitlesLibass.cpp
+++ b/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitlesLibass.cpp
@@ -136,7 +136,7 @@ bool CDVDSubtitlesLibass::DecodeDemuxPkt(char* data, int size, double start, dou
   return true;
 }
 
-bool CDVDSubtitlesLibass::CreateTrack(char* buf, int size)
+bool CDVDSubtitlesLibass::CreateTrack(char* buf, size_t size)
 {
   CSingleLock lock(m_section);
   if(!m_library)
diff --git a/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitlesLibass.h b/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitlesLibass.h
index 1722ca9..ee30436 100644
--- a/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitlesLibass.h
+++ b/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitlesLibass.h
@@ -39,7 +39,7 @@ class CDVDSubtitlesLibass : public IDVDResourceCounted<CDVDSubtitlesLibass>
 
   bool DecodeHeader(char* data, int size);
   bool DecodeDemuxPkt(char* data, int size, double start, double duration);
-  bool CreateTrack(char* buf, int size);
+  bool CreateTrack(char* buf, size_t size);
 
 private:
   DllLibass m_dll;
diff --git a/xbmc/cores/dvdplayer/DVDSubtitles/DllLibass.h b/xbmc/cores/dvdplayer/DVDSubtitles/DllLibass.h
index 4a3cd76..6e30ea4 100644
--- a/xbmc/cores/dvdplayer/DVDSubtitles/DllLibass.h
+++ b/xbmc/cores/dvdplayer/DVDSubtitles/DllLibass.h
@@ -53,6 +53,7 @@ class DllLibassInterface
   virtual ASS_Image* ass_render_frame(ASS_Renderer *priv, ASS_Track* track, long long now, int* detect_change)=0;
   virtual ASS_Track* ass_new_track(ASS_Library*)=0;
   virtual ASS_Track* ass_read_file(ASS_Library* library, char* fname, char* codepage)=0;
+  virtual ASS_Track* ass_read_memory(ASS_Library* library, char* buf, size_t bufsize, char* codepage)=0;
   virtual void ass_free_track(ASS_Track* track)=0;
   virtual void ass_set_fonts(ASS_Renderer *priv, const char *default_font, const char *default_family, int fc, const char *config, int update) = 0;
   virtual void ass_set_style_overrides(ASS_Library* priv, char** list)=0;
@@ -80,7 +81,7 @@ class DllLibass : public DllDynamic, DllLibassInterface
   DEFINE_METHOD4(ASS_Image *, ass_render_frame, (ASS_Renderer * p1, ASS_Track * p2, long long p3, int * p4))
   DEFINE_METHOD1(ASS_Track *, ass_new_track, (ASS_Library * p1))
   DEFINE_METHOD3(ASS_Track *, ass_read_file, (ASS_Library * p1, char * p2, char * p3))
-  DEFINE_METHOD4(ASS_Track *, ass_read_memory, (ASS_Library * p1, char * p2, int p3, char * p4))
+  DEFINE_METHOD4(ASS_Track *, ass_read_memory, (ASS_Library * p1, char * p2, size_t p3, char * p4))
   DEFINE_METHOD1(void, ass_free_track, (ASS_Track * p1))
   DEFINE_METHOD6(void, ass_set_fonts, (ASS_Renderer* p1, const char* p2, const char* p3, int p4, const char* p5, int p6))
   DEFINE_METHOD2(void, ass_set_style_overrides, (ASS_Library* p1, char** p2))
-- 
1.9.1

