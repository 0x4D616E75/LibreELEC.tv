diff -Naur xbmc-pvr-27594.orig/language/Chinese (Simple)/strings.xml xbmc-pvr-27594.patch/language/Chinese (Simple)/strings.xml
--- xbmc-pvr-27594.orig/language/Chinese (Simple)/strings.xml	2010-02-08 18:51:27.000000000 +0100
+++ xbmc-pvr-27594.patch/language/Chinese (Simple)/strings.xml	2010-02-09 07:31:57.947899745 +0100
@@ -1,6 +1,6 @@
 ﻿<?xml version="1.0" encoding="utf-8" standalone="yes"?>
 <!--$Revision: 27568 $-->
-<!--Based on english strings version 27501 -->
+<!--Based on english strings version 27556 -->
 <strings>
   <string id="0">程序</string>
   <string id="1">图片</string>
@@ -289,7 +289,7 @@
   <string id="343">调整帧数</string>
   <string id="344">演员</string>
   <string id="345">年份</string>
-  <string id="346">规范音量</string>
+  <string id="346">增加声道缩减混音音量</string>
   <string id="350">程序</string>
   <string id="351">关</string>
   <string id="352">昏暗</string>
@@ -476,7 +476,7 @@
   <string id="545">音频输出设备</string>
   <string id="546">直通输出设备</string>
   <string id="547">此艺人没有传记</string>
-  <string id="548">多声道音频 Downmix 转换为立体声</string>
+  <string id="548">多声道音频声道缩减混音成立体声</string>
 
   <string id="550">排序：%s</string>
   <string id="551">名称</string>
diff -Naur xbmc-pvr-27594.orig/language/Chinese (Simple)/strings.xml.orig xbmc-pvr-27594.patch/language/Chinese (Simple)/strings.xml.orig
--- xbmc-pvr-27594.orig/language/Chinese (Simple)/strings.xml.orig	1970-01-01 01:00:00.000000000 +0100
+++ xbmc-pvr-27594.patch/language/Chinese (Simple)/strings.xml.orig	2010-02-09 07:31:57.957899336 +0100
@@ -0,0 +1,2205 @@
+﻿<?xml version="1.0" encoding="utf-8" standalone="yes"?>
+<!--$Revision: 27568 $-->
+<!--Based on english strings version 27501 -->
+<strings>
+  <string id="0">程序</string>
+  <string id="1">图片</string>
+  <string id="2">音乐</string>
+  <string id="3">视频</string>
+  <string id="4">节目预告</string>
+  <string id="5">系统设置</string>
+  <string id="6">XBMC SVN</string>
+  <string id="7">文件管理</string>
+  <string id="8">天气</string>
+  <string id="9">XBMC媒体中心</string>
+  
+  <string id="11">星期一</string>
+  <string id="12">星期二</string>
+  <string id="13">星期三</string>
+  <string id="14">星期四</string>
+  <string id="15">星期五</string>
+  <string id="16">星期六</string>
+  <string id="17">星期日</string>
+  
+  <string id="21">一月</string>
+  <string id="22">二月</string>
+  <string id="23">三月</string>
+  <string id="24">四月</string>
+  <string id="25">五月</string>
+  <string id="26">六月</string>
+  <string id="27">七月</string>
+  <string id="28">八月</string>
+  <string id="29">九月</string>
+  <string id="30">十月</string>
+  <string id="31">十一月</string>
+  <string id="32">十二月</string>
+  
+  <string id="41">星期一</string>
+  <string id="42">星期二</string>
+  <string id="43">星期三</string>
+  <string id="44">星期四</string>
+  <string id="45">星期五</string>
+  <string id="46">星期六</string>
+  <string id="47">星期日</string>
+
+  <string id="51">一月</string>
+  <string id="52">二月</string>
+  <string id="53">三月</string>
+  <string id="54">四月</string>
+  <string id="55">五月</string>
+  <string id="56">六月</string>
+  <string id="57">七月</string>
+  <string id="58">八月</string>
+  <string id="59">九月</string>
+  <string id="60">十月</string>
+  <string id="61">十一月</string>
+  <string id="62">十二月</string>
+
+  <string id="98">显示：自动</string>
+  <string id="99">显示：自动大图标</string>
+  <string id="100">显示：图标</string>
+  <string id="101">显示：列表</string>
+  <string id="102">扫描</string>
+  <string id="103">排序：名称</string>
+  <string id="104">排序：日期</string>
+  <string id="105">排序：大小</string>
+  <string id="106">否</string>
+  <string id="107">是</string>
+  <string id="108">幻灯片播放</string>
+  <string id="109">创建缩略图册</string>
+  <string id="110">创建缩略图</string>
+  <string id="111">快捷方式</string>
+  <string id="112">暂停</string>
+
+  <string id="115">复制</string>
+  <string id="116">移动</string>
+  <string id="117">删除</string>
+  <string id="118">重命名</string>
+  <string id="119">新文件夹</string>
+  <string id="120">确认复制文件</string>
+  <string id="121">确认移动文件</string>
+  <string id="122">确认删除文件</string>
+  <string id="123">复制这些文件？</string>
+  <string id="124">移动这些文件？</string>
+  <string id="125">删除这些文件？</string>
+  <string id="126">状态</string>
+  <string id="127">对象</string>
+  <string id="128">常用</string>
+  <string id="129">幻灯片播放</string>
+  <string id="130">系统信息</string>
+  <string id="131">显示器</string>
+  <string id="132">专辑</string>
+  <string id="133">艺人</string>
+  <string id="134">歌曲</string>
+  <string id="135">类型</string>
+  <string id="136">播放列表</string>
+  <string id="137">查找</string>
+  <string id="138">系统信息</string>
+  <string id="139">温度：</string>
+  <string id="140">CPU：</string>
+  <string id="141">GPU：</string>
+  <string id="142">时间：</string>
+  <string id="143">当前：</string>
+  <string id="144">版本：</string>
+  <string id="145">网络：</string>
+  <string id="146">类型：</string>
+  <string id="147">手动（静态分配）</string>
+  <string id="148">自动（动态分配）</string>
+  <string id="149">网卡物理地址（MAC）</string>
+  <string id="150">IP 地址</string>
+  <string id="151">连接：</string>
+  <string id="152">半双工</string>
+  <string id="153">全双工</string>
+  <string id="154">存储器</string>
+  <string id="155">驱动器</string>
+  <string id="156">空闲</string>
+  <string id="157">视频</string>
+  <string id="158">空闲内存</string>
+  <string id="159">无连接</string>
+  <string id="160">空闲</string>
+  <string id="161">无效的</string>
+  <string id="162">光驱开启</string>
+  <string id="163">读取中</string>
+  <string id="164">无盘</string>
+  <string id="165">当前光盘</string>
+  <string id="166">皮肤</string>
+  <string id="167">启用 FTP 服务器</string>
+  <string id="168"></string>
+  <string id="169">分辨率</string>
+  <string id="170">调整显示器刷新率适应视频</string>
+  <string id="171">把 4:3 节目拉伸到 16:9</string>
+
+
+  <string id="172">发行时间</string>
+
+  <string id="175">音调</string>
+  <string id="176">风格</string>
+
+  <string id="179">歌曲</string>
+  <string id="180">持续时间</string>
+  <string id="181">选择专辑</string>
+  <string id="182">音轨</string>
+  <string id="183">评论</string>
+  <string id="184">刷新</string>
+  <string id="185">查找专辑</string>
+  <string id="186">确定</string>
+  <string id="187">没有找到专辑！</string>
+  <string id="188">全部选择</string>
+  <string id="189">查找媒体信息</string>
+  <string id="190">保存</string>
+  <string id="191">乱序播放</string>
+  <string id="192">清除</string>
+  <string id="193">查找</string>
+  <string id="194">查找...</string>
+  <string id="195">没有发现信息！</string>
+  <string id="196">选择视频：</string>
+  <string id="197">读取%s信息</string>
+  <string id="198">载入视频详细资料</string>
+
+  <string id="202">标语</string>
+  <string id="203">大纲</string>
+
+  <string id="205">得票：</string>
+  <string id="206">演员表</string>
+  <string id="207">剧情简介</string>
+  <string id="208">播放</string>
+  <string id="209">下一首</string>
+  <string id="210">上一首</string>
+  <string id="213">界面校准</string>
+  <string id="214">屏幕校准</string>
+  <string id="215">柔化</string>
+  <string id="216">缩放</string>
+  <string id="217">画面宽高比</string>
+  <string id="218">DVD 驱动器</string>
+  <string id="219">请放入光盘</string>
+  <string id="220">远程共享</string>
+  <string id="221">网络未连接</string>
+  <string id="222">取消</string>
+  <string id="224">速度</string>
+
+  <string id="226">测试图案...</string>
+  <string id="227">从 freedb.org 获取音乐 CD 信息</string>
+  <string id="228">载入播放列表时打乱顺序</string>
+  <string id="229">硬盘停转时间</string>
+  <string id="230">视频滤镜</string>
+  <string id="231">无</string>
+  <string id="232">点</string>
+  <string id="233">线性</string>
+  <string id="234">非等方性</string>
+  <string id="235">梅花多重取样</string>
+  <string id="236">三维锐化</string>
+  <string id="237">缩小</string>
+  <string id="238">放大</string>
+  <string id="239">播放完成后清除列表</string>
+
+  <string id="247">脚本</string>
+  <string id="248">语言</string>
+  <string id="249">音乐</string>
+  <string id="250">视觉效果</string>
+  <string id="251">选择目标目录</string>
+  <string id="252">双声道时输出到所有扬声器</string>
+  <string id="253">通道数</string>
+  <string id="254">- DTS 数字音效</string>
+  <string id="255">CDDB</string>
+  <string id="256">获取 CD 信息</string>
+  <string id="257">错误</string>
+  <string id="258">启用音乐文件标签信息读取</string>
+  <string id="259">开始</string>
+  <string id="260">Shoutcast 网络音乐台</string>
+  <string id="261">等待开始...</string>
+  <string id="262">脚本输出</string>
+  <string id="263">允许通过 HTTP 控制 XBMC</string>
+  <string id="264">录音</string>
+  <string id="265">停止录音</string>
+  <string id="266">排序：音轨</string>
+  <string id="267">排序：时间</string>
+  <string id="268">排序：标题</string>
+  <string id="269">排序：艺人</string>
+  <string id="270">排序：专辑</string>
+  <string id="271">前100排名榜</string>
+  <string id="272">左上角过扫描补偿</string>
+  <string id="273">右下角过扫描补偿</string>
+  <string id="274">字幕位置</string>
+  <string id="275">画面纵横比调整</string>
+  <string id="276">移动箭头改变过扫描补偿边框</string>
+  <string id="277">移动横线改变字幕位置</string>
+  <string id="278">调整屏幕中央的方框为长宽相等的完美正方形</string>
+  <string id="279">不能读取设置</string>
+  <string id="280">使用默认预设值</string>
+  <string id="281">请检查 .xml 文件</string>
+  <string id="282">找到%i条</string>
+  <string id="283">查找结果</string>
+  <string id="284">无结果</string>
+  <string id="286">后处理滤镜</string>
+  <string id="287">字幕</string>
+  <string id="288">字体</string>
+  <string id="289">- 尺寸</string>
+  <string id="290">动态范围压缩</string>
+  <string id="291">视频</string>
+  <string id="292">音频</string>
+  <string id="293">字幕浏览</string>
+  <string id="294">创建书签</string>
+  <string id="296">清除书签</string>
+  <string id="297">声音延迟</string>
+  <string id="298">书签</string>
+  <string id="299">- AAC 数字音效</string>
+  <string id="300">- MP1 数字音效</string>
+  <string id="301">- MP2 数字音效</string>
+  <string id="302">- MP3 数字音效</string>
+  <string id="303">延迟</string>
+  <string id="304">语言</string>
+  <string id="305">开启</string>
+  <string id="306">去交错（隔行变逐行）</string>
+  <string id="307">- 自动后处理</string>
+  <string id="308">- 垂直区块滤波器</string>
+  <string id="309">- 水平区块滤波器</string>
+  <string id="310">- 自动亮度/对比度调节</string>
+  <string id="311">- 消除压缩带来的画面瑕疵</string>
+  <string id="312">（0=自动）</string>
+  <string id="313">清理资料库</string>
+  <string id="314">准备中...</string>
+  <string id="315">资料库错误！</string>
+  <string id="316">搜寻歌曲...</string>
+  <string id="317">成功清理资料库！</string>
+  <string id="318">清理歌曲...</string>
+  <string id="319">清理歌曲错误！</string>
+  <string id="320">清理艺人信息...</string>
+  <string id="321">清理艺人信息错误！</string>
+  <string id="322">清理类型信息...</string>
+  <string id="323">清理类型信息错误！</string>
+  <string id="324">清理路径信息...</string>
+  <string id="325">清理路径信息错误！</string>
+  <string id="326">清理专辑...</string>
+  <string id="327">清理专辑错误！</string>
+  <string id="328">写入更新中...</string>
+  <string id="329">写入错误！</string>
+  <string id="330">这需要一些时间...</string>
+  <string id="331">压缩资料库中...</string>
+  <string id="332">压缩资料库错误！</string>
+  <string id="333">要清理资料库吗？</string>
+  <string id="334">清理资料库...</string>
+  <string id="335">开始</string>
+  <string id="336">帧数转换</string>
+  <string id="337">音频输出</string>
+  <string id="338">模拟</string>
+  <string id="339">数码</string>
+  <string id="340">群星</string>
+  <string id="341">播放光盘</string>
+  <string id="342">电影</string>
+  <string id="343">调整帧数</string>
+  <string id="344">演员</string>
+  <string id="345">年份</string>
+  <string id="346">规范音量</string>
+  <string id="350">程序</string>
+  <string id="351">关</string>
+  <string id="352">昏暗</string>
+  <string id="353">全黑</string>
+  <string id="354">骇客任务</string>
+  <string id="355">屏保空闲时间</string>
+  <string id="356">屏幕保护模式</string>
+  <string id="357">自动关机功能计时器</string>
+  <string id="358">全部专辑</string>
+  <string id="359">新加的专辑</string>
+  <string id="360">屏幕保护</string>
+  <string id="361">幻灯全部目录</string>
+  <string id="362">屏幕保护画面亮度衰减级别</string>
+  <string id="363">排序：文件</string>
+  <string id="364">- AC3 数字音效</string>
+  <string id="365">排序：名字</string>
+  <string id="366">排序：年份</string>
+  <string id="367">排序：评分</string>
+  <string id="368">IMDb</string>
+  <string id="369">标题</string>
+  <string id="370">雷雨</string>
+  <string id="371">局部</string>
+  <string id="372">大部分</string>
+  <string id="373">晴朗</string>
+  <string id="374">阴</string>
+  <string id="375">雪</string>
+  <string id="376">雨</string>
+  <string id="377">细</string>
+  <string id="378">上午</string>
+  <string id="379">下午</string>
+  <string id="380">阵雨</string>
+  <string id="381">少数</string>
+  <string id="382">短时有</string>
+  <string id="383">风</string>
+  <string id="384">强烈</string>
+  <string id="385">转晴</string>
+  <string id="386">晴</string>
+  <string id="387">云</string>
+  <string id="388">提早</string>
+  <string id="389">阵雨</string>
+  <string id="390">飘雪</string>
+  <string id="391">低</string>
+  <string id="392">中</string>
+  <string id="393">高</string>
+  <string id="394">雾</string>
+  <string id="395">薄雾</string>
+  <string id="396">位置选择</string>
+  <string id="397">刷新时间</string>
+  <string id="398">温度单位</string>
+  <string id="399">速度单位</string>
+  <string id="400">天气</string>
+  <string id="401">温度</string>
+  <string id="402">体感温度</string>
+  <string id="403">紫外线</string>
+  <string id="404">风</string>
+  <string id="405">露点</string>
+  <string id="406">湿度</string>
+  <string id="407">风向</string>
+  <string id="408">风速</string>
+  <string id="409">默认</string> 
+  
+  <string id="410">访问天气服务</string>
+  <string id="411">取得天气数据：</string>
+  <string id="412">不能获得天气数据</string>
+  <string id="413">手动查询</string>
+  <string id="414">此专辑无评论</string>
+  <string id="415">下载缩略图...</string>
+  <string id="416">不可用</string>
+  <string id="417">显示：大图标</string>
+
+  <string id="422">删除专辑信息</string>
+  <string id="423">删除 CD 信息</string>
+  <string id="424">选择</string>
+  <string id="425">找不到专辑信息。</string>
+  <string id="426">找不到 CD 信息！</string>
+  <string id="427">光盘</string>
+  <string id="428">请放入正确的 CD/DVD</string>
+  <string id="429">请放入下一张 CD/DVD</string>
+  <string id="430">排序：DVD#</string>
+  <string id="431">无缓存</string>
+  <string id="432">从资料库中移除影片</string>
+  <string id="433">确定移除'%s'？</string>
+
+  <string id="437">移动磁盘</string>
+  <string id="438">打开文件</string>
+  <string id="439">缓存</string>
+  <string id="440">硬盘</string>
+  <string id="441">UDF</string>
+  <string id="442">网络</string>
+  <string id="443">互联网</string>
+  <string id="444">视频</string>
+  <string id="445">音频</string>
+  <string id="446">DVD</string>
+  <string id="447">自动播放媒体</string>
+  <string id="448">液晶屏设置</string>
+  <string id="449">开启</string>
+  <string id="450">列</string>
+  <string id="451">第 1 行位置</string>
+  <string id="452">第 2 行位置</string>
+  <string id="453">第 3 行位置</string>
+  <string id="454">第 4 行位置</string>
+  <string id="455">行</string>
+  <string id="456">模式</string>
+  <string id="457">选择显示</string>
+  <string id="459">字幕</string>
+  <string id="460">音频流</string>
+  <string id="461">[启用]</string>
+  <string id="462">字幕</string>
+  <string id="463">背光</string>
+  <string id="464">亮度</string>
+  <string id="465">对比度</string>
+  <string id="466">伽码</string>
+  <string id="467">类型</string>
+  <string id="468">移动条块来改变 OSD 位置</string>
+  <string id="469">OSD 位置</string>
+  <string id="470">改机者</string>
+  <string id="471">改机芯片</string>
+  <string id="474">关</string>
+  <string id="475">只有音乐</string>
+  <string id="476">音乐和视频</string>
+  <string id="477">不能读取播放列表</string>
+  <string id="478">OSD</string>
+  <string id="479">皮肤和语言</string>
+  <string id="480">用户界面</string>
+  <string id="481">音频设置</string>
+  <string id="482">关于 XBMC</string>
+
+  <string id="485">删除专辑</string>
+  <string id="486">重复</string>
+  <string id="487">重复单首</string>
+  <string id="488">重复整个目录</string>
+  <string id="489">自动播放下一首歌曲</string>
+  <string id="491">- 使用大图标</string>
+  <string id="492">Vobsubs 字幕缩放</string>
+  <string id="493">高级选项（仅适用于专家！）</string>
+  <string id="494">总体音量</string>
+  <string id="495">以桌面的分辨率播放视频</string>
+  <string id="496">校准</string>
+  <string id="497">显示扩展文件名</string>
+  <string id="498">排序：类型</string>
+  <string id="499">无法连接到在线搜索服务</string>
+  <string id="500">下载专辑信息失败...</string>
+  <string id="501">寻找专辑名...</string>
+  <string id="502">开启</string>
+  <string id="503">忙</string>
+  <string id="504">空</string>
+  <string id="505">从文件中载入媒体信息...</string>
+  <string id="507">排序：使用次数</string>
+  <string id="510">开启可视化效果</string>
+  <string id="511">启用视频模式自动切换</string>
+  <string id="512">启动界面</string>
+  <string id="513">主界面</string>
+  <string id="514">设置界面</string>
+  <string id="515">风格</string>
+
+  <string id="517">最近播放的专辑</string>
+  <string id="518">运行</string>
+  <string id="519">运行方式</string>
+  <string id="520">编辑软件标题</string>
+  <string id="521">合辑</string>
+  <string id="522">移除源</string>
+  <string id="523">切换媒体</string>
+  <string id="524">选择播放列表</string>
+  <string id="525">新的播放列表...</string>
+  <string id="526">添加到播放列表</string>
+  <string id="527">手工添加到资料库</string>
+  <string id="528">输入标题</string>
+  <string id="529">错误：重复标题</string>
+  <string id="530">选择类型</string>
+  <string id="531">新的类型</string>
+  <string id="532">手工添加</string>
+  <string id="533">输入类型</string>
+  <string id="534">显示：%s</string>
+  <string id="535">列表</string>
+  <string id="536">图标</string>
+  <string id="537">大列表</string>
+  <string id="538">大图标</string>
+  <string id="539">宽幅</string>
+  <string id="540">大宽幅</string>
+  <string id="541">专辑图标</string>
+  <string id="542">DVD 图标</string>
+  <string id="543">DVD</string>
+  <string id="544">媒体信息</string>
+  <string id="545">音频输出设备</string>
+  <string id="546">直通输出设备</string>
+  <string id="547">此艺人没有传记</string>
+  <string id="548">多声道音频 Downmix 转换为立体声</string>
+
+  <string id="550">排序：%s</string>
+  <string id="551">名称</string>
+  <string id="552">日期</string>
+  <string id="553">大小</string>
+  <string id="554">音轨</string>
+  <string id="555">时长</string>
+  <string id="556">标题</string>
+  <string id="557">艺人</string>
+  <string id="558">专辑</string>
+  <string id="559">播放列表</string>
+  <string id="560">标签</string>
+  <string id="561">文件</string>
+  <string id="562">年份</string>
+  <string id="563">评价</string>
+  <string id="564">类型</string>
+  <string id="565">使用次数</string>
+  <string id="566">专辑艺人</string>
+  <string id="567">播放次数</string>
+  <string id="568">最后播放</string>
+  <string id="569">注释</string>
+  <string id="570">加入日期</string>
+  <string id="571">默认</string>
+  <string id="572">制作公司</string>
+  <string id="573">路径</string> 
+  
+  <string id="580">排序方向</string>
+  <string id="581">排序方法</string>
+  <string id="582">显示模式</string>
+  <string id="583">记住每个文件夹的显示模式</string>
+  <string id="584">升序</string>
+  <string id="585">降序</string>
+  <string id="586">编辑播放列表</string>
+  <string id="587">过滤</string>
+  <string id="588">取消舞会模式</string>
+  <string id="589">舞会模式</string>
+  <string id="590">随机</string>
+  <string id="591">关</string>
+  <string id="592">单首</string>
+  <string id="593">全部</string>
+  <string id="594">关</string>
+  <string id="595">重复：关闭</string>
+  <string id="596">重复：单首</string>
+  <string id="597">重复：所有</string>
+  
+  <string id="600">压缩音乐 CD</string>
+  <string id="601">中等</string>
+  <string id="602">标准</string>
+  <string id="603">极好</string>
+  <string id="604">固定码率</string>
+  <string id="605">压缩...</string>
+
+  <string id="607">储存到：</string>
+  <string id="608">不能压缩 CD 或音轨</string>
+  <string id="609">CD 压缩路径没有设置</string>
+  <string id="610">压缩音轨</string>
+  <string id="611">请输入序号</string>
+  
+  <string id="620">音乐 CD</string>
+  <string id="621">编码器</string>
+  <string id="622">质量</string>
+  <string id="623">码率</string>
+  <string id="624">包括音轨序号</string>
+  <string id="625">所有歌曲</string>
+  <string id="629">显示模式</string>
+  <string id="630">正常</string>
+  <string id="631">填满屏幕</string>
+  <string id="632">拉伸为 4:3</string>
+  <string id="633">拉伸为 14:9</string>
+  <string id="634">拉伸为 16:9</string>
+  <string id="635">视频原始像素比例</string>
+  <string id="636">自定义</string>
+  <string id="637">回放增益</string>
+  <string id="638">回放增益音量调整</string>
+  <string id="639">使用音轨增益等级</string>
+  <string id="640">使用专辑增益等级</string>
+  <string id="641">音量 - 重复播放的文件</string>
+  <string id="642">音量 - 不重复播放的文件</string>
+  <string id="643">播放增益时忽略消波失真</string>
+  <string id="644">裁剪黑边</string>
+  <string id="645">需要解压一个大文件，是否继续？</string>
+  <string id="646">从资料库中移除</string>
+  <string id="647">导出视频库</string>
+  <string id="648">导入视频库</string>
+  <string id="649">导入中</string>
+  <string id="650">导出中</string>
+  <string id="651">浏览资料库</string>
+  <string id="652">年份</string>
+  <string id="653">更新资料库</string>
+  <string id="654">显示调试信息</string>
+  <string id="655">浏览可执行文件</string>
+  <string id="656">浏览播放列表</string>
+  <string id="657">浏览文件夹</string>
+  <string id="658">歌曲信息</string>
+
+  <string id="660">音量放大</string>
+  <string id="661">选择导出文件夹</string>
+  <string id="662">此文件已不可用</string>
+  <string id="663">要从资料库移除吗？</string>
+  <string id="664">浏览脚本</string>
+
+  <string id="700">清理资料库</string>
+  <string id="701">清除资料库中的旧歌曲</string>
+  <string id="702">当前路径曾被扫瞄过</string>
+  <string id="705">网络</string>
+  <string id="706">- 服务器</string>
+
+  <string id="708">使用 HTTP 代理服务器访问互联网</string>
+
+  <string id="711">网络地址（IP）</string>
+  <string id="712">无效端口！必须在 1 至 65535 之间。</string>
+  <string id="713">HTTP 代理</string>
+
+  <string id="715">- 分配方式</string>
+  <string id="716">自动（动态分配）</string>
+  <string id="717">手动（静态分配）</string>
+  <string id="718">默认（Dashboard）</string>
+  <string id="719">- IP 地址</string>
+  <string id="720">- 子网掩码</string>
+  <string id="721">- 默认网关</string>
+  <string id="722">- DNS 服务器</string>
+  <string id="723">保存和重启</string>
+  <string id="724">无效地址！正确格式为：AAA.BBB.CCC.DDD</string>
+  <string id="725">从 0 到 255 之间的数字</string>
+  <string id="726">修改未保存，继续且不保存吗？</string>
+  <string id="727">Web 服务器</string>
+  <string id="728">FTP 服务器</string>
+  <string id="729"></string>
+  <string id="730">- 端口</string>
+  <string id="731"></string>
+  <string id="732">保存和应用</string>
+  <string id="733">- 密码</string>
+  <string id="734">无密码</string>
+  <string id="735">- 字符集</string>
+  <string id="736">- 字形</string>
+  <string id="737">- 颜色</string>
+  <string id="738">常规</string>
+  <string id="739">粗体</string>
+  <string id="740">斜体</string>
+  <string id="741">粗斜体</string>
+  <string id="742">白色</string>
+  <string id="743">黄色</string>
+  <string id="744">文件</string>
+  <string id="745">当前视图无信息</string>
+  <string id="746">请关闭资料库模式</string>
+  <string id="747">图像载入错误</string>
+  <string id="748">编辑路径</string>
+  <string id="749">镜像图像</string>
+  <string id="750">确定？</string>
+  <string id="751">移除共享</string>
+
+  <string id="754">新增程序连接</string>
+  <string id="755">编辑程序路径</string>
+  <string id="756">编辑程序名称</string>
+  <string id="757">编辑路径深度</string>
+
+  <string id="759">显示：大列表</string>
+  <string id="760">黄色</string>
+  <string id="761">白色</string>
+  <string id="762">蓝色</string>
+  <string id="763">亮绿</string>
+  <string id="764">翠绿</string>
+  <string id="765">青色</string>
+  <string id="766">浅灰</string>
+  <string id="767">灰色</string>
+  <!-- strings 768 and 769 reserved for more subtitle colors -->
+
+  <string id="770">错误 %i：不能共享</string>
+  <string id="771">- FTP 服务器限定工作在 FATX 格式</string>
+  <string id="772">音频输出</string>
+  <string id="773">搜索中</string>
+  <string id="774">幻灯图片目录</string>
+  <string id="775">网卡</string>
+  <string id="776">- 无线网络名（ESSID）</string>
+  <string id="777">- 无线网加密方式</string>
+  <string id="778">- 无线网安全</string>
+  <string id="779">保存和应用网卡设置</string>
+  <string id="780">不加密</string>
+  <string id="781">WEP</string>
+  <string id="782">WPA</string>
+  <string id="783">WPA2</string>
+  <string id="784">应用网卡设置，请稍等.</string>
+  <string id="785">网卡重启完成.</string>
+  <string id="786">网卡无法重启.</string>
+  <string id="787">网卡停用</string>
+  <string id="788">网卡停用完成.</string>
+  <string id="789">无线网络名（ESSID）</string>
+
+  <string id="791">允许本机程序控制 XBMC</string>
+  <string id="792">端口</string>
+  <string id="793">端口范围</string>
+  <string id="794">允许异地程序控制 XBMC</string>
+  <string id="795">初始重复等待时间（ms）</string>
+  <string id="796">持续等待时间（ms）</string>
+  <string id="797">最大客户端数</string>
+  <string id="798">互联网访问</string>
+
+  <string id="850">输入了无效端口</string>
+  <string id="851">有效端口范围是 1-65535</string>
+  <string id="852">有效端口范围是 1024-65535</string>
+
+  <string id="1000">屏幕保护预览</string>
+  <string id="1001">无法连接</string>
+  <string id="1002">XBMC 无法连接到该网上邻居！</string>
+  <string id="1003">这可能是由于网络没有连接。</string>
+  <string id="1004">可以用其他方式来添加它吗？</string>
+
+  <string id="1006">IP 地址</string>
+  <string id="1007">添加网上邻居</string>
+  <string id="1008">协议</string>
+  <string id="1009">服务器地址</string>
+  <string id="1010">服务器名称</string>
+  <string id="1011">远程路径</string>
+  <string id="1012">共享文件夹</string>
+  <string id="1013">端口</string>
+  <string id="1014">用户名</string>
+  <string id="1015">网络服务器</string>
+  <string id="1016">输入服务器网络地址</string>
+  <string id="1017">输入服务器远程路径</string>
+  <string id="1018">输入端口号</string>
+  <string id="1019">输入用户名</string>
+  <string id="1020">添加%s目录</string>
+  <string id="1021">输入或选择目录。</string>
+  <string id="1022">为该目录命名。</string>
+  <string id="1023">浏览目录</string>
+  <string id="1024">浏览</string>
+  <string id="1025">无法获得目录信息。</string>
+  <string id="1026">添加目录</string>
+  <string id="1027">编辑目录</string>
+  <string id="1028">编辑%s目录</string>
+  <string id="1029">输入新的标签</string>
+  <string id="1030">选择图像文件</string>
+  <string id="1031">选择图像目录</string>
+  <string id="1032">添加网上邻居...</string>
+  <string id="1033">浏览文件</string>
+  <string id="1034">子菜单</string>
+  <string id="1035">启用子菜单按钮</string>
+  <string id="1036">收藏夹</string>
+  <string id="1037">视频插件</string>
+  <string id="1038">音乐插件</string>
+  <string id="1039">图片插件</string>
+  <string id="1040">载入目录</string>
+  <string id="1041">检索%i项目</string>
+  <string id="1042">检索%i在%i项目</string>
+  <string id="1043">程序插件</string>
+  <string id="1044">设置插件缩略图</string>
+  <string id="1045">插件设置</string>
+  <string id="1046">接入点</string>
+  <string id="1047">其它...</string> 
+  <string id="1048">- 用户名</string>
+  <string id="1049">脚本设置</string>
+  <string id="1050">单曲</string>
+
+  <string id="1200">SMB 共享设置</string>
+  <string id="1202">工作组</string>
+  <string id="1203">默认账号</string>
+  <string id="1204">默认密码</string>
+
+  <string id="1207">WINS-服务器</string>
+  <string id="1208">安装 SMB 共享</string>
+
+  <string id="1210">移除</string>
+  <string id="1211">音乐</string>
+  <string id="1212">视频</string>
+  <string id="1213">图片</string>
+  <string id="1214">文件</string>
+  <string id="1215">音乐和视频 </string>
+  <string id="1216">音乐和图片</string>
+  <string id="1217">音乐和文件</string>
+  <string id="1218">视频和图片</string>
+  <string id="1219">视频和文件</string>
+  <string id="1220">图片和文件</string>
+  <string id="1221">音乐和视频和图片</string>
+  <string id="1222">音乐和视频和图片和文件</string>
+  <string id="1223">停用</string>
+  <string id="1226">文件和音乐和视频</string>
+  <string id="1227">文件和图片和音乐</string>
+  <string id="1228">文件和图片和视频</string>
+  <string id="1229">音乐和程序</string>
+  <string id="1230">视频和程序</string>
+  <string id="1231">图片和程序</string>
+  <string id="1232">音乐和视频和图片和程序</string>
+  <string id="1233">程序和视频和音乐</string>
+  <string id="1234">程序和图片和音乐</string>
+  <string id="1235">程序和图片和视频</string>
+
+  <string id="1245">FTP 账号</string>
+  <string id="1246">FTP 密码</string>
+  <string id="1247">用户密码设置成功！</string>
+
+  <string id="1250">自动检测</string>
+  <string id="1251">自动检测系统</string>
+  <string id="1252">昵称</string>
+
+  <string id="1254">确认连接</string>
+  <string id="1255">发送 FTP 用户名和密码</string>
+  <string id="1256">Ping 间隔</string>
+  <string id="1257">是否连接到自动发现的系统？</string>
+
+  <string id="1260">通过 Zeroconf 协议发布这些服务</string>
+
+  <string id="1300">自定义音频设备</string>
+  <string id="1301">自定义直通输出设备</string>
+
+  <string id="1396">漂流</string>
+  <string id="1397">和</string>
+  <string id="1398">结冰</string>
+  <string id="1399">晚间</string>
+  <string id="1400">局部</string>
+  <string id="1401">雷阵雨</string>
+  <string id="1402">雷</string>
+  <string id="1403">阴沉</string>
+  <string id="1404">暴</string>
+  <string id="1405">在</string>
+  <string id="1406">这</string>
+  <string id="1407">区域性</string>
+  <string id="1408">冰</string>
+  <string id="1409">清澈</string>
+  <string id="1410">无风</string>
+  <string id="1411">和</string>
+  <string id="1412">风</string>
+  <string id="1413">小雨</string>
+  <string id="1414">雷雨</string>
+  <string id="1415">毛毛雨</string>
+  <string id="1416">雾</string> 
+  <string id="1417">悬浮物</string>
+  <string id="1418">雷雨</string>
+  <string id="1419">雷阵雨</string>
+ 
+  <!-- strings through to 1450 reserved for weather translation -->
+
+  <string id="1450">空闲时显示器休眠</string>
+  <!-- strings through to 1470 reserved for power-saving -->
+
+  <string id="2050">影片长度</string>
+
+  <string id="2100">脚本错误！：%s</string>
+
+  <string id="4501">启用 LCD/VFD</string>
+
+  <string id="10000">首页</string>
+  <string id="10001">程序</string>
+  <string id="10002">图片</string>
+  <string id="10003">文件管理</string>
+  <string id="10004">系统设置</string>
+  <string id="10005">音乐</string>
+  <string id="10006">视频</string>
+  <string id="10007">系统信息</string>
+  <string id="10008">设置-&gt;常用</string>
+  <string id="10009">设置-&gt;屏幕</string>
+  <string id="10010">设置-&gt;用户界面-&gt;界面校准</string>
+  <string id="10011">设置-&gt;视频-&gt;屏幕校准</string>
+  <string id="10012">设置-&gt;图片</string>
+  <string id="10013">设置-&gt;程序</string>
+  <string id="10014">设置-&gt;天气</string>
+  <string id="10015">设置-&gt;音乐</string>
+  <string id="10016">设置-&gt;系统设置</string>
+  <string id="10017">设置-&gt;视频</string>
+  <string id="10018">设置-&gt;网络设置</string>
+  <string id="10019">设置-&gt;用户界面</string>
+  <string id="10020">脚本</string>
+
+  <string id="10028">视频/播放列表</string>
+  <string id="10034">设置-&gt;用户配置</string>
+
+  <string id="10100">"是/否"对话框</string>
+  <string id="10101">进度对话框</string>
+
+  <string id="10210">查找字幕...</string>
+  <string id="10211">缓存字幕...</string>
+  <string id="10212">结束</string>
+  <string id="10213">正在缓存中</string>
+  <string id="10214">打开流</string>
+
+  <string id="10500">音乐/播放列表</string>
+  <string id="10501">音乐/文件</string>
+  <string id="10502">音乐/资料库</string>
+  <string id="10503">播放列表编辑</string>
+  <string id="10504">歌曲100排行榜</string>
+  <string id="10505">专辑100排行榜</string>
+  <string id="10506">程序</string>
+  <string id="10507">系统设置</string>
+  <string id="10508">天气预报</string>
+  <string id="10509">网络游戏</string>
+  <string id="10510">功能扩展</string>
+  <string id="10511">系统信息</string>
+
+  <string id="10516">音乐 - 资料库</string>
+  <string id="10517">正在播放 - 音乐</string>
+
+  <string id="10522">正在播放 - 视频</string>
+  <string id="10523">专辑信息</string>
+  <string id="10524">视频信息</string>
+
+  <string id="12000">选择</string>
+  <string id="12001">音乐/信息</string>
+  <string id="12002">确认</string>
+  <string id="12003">视频/信息</string>
+  <string id="12004">脚本/信息</string>
+  <string id="12005">全屏视频</string>
+  <string id="12006">音频可视化效果</string>
+
+  <string id="12008">文件堆叠</string>
+  <string id="12009">重新生成索引...</string>
+  <string id="12010">返回到音乐窗口</string>
+  <string id="12011">返回到视频窗口</string>
+  <string id="12012">更新金手指列表</string>
+  <string id="12013">金手指</string>
+  <string id="12014">没有找到金手指</string>
+  <string id="12015">金手指设置</string>
+  <string id="12016">所有金手指信息丢失，请更新金手指列表！</string>
+  <string id="12017">从上次中断处继续播放</string>
+  <string id="12018">否</string>
+  <string id="12019">是</string>
+  <string id="12020">询问</string>
+  <string id="12021">从头开始播放</string>
+  <string id="12022">从 %s 处继续播放</string>
+  <string id="12023">正在验证金手指...</string>
+
+  <string id="12310">0</string>
+  <string id="12311">1</string>
+  <string id="12312">2</string>
+  <string id="12313">3</string>
+  <string id="12314">4</string>
+  <string id="12315">5</string>
+  <string id="12316">6</string>
+  <string id="12317">7</string>
+  <string id="12318">8</string>
+  <string id="12319">9</string>
+  <string id="12320">c</string>
+  <string id="12321">ok</string>
+  <string id="12322">*</string>
+  <string id="12325">已锁定！输入密码...</string>
+  <string id="12326">输入密码</string>
+  <string id="12327">输入管理员密码</string>
+  <string id="12328">输入解锁密码</string>
+  <string id="12329">或按 C 取消</string>
+  <string id="12330">输入 XBOX 手柄按键顺序，然后</string>
+  <string id="12331">按 Start 确认，或按 Back 取消</string>
+  <string id="12332">设置锁定</string>
+  <string id="12333">解除锁定</string>
+  <string id="12334">重新锁定</string>
+  <string id="12335">移除锁定</string>
+  <string id="12337">数字密码</string>
+  <string id="12338">手柄按键组合</string>
+  <string id="12339">全文字密码</string>
+  <string id="12340">输入新密码</string>
+  <string id="12341">确认新密码</string>
+  <string id="12342">密码不正确，</string>
+  <string id="12343">重试次数</string>
+  <string id="12344">输入密码不正确！</string>
+  <string id="12345">拒绝读取</string>
+  <string id="12346">已达密码重试次数限制！</string>
+  <string id="12347">系统将立刻关闭！</string>
+  <string id="12348">拒绝访问</string>
+  <string id="12353">重新上锁</string>
+  <string id="12356">更改锁定</string>
+  <string id="12357">共享锁定</string>
+  <string id="12358">密码不能为空，请重试！</string>
+  <string id="12360">主机锁定</string>
+  <string id="12362">超过重试次数就关机</string>
+  <string id="12367">管理员密码错误</string>
+  <string id="12368">请输入正确的管理员密码</string>
+  <string id="12373">系统设置和文件管理</string>
+  <string id="12376">作为所有视频的默认设置</string>
+  <string id="12377">将要初始化所有配置</string>
+  <string id="12378">每幅图片显示时间</string>
+  <string id="12379">使用移动和缩放特效</string>
+  <string id="12380">在 PAL 制式播放 NTSC 视频</string>
+  <string id="12381">在 NTSC 制式播放 PAL 视频</string>
+  <string id="12382">以 PAL60 制式播放 NTSC 视频</string>
+  <string id="12383">12小时制</string>
+  <string id="12384">24小时制</string>
+  <string id="12385">日/月</string>
+  <string id="12386">月/日</string>
+
+  <string id="12390">系统开机时间</string>
+  <string id="12391">分钟</string>
+  <string id="12392">小时</string>
+  <string id="12393">天</string>
+  <string id="12394">累计开机时间</string>
+
+  <string id="12600">天气</string>
+
+  <string id="12900">屏幕保护</string>
+  <string id="12901">全屏 OSD</string>
+
+  <string id="13000">系统设置</string>
+  <string id="13001">立即关闭硬盘</string>
+  <string id="13002">只有视频</string>
+  <string id="13003">- 延迟</string>
+  <string id="13004">- 最小影音文件时长</string>
+  <string id="13005">关机</string>
+  <string id="13006">Dashboard</string>
+  <string id="13007">使用自定义 Dashboard 路径</string>
+  <string id="13008">自动关机功能</string>
+  <string id="13009">退出</string>
+  <string id="13010">休眠</string>
+  <string id="13011">待机</string>
+  <string id="13012">退出</string>
+  <string id="13013">重启</string>
+  <string id="13014">最小化</string>
+  <string id="13015">电源按钮作用</string>
+
+  <string id="13020">是否有通过SSH连接的会话存在？</string>
+  <string id="13021">挂接移动存储器</string>
+  <string id="13022">不安全的移除设备</string>
+  <string id="13023">成功移除设备</string>
+  <string id="13024">游戏手柄插入</string>
+  <string id="13025">游戏手柄拔出</string>
+
+  <string id="13100">闪烁过滤</string>
+  <string id="13101">使用驱动选择（需要重启）</string>
+  <string id="13105">垂直空白同步</string>
+  <string id="13106">停用</string>
+  <string id="13107">只在视频播放时开启</string>
+  <string id="13108">总是开启</string>
+  <string id="13109">测试 &amp; 应用分辨率</string>
+  <string id="13110">保存此分辨率?</string>
+  <string id="13111">是否保存此分辨率?</string>
+
+  <string id="13112">高品质倍线</string>
+  <string id="13113">关闭</string>
+  <string id="13114">普通清晰度内容时打开</string>
+  <string id="13115">始终打开</string>
+
+  <string id="13116">倍线方式</string>
+  <string id="13117">Bicubic</string>
+  <string id="13118">Lanczos</string>
+  <string id="13119">Sinc</string>
+  <string id="13120">VDPAU</string>
+  <string id="13121">VDPAU 高品质倍线等级</string>
+  <string id="13122">VDPAU 演播室级色彩转换</string>
+
+  <string id="13130">其他显示器空白显示</string>
+  <string id="13131">禁止</string>
+  <string id="13132">空白显示</string>
+
+  <string id="13140">检测到活动连接！</string>
+  <string id="13141">如果你处理，你将不再能控制你的</string>
+  <string id="13142">XBMC，你是否确认要停止远程控制？</string>
+
+  <string id="13144">改变 Apple 遥控器的模式？</string>
+  <string id="13145">如果你现在正在使用 Apple 遥控器</string>
+  <string id="13146">控制 XBMC，修改这些设置将影响对</string>
+  <string id="13147">系统的控制。你确认要处理吗？</string>
+ 
+  <string id="13150">硬盘密匙：</string>
+  <string id="13151">硬盘温度：</string>
+  <string id="13152">DVD 型号：</string>
+  <string id="13153">DVD 固件版本：</string>
+  <string id="13154">硬盘型号：</string>
+  <string id="13155">硬盘序列号：</string>
+  <string id="13156">硬盘固件版本：</string>
+  <string id="13157">硬盘密码：</string>
+  <string id="13158">硬盘锁定状态：</string>
+  <string id="13159">子网掩码</string>
+  <string id="13160">网关地址</string>
+  <string id="13161">首选 DNS 服务器地址</string>
+  <string id="13162">初始化失败</string>
+
+  <string id="13163">游戏手柄</string>
+  <string id="13164">键盘</string>
+  <string id="13165">鼠标</string>
+  <string id="13166">耳麦</string>
+  <string id="13167">记忆卡</string>
+  <string id="13168">遥控器</string>
+  <string id="13169">控制器端口</string>
+
+  <string id="13170">从不</string>
+  <string id="13171">立即</string>
+  <string id="13172">隔%i秒以后</string>
+  <string id="13173">硬盘安装日期：</string>
+  <string id="13174">硬盘运转周期：</string>
+
+  <string id="13200">用户配置</string>
+  <string id="13201">删除用户配置'%s'？</string>
+  <string id="13204">最近载入的用户配置：</string>
+  <string id="13205">未知</string>
+  <string id="13206">覆盖</string>
+  <string id="13208">闹铃</string>
+  <string id="13209">闹铃间隔（分钟）</string>
+  <string id="13210">闹铃启动，倒计时%i分钟。</string>
+  <string id="13211">响铃！</string>
+  <string id="13212">闹铃取消，剩余%i分%i秒。</string>
+
+  <string id="13249">搜索 RAR 文件中的字幕</string>
+  <string id="13250">浏览字幕文件...</string>
+  <string id="13251">移动该项目</string>
+  <string id="13252">将项目移动至此</string>
+  <string id="13253">取消移动</string>
+
+  <string id="13270">硬件：</string>
+  <string id="13271">CPU 使用：</string>
+
+  <string id="13274">已经连接，但没有有效的 DNS！</string>
+  <string id="13275">硬盘</string>
+  <string id="13276">DVD-ROM</string>
+  <string id="13277">存储器</string>
+  <string id="13278">默认</string>
+  <string id="13279">网络</string>
+  <string id="13280">视频</string>
+  <string id="13281">硬件</string>
+
+  <string id="13283">操作系统：</string>
+  <string id="13284">CPU 速度：</string>
+  <string id="13285">BIOS 型号：</string>
+  <string id="13286">视频芯片：</string>
+  <string id="13287">屏幕分辨率：</string>
+  <string id="13288">Xbox 版本：</string>
+  <string id="13289">Xbox 序列号：</string>
+  <string id="13290">Xbox 生产商：</string>
+  <string id="13291">改机芯片：</string>
+  <string id="13292">A/V 线：</string>
+  <string id="13293">视频&amp;游戏区域：</string>
+  <string id="13294">DVD 区域：</string>
+  <string id="13295">互联网：</string>
+  <string id="13296">已经连接到互联网</string>
+  <string id="13297">无法联网，请检查网络设置！</string>
+  <string id="13298">XBLIVE 钥匙：</string>
+  <string id="13299">目标温度</string>
+  <string id="13300">风扇转速</string>
+  <string id="13301">自动控温</string>
+  <string id="13302">指定风扇转速</string>
+  <string id="13303">皮肤字体</string>
+  <string id="13304">开启转换双向字串</string>
+  <string id="13305">显示 RSS 新闻</string>
+  <string id="13306">显示上级目录图标</string>
+  <string id="13307">音轨命名参数</string>
+  <string id="13308">你想重新启动系统</string>
+  <string id="13309">以重新启动 XBMC 吗？</string>
+  <string id="13310">放缩效果</string>
+  <string id="13311">漂浮效果</string>
+  <string id="13312">缩小黑边</string>
+  <string id="13313">重启</string>
+  <string id="13314">歌曲淡入淡出</string>
+  <string id="13315">创建缩略图</string>
+  <string id="13316">循环缩略图</string>
+  <string id="13317">开始幻灯播放图片</string>
+  <string id="13318">循环幻灯播放图片</string>
+  <string id="13319">随机播放</string>
+  <string id="13320">立体声</string>
+  <string id="13321">左声道</string>
+  <string id="13322">右声道</string>
+  <string id="13323">开启卡拉OK支持</string>
+  <string id="13324">背景透明度</string>
+  <string id="13325">前景透明度</string>
+  <string id="13326">影音延迟</string>
+  <string id="13327">卡拉OK</string>
+  <string id="13328">%s未找到</string>
+  <string id="13329">打开%s时发生错误</string>
+  <string id="13330">无法载入%s</string>
+  <string id="13331">错误：内存不足</string>
+  <string id="13332">上移</string>
+  <string id="13333">下移</string>
+  <string id="13334">编辑标签</string>
+  <string id="13335">设为默认</string>
+  <string id="13336">移除按键</string>
+  <string id="13338">面板 LED</string>
+  <string id="13339">面板 LED 颜色</string>
+  <string id="13340">默认</string>
+  <string id="13341">绿色</string>
+  <string id="13342">橙色</string>
+  <string id="13343">红色</string>
+  <string id="13344">循环</string>
+  <string id="13345">当播放时关闭 LED</string>
+  <string id="13346">视频信息</string>
+  <string id="13347">加入播放列表</string>
+  <string id="13348">查询互联网电影数据库...</string>
+  <string id="13349">扫描新的内容</string>
+  <string id="13350">正在播放...</string>
+  <string id="13351">专辑信息</string>
+  <string id="13352">扫瞄项目到数据库</string>
+  <string id="13353">停止扫瞄</string>
+  <string id="13354">渲染方式</string>
+  <string id="13355">低品质像素着色器</string>
+  <string id="13356">硬件覆盖</string>
+  <string id="13357">高品质像素着色器</string>
+  <string id="13358">播放项目</string>
+  <string id="13359">设置艺人缩略图</string>
+  <string id="13360">自动获取缩略图</string>
+  <string id="13361">开启语音</string>
+  <string id="13375">启用装置</string>
+  <string id="13376">音量</string>
+  <string id="13377">默认显示方式</string>
+  <string id="13378">默认亮度数值</string>
+  <string id="13379">默认对比度数值</string>
+  <string id="13380">默认伽码数值</string>
+  <string id="13381">从上次中断处继续播放</string>
+  <string id="13382">语音特效 - 端口 1</string>
+  <string id="13383">语音特效 - 端口 2</string>
+  <string id="13384">语音特效 - 端口 3</string>
+  <string id="13385">语音特效 - 端口 4</string>
+  <string id="13386">使用时间搜寻</string>
+  <string id="13387">音轨命名模板</string>
+  <string id="13388">预设</string>
+  <string id="13389">该可视化效果没有预设</string>
+  <string id="13390">该可视化效果没有设置</string>
+  <string id="13391">弹出/载入</string>
+  <string id="13392">播放音乐时启用可视化效果</string>
+  <string id="13393">计算大小</string>
+  <string id="13394">计算文件夹大小</string>
+  <string id="13395">视频设置</string>
+  <string id="13396">声音和字幕设置</string>
+  <string id="13397">启用字幕</string>
+  <string id="13398">快捷方式</string>
+  <string id="13399">排序时忽略冠词（如 "the"）</string>
+  <string id="13400">同一专辑内歌曲淡入淡出</string>
+  <string id="13401">浏览%s</string>
+  <string id="13402">显示音轨位置</string>
+  <string id="13403">清除默认</string>
+  <string id="13404">继续播放</string>
+  <string id="13405">取得缩略图</string>
+  <string id="13406">图片信息</string>
+  <string id="13407">%s 预设</string>
+  <string id="13408">（IMDb 用户评价）</string>
+  <string id="13409">排行榜前 250：</string>
+  <string id="13410">收听 last.fm 电台</string>
+  <string id="13411">风扇最低转速</string>
+
+  <string id="13413">正在下载</string>
+  <string id="13414">包含只在合辑中出现的艺术家</string>
+  <string id="13415">渲染模式</string>
+  <string id="13416">自动检测</string>
+  <string id="13417">基本着色（ARB）</string>
+  <string id="13418">高级着色（GLSL）</string>
+  <string id="13419">软件着色</string>
+  <string id="13420">安全移除</string>
+  <string id="13421">VDPAU 硬解码</string>
+  <string id="13422">开始幻灯片播放</string>
+  <string id="13423">记住此目录</string>
+  <string id="13424">使用象素缓冲对象</string>
+  <string id="13425">Crystal HD 硬解码</string>
+
+  <string id="13500">影音同步方式</string>
+  <string id="13501">音频时钟</string>
+  <string id="13502">视频时钟（丢弃/重复音频）</string>
+  <string id="13503">视频时钟（重采样音频）</string>
+  <string id="13504">最高重采样率（%）</string>
+  <string id="13505">重采样质量</string>
+  <string id="13506">低（快）</string>
+  <string id="13507">中</string>
+  <string id="13508">高</string>
+  <string id="13509">极高（慢）</string>
+  <string id="13510">同步回放显示</string>
+
+  <string id="13600">Apple 遥控器</string>
+
+  <string id="13602">允许用遥控器启动 XBMC</string>
+  <string id="13603">序列延时</string>
+
+  <string id="13610">关闭</string>
+  <string id="13611">标准</string>
+  <string id="13612">通用遥控器</string>
+  <string id="13613">万能遥控器（Harmony）</string>
+
+  <string id="13620">Apple 遥控器错误</string>
+  <string id="13621">不能打开 Apple 遥控器支持.</string>
+
+  <string id="14000">视频堆叠</string>
+  <string id="14001">关闭堆叠</string>
+  <string id="14003">下载播放列表...</string>
+  <string id="14004">下载流媒体列表...</string>
+  <string id="14005">分析流媒体列表...</string>
+  <string id="14006">流媒体列表下载失败</string>
+  <string id="14007">播放列表下载失败</string>
+
+  <string id="14009">游戏目录</string>
+  <string id="14010">自动切换为图标显示条件</string>
+  <string id="14011">允许自动切换为图标显示</string>
+  <string id="14012">- 使用大图标</string>
+  <string id="14013">- 条件</string>
+  <string id="14014">- 百分比</string>
+  <string id="14015">没有文件且至少有一个图标</string>
+  <string id="14016">至少有一个文件和一个图标</string>
+  <string id="14017">图标所占百分比</string>
+  <string id="14018">浏览设置</string>
+  <string id="14019">改变地区码 1</string>
+  <string id="14020">改变地区码 2</string>
+  <string id="14021">改变地区码 3</string>
+  <string id="14022">资料库</string>
+  <string id="14023">无电视</string>
+  <string id="14024">输入最近的城市</string>
+  <string id="14025">视频/音频/DVD 缓存 - 硬盘</string>
+  <string id="14026">视频缓存 - DVD 驱动器</string>
+  <string id="14027">- 局域网</string>
+  <string id="14028">- 互联网</string>
+  <string id="14030">音频缓存 - DVD 驱动器</string>
+  <string id="14031">- 局域网</string>
+  <string id="14032">- 互联网</string>
+  <string id="14034">DVD 缓存 - DVD 驱动器</string>
+  <string id="14035">- 局域网</string>
+  <string id="14036">服务</string>
+
+  <string id="14038">网络设置已改变</string>
+  <string id="14039">XBMC 需要重启改变你的网络设置。</string>
+  <string id="14040">你想现在就重启吗？</string>
+  <string id="14041">后置处理</string>
+
+  <string id="14043">- 播放时关机</string>
+  <string id="14044">%i分</string>
+  <string id="14045">%i秒</string>
+  <string id="14046">%i毫秒</string>
+  <string id="14047">%i%%</string>
+  <string id="14048">%ikbps</string>
+  <string id="14049">%ikb</string>
+  <string id="14050">%i.0dB</string>
+  <string id="14051">时间显示格式</string>
+  <string id="14052">日期显示格式</string>
+  <string id="14053">图形界面滤镜</string>
+
+  <string id="14055">使用后台搜寻</string>
+  <string id="14056">停止搜寻</string>
+  <string id="14057">无法搜寻媒体信息</string>
+  <string id="14058">电影胶片效果</string>
+  <string id="14059">搜索远端共享的缩略图</string>
+  <string id="14060">未知类型文件缓冲 - 互联网</string>
+  <string id="14061">自动</string>
+  <string id="14062">输入用户名</string>
+  <string id="14063">日期和时间</string>
+  <string id="14064">设置日期</string>
+  <string id="14065">设置时间</string>
+  <string id="14066">输入24小时格式时间（时:分）</string>
+  <string id="14067">输入日期（日/月/年）</string>
+  <string id="14068">输入 IP 地址</string>
+  <string id="14069">确定要设置这些参数吗？</string>
+  <string id="14070">应用设置</string>
+  <string id="14071">允许重命名和删除文件</string>
+
+  <string id="14074">设置时区</string>
+  <string id="14075">使用夏令制时间</string>
+  <string id="14076">添加到收藏夹</string>
+  <string id="14077">从收藏夹移除</string>
+  <string id="14078">皮肤颜色</string>
+  <string id="14079">时区-国家</string>
+  <string id="14080">时区</string>
+  <string id="14081">文件列表</string>
+  <string id="14082">显示 EXIF 图片信息</string>
+  <string id="14083">使用全屏窗口而非真正全屏显示</string>
+  <string id="14084">选中歌曲加入播放列表</string>
+  <string id="14085">自动播放音乐 CD</string>
+  <string id="14086">播放</string>
+  <string id="14087">DVD</string>
+  <string id="14088">自动播放 DVD</string>
+  <string id="14089">文本字幕字体</string>
+  <string id="14090">界面语言</string>
+  <string id="14091">字符集</string>
+  <string id="14092">调试</string>
+  <string id="14093">安全</string>
+  <string id="14094">输入设备</string>
+  <string id="14095">省电模式</string>
+
+  <string id="15015">删除</string>
+  <string id="15016">游戏</string>
+
+  <string id="15019">添加</string>
+
+  <string id="15052">密码</string>
+
+  <string id="15100">资料库</string>
+  <string id="15101">数据库</string>
+  <string id="15102">* 所有专辑</string>
+  <string id="15103">* 所有艺人</string>
+  <string id="15104">* 所有歌曲</string>
+  <string id="15105">* 所有类型</string>
+
+  <string id="15107">缓冲中...</string>
+  <string id="15108">导航音效</string>
+  <string id="15109">皮肤预设</string>
+  <string id="15111">皮肤主题</string>
+  <string id="15112">缺省主题</string>
+
+  <string id="15200">Last.fm</string>
+  <string id="15201">将歌曲提交到 Last.fm</string>
+  <string id="15202">Last.fm 用户名</string>
+  <string id="15203">Last.fm 密码</string>
+  <string id="15204">无法连接：休眠中...</string>
+  <string id="15205">请升级 XBMC</string>
+  <string id="15206">无法通过认证：检查帐号和密码</string>
+  <string id="15207">连接</string>
+  <string id="15208">无法连接</string>
+  <string id="15209">上传进度%i</string>
+  <string id="15210">已缓存%i首歌曲</string>
+  <string id="15211">上传中...</string>
+  <string id="15212">上传剩余%i秒</string>
+  <string id="15213">打开方式...</string>
+  <string id="15214">使用平滑的影音同步</string>
+  <string id="15215">缩略图显示时隐藏文件名</string>
+  <string id="15216">通过合作模式玩</string>
+  <string id="15217">将歌曲提交到 Libre.fm</string>
+  <string id="15218">Libre.fm 用户名</string>
+  <string id="15219">Libre.fm 密码</string>
+  <string id="15220">Libre.fm</string>
+  <string id="15221">歌曲提交</string>
+
+  <string id="15250">将 Last.fm 节目提交到 Last.fm</string>
+  <string id="15251">连接到 Last.fm...</string>
+  <string id="15252">选择电台...</string>
+  <string id="15253">寻找相似的艺人...</string>
+  <string id="15254">寻找相似的标记...</string>
+  <string id="15255">你的用户配置（%name%）</string>
+  <string id="15256">所有排行</string>
+  <string id="15257">%name% 艺人排行</string>
+  <string id="15258">%name% 专辑排行</string>
+  <string id="15259">%name% 歌曲排行</string>
+  <string id="15260">收听 %name% Last.fm</string>
+  <string id="15261">%name% 同类型艺人</string>
+  <string id="15262">%name% 专辑排行</string>
+  <string id="15263">%name% 歌曲排行</string>
+  <string id="15264">%name% 标签排行</string>
+  <string id="15265">%name% 最爱歌迷</string>
+  <string id="15266">收听 %name% 在 Last.fm 的歌迷</string>
+  <string id="15267">收听 %name% 在 Last.fm 的同类型艺人</string>
+  <string id="15268">%name% 艺人排行</string>
+  <string id="15269">%name% 专辑排行</string>
+  <string id="15270">%name% 歌曲排行</string>
+  <string id="15271">%name% 好友</string>
+  <string id="15272">%name% 同好</string>
+  <string id="15273">%name% 艺人周排行</string>
+  <string id="15274">%name% 专辑周排行</string>
+  <string id="15275">%name% 歌曲周排行</string>
+  <string id="15276">收听 %name% 在 Last.fm 的同好</string>
+  <string id="15277">收听 %name% 的个人 Last.fm</string>
+  <string id="15278">收听 %name% 在 Last.fm 的最爱</string>
+  <string id="15279">正在从 Last.fm 获取列表</string>
+  <string id="15280">不能从 Last.fm 获取列表...</string>
+  <string id="15281">输入艺人名来寻找相关资料</string>
+  <string id="15282">输入标签名来寻找相关资料</string>
+  <string id="15283">%name% 最近听过的歌曲</string>
+  <string id="15284">收听 %name% 在 Last.fm 的推荐</string>
+  <string id="15285">%name% 的排行</string>
+  <string id="15286">收听 %name% 在 Last.fm 的播放列表</string>
+  <string id="15287">你想把目前歌曲加入你的最爱吗？</string>
+  <string id="15288">你想封锁目前的歌曲吗？</string>
+  <string id="15289">加入你的最爱歌曲：'%s'</string>
+  <string id="15290">不能加入 '%s' 到你的最爱</string>
+  <string id="15291">已被封禁：'%s'.</string>
+  <string id="15292">不能封禁 '%s'.</string>
+  <string id="15293">%name% 最近喜好的歌曲</string>
+  <string id="15294">%name% 最近封锁的歌曲</string>
+  <string id="15295">从最爱中移除</string>
+  <string id="15296">解除封锁</string>
+  <string id="15297">您想从你的最爱移除这首歌曲吗？</string>
+  <string id="15298">你想解除封锁这首歌曲吗？</string>
+
+  <string id="15300">路径错误或无法找到！</string>
+  <string id="15301">无法连接服务器！</string>
+  <string id="15302">没有找到服务器！</string>
+  <string id="15303">没有找到工作组！</string>
+
+  <string id="15310">打开多个源路径</string>
+  <string id="15311">路径：</string>
+
+  <string id="16000">常用</string>
+
+  <string id="16002">互联网查询</string>
+  <string id="16003">高级设置</string>
+  <string id="16004">播放碟片</string>
+
+  <string id="16008">输入新标题</string>
+  <string id="16009">输入视频名称</string>
+  <string id="16010">输入配置名称</string>
+  <string id="16011">输入专辑名称</string>
+  <string id="16012">输入播放列表名称</string>
+  <string id="16013">输入新的文件名</string>
+  <string id="16014">输入文件夹名称</string>
+  <string id="16015">输入目录</string>
+  <string id="16016">可使用选项：%A, %T, %N, %B, %D, %G, %Y, %F, %S</string>
+  <string id="16017">输入查询字符串</string>
+  <string id="16018">关闭</string>
+  <string id="16019">自动选择</string>
+  <string id="16020">去交错</string>
+  <string id="16021">抖动</string>
+  <string id="16022">抖动（倒转）</string>
+  <string id="16023">交错设置</string>
+  <string id="16024">取消中...</string>
+  <string id="16025">输入艺人名字</string>
+  <string id="16026">播放失败</string>
+  <string id="16027">一个或多个项目播放失败！</string>
+  <string id="16028">输入数据</string>
+  <string id="16029">详情请查看日志文件。</string>
+  <string id="16030">取消舞会模式！</string>
+  <string id="16031">资料库中没有符合条件的歌曲！</string>
+  <string id="16032">无法初始化资料库！</string>
+  <string id="16033">无法打开资料库！</string>
+  <string id="16034">无法从资料库获取歌曲文件！</string>
+  <string id="16035">舞会模式播放列表</string>
+ 
+  <string id="16100">所有视频文件</string>
+  <string id="16101">未观看的</string>
+  <string id="16102">已观看的</string>
+  <string id="16103">标记为已观看</string>
+  <string id="16104">标记为未观看</string>
+  <string id="16105">编辑标题</string>
+  <string id="16106">使用 NTSC-M 和 NTSC-J 制式</string>
+  <string id="16107">只使用 NTSC-M 制式</string>
+  <string id="16108">只使用 NTSC-J 制式</string>
+  <string id="16109">只使用 PAL-60 制式</string>
+  <string id="16110">60hz 游戏设置</string>
+
+  <string id="16200">操作被中断</string>
+  <string id="16201">复制文件失败</string>
+  <string id="16202">部分文件复制失败</string>
+  <string id="16203">移动文件失败</string>
+  <string id="16204">部分文件移动失败</string>
+  <string id="16205">删除文件失败</string>
+  <string id="16206">部分文件删除失败</string>
+
+  <string id="16300">视频扫描方式</string>
+  <string id="16301">最近邻</string>
+  <string id="16302">双线性</string>
+  <string id="16303">双三次</string>
+  <string id="16304">Lanczos2</string>
+  <string id="16305">Lanczos3</string>
+  <string id="16306">正弦8</string>
+  <string id="16307">双三次（软件）</string>
+  <string id="16308">Lanczos（软件）</string>
+  <string id="16309">正弦（软件）</string>
+  <string id="16310">时间平滑</string>
+  <string id="16311">时间/空间平滑</string>
+  <string id="16312">（VDPAU）降噪</string>
+  <string id="16313">（VDPAU）锐化</string>
+  <string id="16314">帧率逆转换</string>
+  <string id="16315">Lanczos3优化</string>
+  <string id="16316">自动</string>
+  <string id="16317">时间平滑（半速）</string>
+  <string id="16318">时间/空间平滑（半速）</string>
+
+  <string id="17500">显示睡眠时间</string>
+
+  <string id="19000">切换到频道</string>
+
+  <string id="20000">音乐保存目录</string>
+  <string id="20001">使用外部 DVD 播放程序</string>
+  <string id="20002">外部 DVD 播放程序</string>
+  <string id="20003">金手指目录</string>
+  <string id="20004">屏幕抓图目录</string>
+
+  <string id="20006">播放列表目录</string>
+  <string id="20007">录音</string>
+  <string id="20008">屏幕抓图</string>
+  <string id="20009">使用 XBMC</string>
+
+  <string id="20011">音乐播放列表</string>
+  <string id="20012">视频播放列表</string>
+  <string id="20013">你要执行该游戏？</string>
+  <string id="20014">排序：播放列表</string>
+  <string id="20015">远程缩略图</string>
+  <string id="20016">当前缩略图</string>
+  <string id="20017">本地缩略图</string>
+  <string id="20018">无缩略图</string>
+  <string id="20019">选择缩略图</string>
+
+  <!-- string id 20022 will always be set to an empty string (LocalizeStrings.cpp)-->
+  <string id="20022"></string>
+  <string id="20023">冲突</string>
+  <string id="20024">扫描新的</string>
+  <string id="20025">扫描全部</string>
+  <string id="20026">区域</string>
+
+  <!-- string id's 20027 thru 20034 are reserved for temperature strings (LocalizeStrings.cpp)-->
+
+  <string id="20037">摘要</string>
+  <string id="20038">锁定音乐部分</string>
+  <string id="20039">锁定视频部分</string>
+  <string id="20040">锁定图片部分</string>
+  <string id="20041">锁定程序与脚本部分</string>
+  <string id="20042">锁定文件管理</string>
+  <string id="20043">锁定系统设置</string>
+  <string id="20044">重新设置</string>
+  <string id="20045">进入管理员模式</string>
+  <string id="20046">离开管理员模式</string>
+  <string id="20047">创建用户配置'%s'？</string>
+  <string id="20048">应用新的设置开始</string>
+  <string id="20049">最适合模式</string>
+  <string id="20050">自动切换 16x9 与 4x3 模式</string>
+  <string id="20051">视堆叠文件为单一文件</string>
+  <string id="20052">注意</string>
+  <string id="20053">已离开管理员模式</string>
+  <string id="20054">已进入管理员模式</string>
+  <string id="20055">Allmusic.com 缩略图</string>
+
+  <string id="20057">移除缩略图</string>
+  <string id="20058">新加入用户配置...</string>
+  <string id="20059">下载所有专辑的讯息</string>
+  <string id="20060">媒体讯息</string>
+  <string id="20061">分离的</string>
+  <string id="20062">共用预设值</string>
+  <string id="20063">共用预设值（只读）</string>
+  <string id="20064">复制预设值</string>
+  <string id="20065">用户配置图片</string>
+  <string id="20066">锁定偏好设置</string>
+  <string id="20067">编辑用户配置</string>
+  <string id="20068">锁定用户配置</string>
+  <string id="20069">无法建立目录</string>
+  <string id="20070">用户配置目录</string>
+  <string id="20071">启动时刷新媒体来源</string>
+  <string id="20072">请确定选择的目录是可写入的</string>
+  <string id="20073">且是有效的目录名称</string>
+  <string id="20074">MPAA评分</string>
+  <string id="20075">输入管理员密码</string>
+  <string id="20076">在开机时询问管理员密码</string>
+  <string id="20077">桌面设置</string>
+  <string id="20078">- 无连结设置 -</string>
+  <string id="20079">启用桌面动画效果</string>
+  <string id="20080">播放音乐时关闭 RSS</string>
+  <string id="20081">启用快捷方式</string>
+  <string id="20082">在主界面中显示程序菜单</string>
+  <string id="20083">显示音乐讯息</string>
+  <string id="20084">显示天气预报</string>
+  <string id="20085">显示系统信息</string>
+  <string id="20086">显示可用的磁盘空间 C: E: F:</string>
+  <string id="20087">显示可用的磁盘空间 E: F: G:</string>
+  <string id="20088">天气预报</string>
+  <string id="20089">可用的磁盘空间</string>
+  <string id="20090">输入一个已有的共享名称</string>
+  <string id="20091">密码</string>
+  <string id="20092">载入用户配置</string>
+  <string id="20093">用户配置名称</string>
+  <string id="20094">媒体来源</string>
+  <string id="20095">用户配置密码</string>
+  <string id="20096">登录窗口</string>
+  <string id="20097">抓取专辑讯息</string>
+  <string id="20098">正在取得专辑讯息</string>
+  <string id="20099">当 CD 播放时不能抓取该 CD</string>
+  <string id="20100">管理员密码与设置</string>
+  <string id="20101">输入管理员密码后，始终启用管理员模式</string>
+  <string id="20102">或是从预设值中复制？</string>
+  <string id="20103">保存变更到用户配置文件？</string>
+  <string id="20104">发现旧设置值</string>
+  <string id="20105">你要使用吗？</string>
+  <string id="20106">发现旧媒体来源</string>
+  <string id="20107">分离的（锁定）</string>
+  <string id="20108">根目录</string>
+  <string id="20109">皮肤缩放</string>
+  <string id="20110">UPnP 客户端</string>
+  <string id="20111">自动启动 UPnP 客户端</string>
+  <string id="20112">上次登录：%s</string>
+  <string id="20113">从未登录</string>
+  <string id="20114">用户配置%i / %i</string>
+  <string id="20115">用户登录/选择用户配置</string>
+  <string id="20116">在登录窗口中使用锁定</string>
+  <string id="20117">密码无效</string>
+  <string id="20118">需先设置管理员锁定</string>
+  <string id="20119">你现在要设置吗？</string>
+  <string id="20120">载入程序讯息</string>
+  <string id="20121">启动舞会模式！</string>
+  <string id="20122">真实</string>
+  <string id="20123">混合饮料</string>
+  <string id="20124">填入玻璃</string>
+  <string id="20125">登录</string>
+  <string id="20126">注销</string>
+  <string id="20128">转到根目录</string>
+  <string id="20129">交织</string>
+  <string id="20130">交织（倒转）</string>
+  <string id="20131">混合</string>
+  <string id="20132">从头播放视频</string>
+  <string id="20133">编辑网络位置</string>
+  <string id="20134">移除网络位置</string>
+  <string id="20135">你想扫描这个目录吗？</string>
+  <string id="20136">记忆卡</string>
+  <string id="20137">记忆卡已插入</string>
+  <string id="20138">找不到记忆卡</string>
+  <string id="20139">在%i端口，第%i槽</string>
+  <string id="20140">锁定屏幕保护</string>
+  <string id="20141">设置</string>
+  <string id="20142">用户名</string>
+  <string id="20143">键入密码</string>
+  <string id="20144">自动关机定时器</string>
+  <string id="20145">自动关机定时（分钟）</string>
+  <string id="20146">启动自动关机在%i分钟后</string>
+  <string id="20147">30分钟后自动关机</string>
+  <string id="20148">60分钟后自动关机</string>
+  <string id="20149">120分钟后自动关机</string>
+  <string id="20150">自定义自动关机时间</string>
+  <string id="20151">取消自动关机</string>
+  <string id="20152">锁定设置文件%s</string>
+  <string id="20153">浏览...</string>
+  <string id="20154">系统摘要信息</string>
+  <string id="20155">存储设备信息</string>
+  <string id="20156">硬盘驱动器信息</string>
+  <string id="20157">光盘驱动器信息</string>
+  <string id="20158">网络设备信息</string>
+  <string id="20159">视频设备信息</string>
+  <string id="20160">硬件设备信息</string>
+  <string id="20161">总计</string>
+  <string id="20162">已使用</string>
+  <string id="20163">中</string>
+  <string id="20164">不支持锁定</string>
+  <string id="20165">没有上锁</string>
+  <string id="20166">已经上锁</string>
+  <string id="20167">已冻结</string>
+  <string id="20168">需要重新启动</string>
+  <string id="20169">周</string>
+  <string id="20170">生产线</string>
+  <string id="20171">Windows 网络（SMB）</string>
+  <string id="20172">XBMSP 服务器</string>
+  <string id="20173">FTP 服务器</string>
+  <string id="20174">ITunes 音乐共享（DAAP）</string>
+  <string id="20175">UPnP 媒体服务器</string>
+  <string id="20176">显示视频信息</string>
+  <string id="20177">完成</string>
+  <string id="20178">上档</string>
+  <string id="20179">大写</string>
+  <string id="20180">符号</string>
+  <string id="20181">退格</string>
+  <string id="20182">空格</string>
+  <string id="20183">重载桌面皮肤</string>
+  <string id="20184">根据 EXIF 信息旋转图片</string>
+  <string id="20185">使用海报模式显示剧集</string>
+  <string id="20186">请稍候...</string>
+  <string id="20187">备份 EEPROM</string>
+  <string id="20188">备份 BIOS</string>
+  <string id="20189">启用剧情和评论自动滚动</string>
+  <string id="20190">自定义</string>
+  <string id="20191">显示除错信息</string>
+  <string id="20192">资料库更新时下载附加信息</string>
+
+  <string id="20194">默认音乐信息服务</string>
+  <string id="20195">改变刮削器</string>
+  <string id="20196">导出音乐资料库</string>
+  <string id="20197">导入音乐资料库</string>
+  <string id="20198">未找到艺人!</string>
+  <string id="20199">下载艺人信息失败</string>
+
+  <!-- string id's 20200 thru 20211 are reserved for speedstrings (LocalizeStrings.cpp)-->
+
+  <string id="20250">舞会模式！（视频）</string>
+  <string id="20251">鸡尾酒（视频）</string>
+  <string id="20252">填入玻璃（视频）</string>
+  <string id="20253">WebDAV服务器（HTTP）</string>
+  <string id="20254">WebDAV服务器（HTTPS）</string>
+
+  <string id="20300">WEB服务器目录（HTTP）</string>
+  <string id="20301">WEB服务器目录（HTTPS）</string>
+  <string id="20302">无法写入文件夹：</string>
+  <string id="20303">你要跳过并继续吗？</string>
+  <string id="20304">RSS 信源</string>
+
+  <string id="20306">未知 BIOS，请把 xbmc.log 中 MD5 部分加到 BiosIDs.ini</string>
+  <string id="20307">备用 DNS 服务器地址</string>
+  <string id="20308">DHCP 服务器：</string>
+  <string id="20309">新建文件夹</string>
+  <string id="20310">播放时关闭 LCD 背光</string>
+  <string id="20311">未知或板载（保护状态）</string>
+  <string id="20312">暂停时关闭 LCD 背光</string>
+  <string id="20313">暂停时打开 LED</string>
+  <string id="20314">视频 - 资料库</string>
+  <string id="20315">游戏存档</string>
+  <string id="20316">排序：标签</string>
+  <string id="20317">下载存档</string>
+  <string id="20318">把游戏存档存放在硬盘上</string>
+  <string id="20319">下载游戏存档失败！</string>
+  <string id="20320">选择需要下载和安装的游戏存档</string>
+  <string id="20321">没有当前游戏所对应的存档文件</string>
+  <string id="20322">切换到游戏存档</string>
+  <string id="20323">游戏存档</string>
+  <string id="20324">分段播放...</string>
+  <string id="20325">重新校准</string>
+  <string id="20326">这个操作会重新校准%s的配置</string>
+  <string id="20327">还原为初时配置</string>
+  <string id="20328">选择指定位置</string>
+
+  <string id="20330">以文件夹名来查找</string>
+  <string id="20331">文件</string>
+  <string id="20332">用文件夹名或文件名进行查找？</string>
+  <string id="20333">设置内容</string>
+  <string id="20334">文件夹</string>
+  <string id="20335">是否嵌套查找？</string>
+  <string id="20336">取消源锁定</string>
+  <string id="20337">演员</string>
+  <string id="20338">影片</string>
+  <string id="20339">导演</string>
+  <string id="20340">是否从XBMC资料库中移除</string>
+  <string id="20341">所有位于该路径的项目？</string>
+  <string id="20342">电影</string>
+  <string id="20343">剧集</string>
+  <string id="20344">该目录包含</string>
+  <string id="20345">运行自动扫描</string>
+  <string id="20346">嵌套查找</string>
+  <string id="20347">饰演</string>
+  <string id="20348">导演</string>
+  <string id="20349">该目录下无视频文件！</string>
+  <string id="20350">票数</string>
+  <string id="20351">剧集信息</string>
+  <string id="20352">分集信息</string>
+  <string id="20353">下载剧集详细介绍</string>
+  <string id="20354">取得分集介绍</string>
+  <string id="20355">下载分集信息到资料库</string>
+  <string id="20356">选择剧集：</string>
+  <string id="20357">输入剧集名</string>
+  <string id="20358">第%i季</string>
+  <string id="20359">集</string>
+  <string id="20360">分集</string>
+  <string id="20361">下载分集详细介绍</string>
+  <string id="20362">从资料库移除分集</string>
+  <string id="20363">从资料库移除剧集</string>
+  <string id="20364">剧集</string>
+  <string id="20365">剧情</string>
+  <string id="20366">* 整季</string>
+  <string id="20367">隐藏已观看的</string>
+  <string id="20368">序列号</string>
+  <string id="20369">显示未观看影片的剧情介绍</string>
+  <string id="20370">* 未观看之前隐藏 *</string>
+  <string id="20371">设置季缩略图</string>
+  <string id="20372">季图片</string>
+  <string id="20373">季</string>
+  <string id="20374">下载影片信息</string>
+  <string id="20375">不指定内容</string>
+
+  <string id="20377">刷新剧集信息</string>
+  <string id="20378">刷新所有分集信息？</string>
+  <string id="20379">被选文件夹包含单个电视剧集</string>
+  <string id="20380">扫描时排除文件夹</string>
+  <string id="20381">特别</string>
+  <string id="20382">自动获取季缩略图</string>
+  <string id="20383">被选文件夹包含单个视频</string>
+  <string id="20384">链接到电视剧集</string>
+  <string id="20385">移除到电视剧集的链接</string>
+  <string id="20386">最近加入的影片</string>
+  <string id="20387">最近加入的剧集</string>
+  <string id="20388">制作公司</string>
+  <string id="20389">音乐电视</string>
+  <string id="20390">最近加入的音乐电视</string>
+  <string id="20391">音乐电视</string>
+  <string id="20392">从资料库移除音乐电视</string>
+  <string id="20393">音乐电视信息</string>
+  <string id="20394">载入音乐电视信息</string>
+  <string id="20395">混合</string>
+  <string id="20396">按艺人进入专辑</string>
+  <string id="20397">进入专辑</string>
+  <string id="20398">播放歌曲</string>
+  <string id="20399">从专辑进入音乐电视</string>
+  <string id="20400">按艺人进入音乐电视</string>
+  <string id="20401">播放音乐电视</string>
+  <string id="20402">加入资料库时下载演员缩略图</string>
+  <string id="20403">设置演员缩略图</string>
+
+  <string id="20405">移除分集书签</string>
+  <string id="20406">设置分集书签</string>
+  <string id="20407">刮削器设置</string>
+  <string id="20408">下载音乐电视信息</string>
+  <string id="20409">下载剧集信息</string>
+  <string id="20410">预告片</string>
+  <string id="20411">简捷查看</string>
+  <string id="20412">简捷查看剧集</string>
+  <string id="20413">获取同人画</string>
+  <string id="20414">在影音库和中显示同人画</string>
+  <string id="20415">扫描新内容</string>
+  <string id="20416">最初发表</string>
+  <string id="20417">编剧</string>
+  <string id="20418">自动显示整齐的文件和目录名</string>
+
+  <string id="20420">从不</string>
+  <string id="20421">如果只有一季</string>
+  <string id="20422">总是</string>
+  <string id="20423">有预告片</string>
+  <string id="20424">假</string>
+  <string id="20425">幻灯播放同人画</string>
+  <string id="20426">导出到单个文件或多个文件</string>
+  <string id="20427">每个文件项目数？</string>
+  <string id="20428">单个文件</string>
+  <string id="20429">多文件</string>
+  <string id="20430">导出缩略图和同人画？</string>
+  <string id="20431">覆盖原文件？</string>
+  <string id="20432">资料库更新时排除的路径</string>
+  <string id="20433">提取缩略图和媒体标识</string>
+  <string id="20434">影片集</string>
+  <string id="20435">设置影片集缩略图</string>
+  <string id="20436">导出演员缩略图</string>
+  <string id="20437">选择同人画</string>
+  <string id="20438">本地同人画</string>
+  <string id="20439">无同人画</string>
+  <string id="20440">当前同人画</string>
+  <string id="20441">远程同人画</string>
+  <string id="20442">更新内容</string>
+  <string id="20443">要刷新此目录下的</string>
+  <string id="20444">所有项目吗？</string>
+  <string id="20445">同人画</string>
+  <string id="20446">发现本地存储的信息。</string>
+  <string id="20447">忽略并从互联网刷新吗？</string>
+  <string id="20448">无法下载信息</string>
+  <string id="20449">服务器不可用。</string>
+  <string id="20450">要继续扫描吗？</string>
+  <!-- up to 21329 is reserved for the video db !! !-->
+
+  <string id="21330">显示隐藏文件和目录</string>
+
+  <string id="21331">TuxBox 客户端</string>
+  <string id="21332">警告：目标 TuxBox 设备正处于录制模式！</string>
+  <string id="21333">流媒体将会被停止！</string>
+  <string id="21334">切换频道：%s 失败！</string>
+  <string id="21335">确认是否开始流媒体传输？</string>
+  <string id="21336">正在连接：%s</string>
+  <string id="21337">TuxBox 设备</string>
+  <!-- up to 21355 is reserved for the TuxBox Client!! !-->
+
+  <string id="21359">添加共享媒体...</string>
+  <string id="21360">通过 UPnP 共享视频和音乐库</string>
+
+  <string id="21364">编辑媒体共享</string>
+  <string id="21365">移除媒体共享</string>
+  <string id="21366">字幕目录</string>
+  <string id="21367">视频和相关字幕目录</string>
+
+  <string id="21369">使用鼠标</string>
+  <string id="21370">在播放媒体文件时播放导航声效</string>
+  <string id="21371">缩略图</string>
+  <string id="21372">强制 DVD 播放器区码</string>
+  <string id="21373">视频输出</string>
+  <string id="21374">视频模式</string>
+  <string id="21375">一般</string>
+  <string id="21376">信箱模式</string>
+  <string id="21377">宽屏幕</string>
+  <string id="21378">开启 480p</string>
+  <string id="21379">开启 720p</string>
+  <string id="21380">开启 1080i</string>
+  <string id="21381">输入新播放列表的名称</string>
+  <string id="21382">在文件列表中显示“添加目录”按钮</string>
+  <string id="21383">启用滚动条</string>
+  <string id="21384">视频资料库使用浏览过滤按钮</string>
+  <string id="21385">打开</string>
+  <string id="21386">噪音管理</string>
+  <string id="21387">快速</string>
+  <string id="21388">安静</string>
+  <string id="21389">启用自定义背景</string>
+  <string id="21390">电源管理</string>
+  <string id="21391">高功率</string>
+  <string id="21392">低功率</string>
+  <string id="21393">高待机</string>
+  <string id="21394">低待机</string>
+  <string id="21395">缓存档不能超过4GB</string>
+  <string id="21396">章</string>
+  <string id="21397">高品质像素着色器 V2</string>
+  <string id="21398">启用启动时自动播放播放列表</string>
+  <string id="21399">使用 Tween 动画效果</string>
+  <string id="21400">包含</string>
+  <string id="21401">未包含</string>
+  <string id="21402">是</string>
+  <string id="21403">不是</string>
+  <string id="21404">开始于</string>
+  <string id="21405">中止于</string>
+  <string id="21406">大于</string>
+  <string id="21407">小于</string>
+  <string id="21408">之后</string>
+  <string id="21409">之前</string>
+  <string id="21410">最后</string>
+  <string id="21411">非最后</string>
+  <string id="21412">刮削器</string>
+  <string id="21413">默认电影刮削器</string>
+  <string id="21414">默认剧集刮削器</string>
+  <string id="21415">默认音乐电视刮削器</string>
+  <string id="21416">启用基于刮削器语言的回送</string>
+  <string id="21417">- 设置</string>
+  <string id="21418">多语言</string>
+
+  <string id="21420">等于</string>
+  <string id="21421">智能播放列表规则</string>
+  <string id="21422">符合条件的歌曲在</string>
+  <string id="21423">新规则...</string>
+  <string id="21424">歌曲必须满足</string>
+  <string id="21425">所有条件</string>
+  <string id="21426">一条或多条规则</string>
+  <string id="21427">限制</string>
+  <string id="21428">无限制</string>
+  <string id="21429">排序</string>
+  <string id="21430">升序</string>
+  <string id="21431">降序</string>
+  <string id="21432">编辑智能播放列表</string>
+  <string id="21433">播放列表名称</string>
+  <string id="21434">查找满足条件的歌曲</string>
+  <string id="21435">- 编辑</string>
+  <string id="21436">%i首歌曲</string>
+  <string id="21437">新的智能播放列表...</string>
+  <string id="21438">%c磁盘</string>
+  <string id="21439">编辑舞会模式规则</string>
+  <string id="21440">Home文件夹</string>
+  <string id="21441">观看次数</string>
+  <string id="21442">插曲标题</string>
+  <string id="21443">视频分辨率</string>
+  <string id="21444">音频声道数</string>
+  <string id="21445">视频编码</string>
+  <string id="21446">音频编码</string>
+  <string id="21447">对白语言</string>
+  <string id="21448">字幕语言</string>
+  <string id="21449">摇控器发送键盘按键</string>
+
+  <string id="21800">文件名称</string>
+  <string id="21801">文件路径</string>
+  <string id="21802">文件大小</string>
+  <string id="21803">文件日期/时间</string>
+  <string id="21804">幻灯片索引</string>
+  <string id="21805">解析度</string>
+  <string id="21806">评论</string>
+  <string id="21807">彩色/黑白</string>
+  <string id="21808">JPEG 影像处理</string>
+
+  <string id="21820">拍摄时间</string>
+  <string id="21821">描述</string>
+  <string id="21822">制造厂商</string>
+  <string id="21823">相机型号</string>
+  <string id="21824">EXIF 注释</string>
+  <string id="21825">固件</string>
+  <string id="21826">光圈值</string>
+  <string id="21827">镜头焦长</string>
+  <string id="21828">焦点距离</string>
+  <string id="21829">曝光</string>
+  <string id="21830">曝光时间</string>
+  <string id="21831">曝光倾向</string>
+  <string id="21832">曝光模式</string>
+  <string id="21833">闪光灯</string>
+  <string id="21834">白平衡</string>
+  <string id="21835">光源</string>
+  <string id="21836">测光模式</string>
+  <string id="21837">ISO 感光值</string>
+  <string id="21838">数位变焦</string>
+  <string id="21839">CCD 宽度</string>
+  <string id="21840">GPS 纬度</string>
+  <string id="21841">GPS 经度</string>
+  <string id="21842">GPS 高度</string>
+  <string id="21843">方位</string>
+
+  <string id="21860">补充类别</string>
+  <string id="21861">关键字</string>
+  <string id="21862">说明</string>
+  <string id="21863">作者</string>
+  <string id="21864">标题</string>
+  <string id="21865">特别指令</string>
+  <string id="21866">类别</string>
+  <string id="21867">署名报导</string>
+  <string id="21868">署名报导标题</string>
+  <string id="21869">信用</string>
+  <string id="21870">来源</string>
+  <string id="21871">版权条款</string>
+  <string id="21872">物件名称</string>
+  <string id="21873">城市</string>
+  <string id="21874">州</string>
+  <string id="21875">国家</string>
+  <string id="21876">原始的 Tx 引用</string>
+  <string id="21877">日期建立</string>
+  <string id="21878">版权标志</string>
+  <string id="21879">国家代码</string>
+  <string id="21880">参考服务</string>
+  <string id="21881">允许通过 UPnP 控制 XBMC</string>
+  <string id="21882">尝试略过介绍直接跳至 DVD 菜单</string>
+  <string id="21883">保存音乐</string>
+  <string id="21884">查询所有艺人信息</string>
+  <string id="21885">下载专辑信息</string>
+  <string id="21886">下载艺人信息</string>
+  <string id="21887">传记</string>
+  <string id="21888">唱片分类</string>
+  <string id="21889">搜索艺人</string>
+  <string id="21890">选择艺人</string>
+  <string id="21891">艺人信息</string>
+  <string id="21892">乐器</string>
+  <string id="21893">创建时间</string>
+  <string id="21894">成型时间</string>
+  <string id="21895">风格</string>
+  <string id="21896">解散时间</string>
+  <string id="21897">死亡时间</string>
+  <string id="21898">活跃年代</string>
+  <string id="21899">标签</string>
+  <string id="21900">创建/成型</string>
+
+  <!-- strings 21900 thru 21999 reserved for slideshow info -->
+
+  <string id="22000">在启动时更新资料库</string>
+  <string id="22001">总是在后台更新资料库</string>
+  <string id="22002">- DNS 后缀</string>
+
+  <string id="22004">延迟：%2.3fs</string>
+  <string id="22005">提前：%2.3fs</string>
+  <string id="22006">字幕位置</string>
+  <string id="22007">OpenGL 提供商：</string>
+  <string id="22008">OpenGL 渲染器：</string>
+  <string id="22009">OpenGL 版本：</string>
+  <string id="22010">显示卡温度：</string>
+  <string id="22011">CPU 温度：</string>
+  <string id="22012">可用内存</string>
+  <string id="22013">用户配置数据</string>
+  <string id="22014">视频播放暂停时画面变暗</string>
+  <string id="22015">所有记录</string>
+  <string id="22016">标题</string>
+  <string id="22017">组</string>
+  <string id="22018">直播频道</string>
+  <string id="22019">录音的标题</string>
+  <string id="22020">节目表</string>
+  <string id="22021">为减少黑边允许高宽比误差</string>
+  <string id="22022">在列表中显示视频文件</string>
+  <string id="22023">DirectX 提供商：</string>
+  <string id="22024">Direct3D 版本：</string>
+
+  <!-- strings 22030 thru 22060 reserved for karaoke -->
+  <string id="22030">字体</string>
+  <string id="22031">- 尺寸</string>
+  <string id="22032">- 颜色</string>
+  <string id="22033">- 字符集</string>
+  <string id="22034">卡拉OK标题导出为 HTML</string>
+  <string id="22035">卡拉OK标题导出为 CSV</string>
+  <string id="22036">导入卡拉OK标题...</string>
+  <string id="22037">自动显示歌曲选择</string>
+  <string id="22038">导出卡拉OK标题...</string>
+  <string id="22039">输入歌曲编号</string>
+  <string id="22040">白/绿</string>
+  <string id="22041">白/红</string>
+  <string id="22042">白/兰</string>
+  <string id="22043">黑/白</string>
+
+  <string id="23000">天气插件</string>
+  <string id="23001">- 插件设置</string>
+
+  <string id="23050">开启图文电视</string>
+  <string id="23051">片段 %i</string>
+  <string id="23052">缓存 %i 字节</string>
+  <string id="23053">停止</string>
+  <string id="23054">运行</string>
+
+  <!-- strings 23100 thru 23150 reserved for external player -->
+  <string id="23100">外部播放器激活</string>
+  <string id="23101">点 OK 关闭播放器</string>
+
+  <string id="23104">播放完毕时点 OK</string>
+
+  <!-- strings 29800 thru 29998 reserved strings used only in the default Project Mayhem III skin and not c++ code -->
+  <string id="29800">资料库模式</string>
+  <string id="29801">QWERTY 键盘</string>
+  <string id="29802">音频直通输出启用中</string>
+
+  <string id="29999">自动开启游戏抗闪烁过滤</string>
+
+  <!-- strings 30000 thru 30999 reserved for plugins and plugin settings -->
+  <!-- strings 31000 thru 31999 reserved for skins -->
+  <!-- strings 32000 thru 32999 reserved for scripts -->
+  <!-- strings 33000 thru 33999 reserved for common strings used in addons -->
+  <string id="33001">预告片质量Trailer quality</string>
+  <string id="33002">媒体流</string>
+  <string id="33003">下载</string>
+  <string id="33004">下载 &amp; 播放</string>
+  <string id="33005">下载 &amp; 保存</string>
+  <string id="33006">今天</string>
+  <string id="33007">明天</string>
+  <string id="33008">保存</string>
+  <string id="33009">拷贝</string>
+  <string id="33010">设置下载目录</string>
+  <string id="30011">搜索持续时间</string>
+  <string id="33012">短</string>
+  <string id="33013">长</string>
+  <string id="33014">用DVD player代替常规播放器</string>
+  <string id="33015">播放视频前揭示是否先下载</string>
+  <string id="33016">片断</string>
+  <string id="33017">重启以启用插件</string>
+  <string id="33018">今晚</string>
+  <string id="33019">明晚</string>
+  <string id="33020">状况</string>
+  <string id="33021">降雨量</string>
+  <string id="33022">降雨</string>
+  <string id="33023">潮湿</string>
+  <string id="33024">感觉</string>
+  <string id="33025">观测值</string>
+  <string id="33026">偏离正常值</string>
+  <string id="33027">日出</string>
+  <string id="33028">日落</string>
+  <string id="33029">详细资料</string>
+  <string id="33030">天气趋势</string>
+  <string id="33031">流动封面</string>
+  <string id="33032">翻译文本</string>
+  <string id="33033">地图列表 %s 分类</string>
+  <string id="33034">36 小时</string>
+  <string id="33035">地图</string>
+  <string id="33036">每小时</string>
+  <string id="33037">周末</string>
+  <string id="33038">%s 天</string>
+  <string id="33049">提醒</string>
+  <string id="33050">提醒</string>
+  <string id="33051">选择您的</string>
+  <string id="33052">查看您的</string>
+  <string id="33053">配置您的</string>
+  <string id="33054">季节</string>
+  <string id="33055">使用您的</string>
+  <string id="33056">观看您的</string>
+  <string id="33057">聆听您的</string>
+  <string id="33058">浏览您的</string>
+  <string id="33059">配置您的</string>
+  <string id="33060">电源控制</string>
+  <string id="33061">菜单</string>
+  <string id="33062">播放您的</string>
+  <string id="33063">选项</string>
+  <string id="33065">编辑</string>
+  <string id="33066">关于您的</string>
+  <string id="33067">星级</string>
+  <string id="33068">桌面背景</string>
+  <string id="33069">桌面背景集</string>
+  <string id="33070">自定义桌面背景</string>
+  <string id="33071">自定义桌面背景集</string>
+  <string id="33072">浏览自述文件</string>
+  <string id="33073">浏览更新记录</string>
+  <string id="33074">运行此版本的 %s 需要</string>
+  <string id="33075">XBMC为 %s 或更高版本。</string>
+  <string id="33076">请升级XBMC。</string>
+  <string id="33077">未找到数据！</string>
+  <string id="33078">下一页</string>
+  <string id="33079">爱</string>
+  <string id="33080">恨</string>
+  <string id="33081">这是一个堆叠文件，请选择要播放的片段。</string>
+  <string id="33082">脚本目录</string>
+  <string id="33083">启用自定义脚本按钮</string>
+
+  <!-- translators: no need to add these to your language files -->
+  <string id="34000">Lame</string>
+  <string id="34001">Vorbis</string>
+  <string id="34002">Wav</string>
+  <string id="34003">DXVA</string>
+
+  <string id="34100">扬声器设置</string>
+  <string id="34101">2.0</string>
+  <string id="34102">2.1</string>
+  <string id="34103">3.0</string>
+  <string id="34104">3.1</string>
+  <string id="34105">4.0</string>
+  <string id="34106">4.1</string>
+  <string id="34107">5.0</string>
+  <string id="34108">5.1</string>
+  <string id="34109">7.0</string>
+  <string id="34110">7.1</string>
+  <!-- 34112-34200 reserved for future use -->
+</strings>
diff -Naur xbmc-pvr-27594.orig/lib/xbmc-dll-symbols/DllAvFormat.c xbmc-pvr-27594.patch/lib/xbmc-dll-symbols/DllAvFormat.c
--- xbmc-pvr-27594.orig/lib/xbmc-dll-symbols/DllAvFormat.c	1970-01-01 01:00:00.000000000 +0100
+++ xbmc-pvr-27594.patch/lib/xbmc-dll-symbols/DllAvFormat.c	2010-02-09 07:33:38.777898025 +0100
@@ -0,0 +1,83 @@
+/*
+ * various utility functions used within FFmpeg
+ * Copyright (c) 2000, 2001, 2002 Fabrice Bellard
+ *
+ * FFmpeg is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * FFmpeg is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with FFmpeg; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ */
+
+/* Functions defined here are functions that cannot be resolved through the
+ * ffmpeg shared libraries, yet are used in XBMC.
+ */
+
+#if (defined HAVE_CONFIG_H) && (!defined WIN32)
+  #include "config.h"
+#endif
+#if (defined USE_EXTERNAL_FFMPEG)
+#include <libavformat/avformat.h>
+
+/* Taken from libavformat/utils.c */
+static void flush_packet_queue(AVFormatContext *s)
+{
+    AVPacketList *pktl;
+
+    for(;;) {
+        pktl = s->packet_buffer;
+        if (!pktl)
+            break;
+        s->packet_buffer = pktl->next;
+        av_free_packet(&pktl->pkt);
+        av_free(pktl);
+    }
+    while(s->raw_packet_buffer){
+        pktl = s->raw_packet_buffer;
+        s->raw_packet_buffer = pktl->next;
+        av_free_packet(&pktl->pkt);
+        av_free(pktl);
+    }
+    s->packet_buffer_end=
+    s->raw_packet_buffer_end= NULL;
+}
+
+/* Taken from libavformat/utils.c */
+void av_read_frame_flush(AVFormatContext *s)
+{
+    AVStream *st;
+    int i, j;
+
+    flush_packet_queue(s);
+
+    s->cur_st = NULL;
+
+    /* for each stream, reset read state */
+    for(i = 0; i < s->nb_streams; i++) {
+        st = s->streams[i];
+
+        if (st->parser) {
+            av_parser_close(st->parser);
+            st->parser = NULL;
+            av_free_packet(&st->cur_pkt);
+        }
+        st->last_IP_pts = AV_NOPTS_VALUE;
+        st->cur_dts = AV_NOPTS_VALUE; /* we set the current DTS to an unspecified origin */
+        st->reference_dts = AV_NOPTS_VALUE;
+        /* fail safe */
+        st->cur_ptr = NULL;
+        st->cur_len = 0;
+
+        for(j=0; j<MAX_REORDER_DELAY+1; j++)
+            st->pts_buffer[j]= AV_NOPTS_VALUE;
+    }
+}
+#endif /* (defined USE_EXTERNAL_FFMPEG) */
diff -Naur xbmc-pvr-27594.orig/lib/xbmc-dll-symbols/Makefile xbmc-pvr-27594.patch/lib/xbmc-dll-symbols/Makefile
--- xbmc-pvr-27594.orig/lib/xbmc-dll-symbols/Makefile	1970-01-01 01:00:00.000000000 +0100
+++ xbmc-pvr-27594.patch/lib/xbmc-dll-symbols/Makefile	2010-02-09 07:33:38.778906804 +0100
@@ -0,0 +1,6 @@
+SRCS = DllAvFormat.c
+
+LIB = dll-symbols.a
+
+include ../../Makefile.include
+-include $(patsubst %.cpp,%.P,$(patsubst %.c,%.P,$(SRCS)))
diff -Naur xbmc-pvr-27594.orig/Makefile.in xbmc-pvr-27594.patch/Makefile.in
--- xbmc-pvr-27594.orig/Makefile.in	2010-02-08 19:09:44.000000000 +0100
+++ xbmc-pvr-27594.patch/Makefile.in	2010-02-09 07:33:38.769772192 +0100
@@ -98,7 +98,8 @@
 	xbmc/lib/libid3tag \
 	xbmc/lib/libapetag \
 	xbmc/lib/libPython/linux \
-	lib/libmodplug
+	lib/libmodplug \
+	lib/xbmc-dll-symbols
 
 SS_DIRS=\
 	xbmc/screensavers/rsxs-0.9/xbmc
@@ -278,6 +279,8 @@
 	$(MAKE) -C xbmc/lib/libapetag
 lib/libmodplug/src/.libs/libmodplug.a: force
 	$(MAKE) -C lib/libmodplug
+lib/xbmc-dll-symbols/dll-symbols.a: force
+	$(MAKE) -C lib/xbmc-dll-symbols
 
 exports:
 	$(MAKE) xbmc/cores/DllLoader/exports/exports.a
@@ -441,6 +444,8 @@
 	xbmc/posix/posix.a
 endif
 
+OBJSXBMC += lib/xbmc-dll-symbols/dll-symbols.a
+
 xbmc.bin: $(OBJSXBMC) $(DYNOBJSXBMC)
 ifeq ($(findstring osx,$(ARCH)), osx)
 	$(CXX) $(CXXFLAGS) -o xbmc.bin -Wl,-all_load,-ObjC $(DYNOBJSXBMC) $(OBJSXBMC) $(LIBS) $(LDFLAGS) -rdynamic
diff -Naur xbmc-pvr-27594.orig/Makefile.in.orig xbmc-pvr-27594.patch/Makefile.in.orig
diff -Naur xbmc-pvr-27594.orig/xbmc/ButtonTranslator.cpp xbmc-pvr-27594.patch/xbmc/ButtonTranslator.cpp
--- xbmc-pvr-27594.orig/xbmc/ButtonTranslator.cpp	2010-02-08 18:53:42.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/ButtonTranslator.cpp	2010-02-09 07:31:57.960897391 +0100
@@ -948,6 +948,7 @@
   else if (strWindow.Equals("karaokelargeselector")) windowID = WINDOW_DIALOG_KARAOKE_SELECTOR;
   else if (strWindow.Equals("sliderdialog")) windowID = WINDOW_DIALOG_SLIDER;
   else if (strWindow.Equals("songinformation")) windowID = WINDOW_DIALOG_SONG_INFO;
+  else if (strWindow.Equals("busydialog")) windowID = WINDOW_DIALOG_BUSY;
   else
     CLog::Log(LOGERROR, "Window Translator: Can't find window %s", strWindow.c_str());
 
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/Codecs/DllAvCodec.h xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/Codecs/DllAvCodec.h
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/Codecs/DllAvCodec.h	2010-02-08 18:53:23.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/Codecs/DllAvCodec.h	2010-02-09 07:33:32.412911808 +0100
@@ -89,7 +89,7 @@
                                      void * const out[6], const int out_stride[6],
                                const void * const  in[6], const int  in_stride[6], int len)=0;
   virtual int av_dup_packet(AVPacket *pkt)=0;
-  virtual int av_init_packet(AVPacket *pkt)=0;
+  virtual void av_init_packet(AVPacket *pkt)=0;
 };
 
 #if (defined USE_EXTERNAL_FFMPEG)
@@ -160,7 +160,7 @@
           { return ::av_audio_convert(ctx, out, out_stride, in, in_stride, len); }
 
   virtual int av_dup_packet(AVPacket *pkt) { return ::av_dup_packet(pkt); }
-  virtual int av_init_packet(AVPacket *pkt) { return ::av_init_packet(pkt); }
+  virtual void av_init_packet(AVPacket *pkt) { return ::av_init_packet(pkt); }
 
 
   // DLL faking.
@@ -197,7 +197,7 @@
   DEFINE_METHOD8(int, av_parser_parse, (AVCodecParserContext* p1, AVCodecContext* p2, uint8_t** p3, int* p4, const uint8_t* p5, int p6, int64_t p7, int64_t p8))
 #endif
   DEFINE_METHOD1(int, av_dup_packet, (AVPacket *p1))
-  DEFINE_METHOD1(int, av_init_packet, (AVPacket *p1))
+  DEFINE_METHOD1(void, av_init_packet, (AVPacket *p1))
 
   LOAD_SYMBOLS();
 
@@ -320,7 +320,7 @@
    virtual void av_freep(void *ptr) { ::av_freep(ptr); }
    virtual int64_t av_rescale_rnd(int64_t a, int64_t b, int64_t c, enum AVRounding d) { return ::av_rescale_rnd(a, b, c, d); }
    virtual const AVCRC* av_crc_get_table(AVCRCId crc_id) { return ::av_crc_get_table(crc_id); }
-   virtual uint32_t av_crc(const AVCRC *ctx, uint32_t crc, const uint8_t *buffer, size_t length) { return ::av_crc(ctx, crc, buffer); }
+   virtual uint32_t av_crc(const AVCRC *ctx, uint32_t crc, const uint8_t *buffer, size_t length) { return ::av_crc(ctx, crc, buffer, length); }
 
    // DLL faking.
    virtual bool ResolveExports() { return true; }
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/Codecs/DllAvFormat.h xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/Codecs/DllAvFormat.h
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/Codecs/DllAvFormat.h	2010-02-08 18:53:23.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/Codecs/DllAvFormat.h	2010-02-09 07:33:38.777898025 +0100
@@ -18,11 +18,13 @@
 #if (defined USE_EXTERNAL_FFMPEG)
   #if (defined HAVE_LIBAVFORMAT_AVFORMAT_H)
     #include <libavformat/avformat.h>
-    #include <libavformat/riff.h>
   #else
     #include <ffmpeg/avformat.h>
-    #include <ffmpeg/riff.h>
   #endif
+  /* libavformat/riff.h is not a public header, so include it here */
+  #include <xbmc/cores/dvdplayer/Codecs/ffmpeg/libavformat/riff.h>
+  /* av_read_frame_flush() is defined for us in DllAvFormat.c */
+  void av_read_frame_flush(AVFormatContext *s);
 #else
   #include "libavformat/avformat.h"
   #include "libavformat/riff.h"
@@ -42,9 +44,9 @@
   virtual void av_close_input_file(AVFormatContext *s)=0;
   virtual void av_close_input_stream(AVFormatContext *s)=0;
   virtual int av_read_frame(AVFormatContext *s, AVPacket *pkt)=0;
+  virtual void av_read_frame_flush(AVFormatContext *s)=0;
   virtual int av_read_play(AVFormatContext *s)=0;
   virtual int av_read_pause(AVFormatContext *s)=0;
-  virtual void av_read_frame_flush(AVFormatContext *s)=0;
   virtual int av_seek_frame(AVFormatContext *s, int stream_index, int64_t timestamp, int flags)=0;
 #if (!defined USE_EXTERNAL_FFMPEG)
   virtual int av_find_stream_info_dont_call(AVFormatContext *ic)=0;
@@ -101,6 +103,7 @@
   virtual void av_close_input_file(AVFormatContext *s) { ::av_close_input_file(s); }
   virtual void av_close_input_stream(AVFormatContext *s) { ::av_close_input_stream(s); }
   virtual int av_read_frame(AVFormatContext *s, AVPacket *pkt) { return ::av_read_frame(s, pkt); }
+  virtual void av_read_frame_flush(AVFormatContext *s) { return ::av_read_frame_flush(s); }
   virtual int av_read_play(AVFormatContext *s) { return ::av_read_play(s); }
   virtual int av_read_pause(AVFormatContext *s) { return ::av_read_pause(s); }
   virtual int av_seek_frame(AVFormatContext *s, int stream_index, int64_t timestamp, int flags) { return ::av_seek_frame(s, stream_index, timestamp, flags); }
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Audio/DVDAudioCodecLibFaad.cpp xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Audio/DVDAudioCodecLibFaad.cpp
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Audio/DVDAudioCodecLibFaad.cpp	2010-02-08 18:53:24.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Audio/DVDAudioCodecLibFaad.cpp	2010-02-09 07:31:57.961900793 +0100
@@ -105,21 +105,25 @@
 
 enum PCMChannels* CDVDAudioCodecLibFaad::GetChannelMap()
 {
+  int index = 0;
   for(int i = 0; i < m_iSourceChannels; ++i)
-  {
     switch(m_frameInfo.channel_position[i])
     {
-      case FRONT_CHANNEL_CENTER: m_pChannelMap[i] = PCM_FRONT_CENTER ; break;
-      case FRONT_CHANNEL_LEFT  : m_pChannelMap[i] = PCM_FRONT_LEFT   ; break;
-      case FRONT_CHANNEL_RIGHT : m_pChannelMap[i] = PCM_FRONT_RIGHT  ; break;
-      case SIDE_CHANNEL_LEFT   : m_pChannelMap[i] = PCM_SIDE_LEFT    ; break;
-      case SIDE_CHANNEL_RIGHT  : m_pChannelMap[i] = PCM_SIDE_RIGHT   ; break;
-      case BACK_CHANNEL_LEFT   : m_pChannelMap[i] = PCM_BACK_LEFT    ; break;
-      case BACK_CHANNEL_RIGHT  : m_pChannelMap[i] = PCM_BACK_RIGHT   ; break;
-      case BACK_CHANNEL_CENTER : m_pChannelMap[i] = PCM_BACK_CENTER  ; break;
-      case LFE_CHANNEL         : m_pChannelMap[i] = PCM_LOW_FREQUENCY; break;
+      case FRONT_CHANNEL_CENTER: m_pChannelMap[index++] = PCM_FRONT_CENTER ; break;
+      case FRONT_CHANNEL_LEFT  : m_pChannelMap[index++] = PCM_FRONT_LEFT   ; break;
+      case FRONT_CHANNEL_RIGHT : m_pChannelMap[index++] = PCM_FRONT_RIGHT  ; break;
+      case SIDE_CHANNEL_LEFT   : m_pChannelMap[index++] = PCM_SIDE_LEFT    ; break;
+      case SIDE_CHANNEL_RIGHT  : m_pChannelMap[index++] = PCM_SIDE_RIGHT   ; break;
+      case BACK_CHANNEL_LEFT   : m_pChannelMap[index++] = PCM_BACK_LEFT    ; break;
+      case BACK_CHANNEL_RIGHT  : m_pChannelMap[index++] = PCM_BACK_RIGHT   ; break;
+      case BACK_CHANNEL_CENTER : m_pChannelMap[index++] = PCM_BACK_CENTER  ; break;
+      case LFE_CHANNEL         : m_pChannelMap[index++] = PCM_LOW_FREQUENCY; break;
     }
-  }
+
+  if (index < m_iSourceChannels)
+    return NULL;
+
+  assert(index == m_iSourceChannels);
   return m_pChannelMap;
 }
 
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Video/CrystalHD/CrystalHD.cpp xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Video/CrystalHD/CrystalHD.cpp
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Video/CrystalHD/CrystalHD.cpp	2010-02-08 18:53:24.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Video/CrystalHD/CrystalHD.cpp	2010-02-09 07:33:28.840898772 +0100
@@ -1597,6 +1597,14 @@
     return false;
 }
 
+int CCrystalHD::GetInputCount(void)
+{
+  if (m_pInputThread)
+    return m_pInputThread->GetInputCount();
+  else
+    return 0;
+}
+
 int CCrystalHD::GetReadyCount(void)
 {
   if (m_pOutputThread)
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Video/CrystalHD/CrystalHD.h xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Video/CrystalHD/CrystalHD.h
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Video/CrystalHD/CrystalHD.h	2010-02-08 18:53:24.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Video/CrystalHD/CrystalHD.h	2010-02-09 07:33:28.837804757 +0100
@@ -127,6 +127,7 @@
   void Reset(void);
   bool AddInput(unsigned char *pData, size_t size, double pts);
 
+  int  GetInputCount(void);
   int  GetReadyCount(void);
   void BusyListPop(void);
 
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Video/DVDVideoCodecCrystalHD.cpp xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Video/DVDVideoCodecCrystalHD.cpp
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Video/DVDVideoCodecCrystalHD.cpp	2010-02-08 18:53:24.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Video/DVDVideoCodecCrystalHD.cpp	2010-02-09 07:33:28.841899451 +0100
@@ -165,15 +165,17 @@
   // Handle Input, add demuxer packet to input queue, we must accept it or
   // it will be discarded as DVDPlayerVideo has no concept of "try again".
   if ( m_Device->AddInput(pData, iSize, m_pts) )
-    pData = NULL;
+  {
+    // always wait for input to be consumed, one less thing to worry about
+    //while (m_Device->GetInputCount())
+    //  Sleep(1);
+  }
   else
   {
     // Deep crap error, this should never happen unless we run away pulling demuxer pkts.
     CLog::Log(LOGDEBUG, "%s: m_pInputThread->AddInput full.", __MODULE_NAME__);
     Sleep(10);
   }
-  // Always return VC_BUFFER
-  ret |= VC_BUFFER;
 
   // Fake a decoding delay of 1/2 the frame duration, this helps keep DVDPlayerVideo from
   // draining the demuxer queue. DVDPlayerVideo expects one picture frame for each demuxer
@@ -199,6 +201,8 @@
       ret |= VC_PICTURE;
     }
   }
+  if (m_Device->GetInputCount() < 2)
+    ret |= VC_BUFFER;
 
   return ret;
 }
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Video/DVDVideoCodec.h xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Video/DVDVideoCodec.h
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Video/DVDVideoCodec.h	2010-02-08 18:53:24.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Video/DVDVideoCodec.h	2010-02-09 07:33:01.061899743 +0100
@@ -89,7 +89,6 @@
 
 #define DVP_FLAG_NOSKIP             0x00000010 // indicate this picture should never be dropped
 #define DVP_FLAG_DROPPED            0x00000020 // indicate that this picture has been dropped in decoder stage, will have no data
-#define DVP_FLAG_NOAUTOSYNC         0x00000040 // disregard any smooth syncing on this picture
 
 // DVP_FLAG 0x00000100 - 0x00000f00 is in use by libmpeg2!
 
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Video/VDPAU.cpp xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Video/VDPAU.cpp
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDCodecs/Video/VDPAU.cpp	2010-01-24 11:49:29.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDCodecs/Video/VDPAU.cpp	2010-02-09 07:33:19.948774751 +0100
@@ -1209,7 +1209,6 @@
   if(m_mixerstep)
   {
     picture->iRepeatPicture = -0.5;
-    picture->iFlags |= DVP_FLAG_NOAUTOSYNC;
     if(m_mixerstep > 1)
       picture->pts = DVD_NOPTS_VALUE;
   }
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDDemuxers/DVDDemuxFFmpeg.cpp.orig xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDDemuxers/DVDDemuxFFmpeg.cpp.orig
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDDemuxers/DVDDemuxFFmpeg.cpp.orig	1970-01-01 01:00:00.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDDemuxers/DVDDemuxFFmpeg.cpp.orig	2010-02-09 07:33:32.409807037 +0100
@@ -0,0 +1,1256 @@
+/*
+ *      Copyright (C) 2005-2008 Team XBMC
+ *      http://www.xbmc.org
+ *
+ *  This Program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2, or (at your option)
+ *  any later version.
+ *
+ *  This Program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ *  GNU General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with XBMC; see the file COPYING.  If not, write to
+ *  the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.
+ *  http://www.gnu.org/copyleft/gpl.html
+ *
+ */
+
+#if (defined HAVE_CONFIG_H) && (!defined WIN32)
+  #include "config.h"
+#endif
+#include "system.h"
+#ifndef __STDC_CONSTANT_MACROS
+#define __STDC_CONSTANT_MACROS
+#endif
+#ifndef __STDC_LIMIT_MACROS
+#define __STDC_LIMIT_MACROS
+#endif
+#ifdef _LINUX
+#include "stdint.h"
+#else
+#define INT64_C __int64
+#endif
+#include "DVDDemuxFFmpeg.h"
+#include "DVDInputStreams/DVDInputStream.h"
+#include "DVDInputStreams/DVDInputStreamNavigator.h"
+#ifdef HAS_FILESYSTEM_MMS
+#include "DVDInputStreams/DVDInputStreamMMS.h"
+#endif
+#include "DVDInputStreams/DVDInputStreamRTMP.h"
+#include "DVDDemuxUtils.h"
+#include "DVDClock.h" // for DVD_TIME_BASE
+#include "utils/Win32Exception.h"
+#include "AdvancedSettings.h"
+#include "GUISettings.h"
+#include "FileSystem/File.h"
+#include "FileSystem/Directory.h"
+#include "utils/log.h"
+#include "Thread.h"
+#include "utils/TimeUtils.h"
+
+void CDemuxStreamAudioFFmpeg::GetStreamInfo(std::string& strInfo)
+{
+  if(!m_stream) return;
+  char temp[128];
+  m_parent->m_dllAvCodec.avcodec_string(temp, 128, m_stream->codec, 0);
+  strInfo = temp;
+}
+
+void CDemuxStreamAudioFFmpeg::GetStreamName(std::string& strInfo)
+{
+  if(!m_stream) return;
+  if(!m_description.empty())
+    strInfo = m_description;
+  else
+    CDemuxStream::GetStreamName(strInfo);
+}
+
+void CDemuxStreamSubtitleFFmpeg::GetStreamName(std::string& strInfo)
+{
+  if(!m_stream) return;
+  if(!m_description.empty())
+    strInfo = m_description;
+  else
+    CDemuxStream::GetStreamName(strInfo);
+}
+
+void CDemuxStreamVideoFFmpeg::GetStreamInfo(std::string& strInfo)
+{
+  if(!m_stream) return;
+  char temp[128];
+  m_parent->m_dllAvCodec.avcodec_string(temp, 128, m_stream->codec, 0);
+  strInfo = temp;
+}
+
+void CDemuxStreamSubtitleFFmpeg::GetStreamInfo(std::string& strInfo)
+{
+  if(!m_stream) return;
+  char temp[128];
+  m_parent->m_dllAvCodec.avcodec_string(temp, 128, m_stream->codec, 0);
+  strInfo = temp;
+}
+
+// these need to be put somewhere that are compiled, we should have some better place for it
+
+CCriticalSection DllAvCodec::m_critSection;
+std::map<uintptr_t, CStdString> g_logbuffer;
+
+void ff_avutil_log(void* ptr, int level, const char* format, va_list va)
+{
+  CSingleLock lock(DllAvCodec::m_critSection);
+  uintptr_t threadId = (uintptr_t)CThread::GetCurrentThreadId();
+  CStdString &buffer = g_logbuffer[threadId];
+
+  AVClass* avc= ptr ? *(AVClass**)ptr : NULL;
+
+  if(level >= AV_LOG_DEBUG && g_advancedSettings.m_logLevel <= LOG_LEVEL_DEBUG_SAMBA)
+    return;
+  else if(g_advancedSettings.m_logLevel <= LOG_LEVEL_NORMAL)
+    return;
+
+  int type;
+  switch(level)
+  {
+    case AV_LOG_INFO   : type = LOGINFO;    break;
+    case AV_LOG_ERROR  : type = LOGERROR;   break;
+    case AV_LOG_DEBUG  :
+    default            : type = LOGDEBUG;   break;
+  }
+
+  CStdString message, prefix;
+  message.FormatV(format, va);
+
+  prefix.Format("ffmpeg[%X]: ", threadId);
+  if(avc)
+  {
+    if(avc->item_name)
+      prefix += CStdString("[") + avc->item_name(ptr) + "] ";
+    else if(avc->class_name)
+      prefix += CStdString("[") + avc->class_name + "] ";
+  }
+
+  buffer += message;
+  int pos, start = 0;
+  while( (pos = buffer.find_first_of('\n', start)) >= 0 )
+  {
+    if(pos>start)
+      CLog::Log(type, "%s%s", prefix.c_str(), buffer.substr(start, pos-start).c_str());
+    start = pos+1;
+  }
+  buffer.erase(0, start);
+}
+
+static void ff_flush_avutil_log_buffers(void)
+{
+  CSingleLock lock(DllAvCodec::m_critSection);
+
+  /* Loop through the logbuffer list and remove any blank buffers
+     If the thread using the buffer is still active, it will just
+     add a new buffer next time it writes to the log */
+  std::map<uintptr_t, CStdString>::iterator it;
+  for (it = g_logbuffer.begin(); it != g_logbuffer.end(); )
+    if ((*it).second.IsEmpty())
+      g_logbuffer.erase(it++);
+    else
+      ++it;
+}
+
+#ifdef _MSC_VER
+static __declspec(thread) CDVDDemuxFFmpeg* g_demuxer = 0;
+#else
+static TLS g_tls;
+#define g_demuxer (*((CDVDDemuxFFmpeg**)g_tls.Get()))
+#endif
+
+static int interrupt_cb(void)
+{
+  if(g_demuxer && g_demuxer->Aborted())
+    return 1;
+  return 0;
+}
+
+////////////////////////////////////////////////////////////////////////////////////////////////
+////////////////////////////////////////////////////////////////////////////////////////////////
+/*
+static int dvd_file_open(URLContext *h, const char *filename, int flags)
+{
+  return -1;
+}
+*/
+
+static int dvd_file_read(URLContext *h, BYTE* buf, int size)
+{
+  if(interrupt_cb())
+    return -1;
+
+  CDVDInputStream* pInputStream = (CDVDInputStream*)h->priv_data;
+  return pInputStream->Read(buf, size);
+}
+/*
+static int dvd_file_write(URLContext *h, BYTE* buf, int size)
+{
+  return -1;
+}
+*/
+static offset_t dvd_file_seek(URLContext *h, offset_t pos, int whence)
+{
+  if(interrupt_cb())
+    return -1;
+
+  CDVDInputStream* pInputStream = (CDVDInputStream*)h->priv_data;
+  if(whence == AVSEEK_SIZE)
+    return pInputStream->GetLength();
+  else
+    return pInputStream->Seek(pos, whence);
+}
+
+static int dvd_file_close(URLContext *h)
+{
+  return 0;
+}
+
+URLProtocol dvd_file_protocol = {
+                                  "CDVDInputStream",
+                                  NULL,                 /*url_open*/
+                                  dvd_file_read,        /*url_read*/
+                                  NULL,                 /*url_write*/
+                                  dvd_file_seek,        /*url_seek*/
+                                  dvd_file_close,       /*url_close*/
+                                  NULL,                 /*URLProtocol*/
+                                  NULL,                 /*url_read_pause*/
+                                  NULL                  /*url_read_seek*/
+                                };
+
+////////////////////////////////////////////////////////////////////////////////////////////////
+////////////////////////////////////////////////////////////////////////////////////////////////
+
+CDVDDemuxFFmpeg::CDVDDemuxFFmpeg() : CDVDDemux()
+{
+  m_pFormatContext = NULL;
+  m_pInput = NULL;
+  m_ioContext = NULL;
+  InitializeCriticalSection(&m_critSection);
+  for (int i = 0; i < MAX_STREAMS; i++) m_streams[i] = NULL;
+  m_iCurrentPts = DVD_NOPTS_VALUE;
+}
+
+CDVDDemuxFFmpeg::~CDVDDemuxFFmpeg()
+{
+  Dispose();
+  DeleteCriticalSection(&m_critSection);
+  ff_flush_avutil_log_buffers();
+}
+
+bool CDVDDemuxFFmpeg::Aborted()
+{
+  if(!m_timeout)
+    return false;
+
+  if(CTimeUtils::GetTimeMS() > m_timeout)
+    return true;
+
+  return false;
+}
+
+bool CDVDDemuxFFmpeg::Open(CDVDInputStream* pInput)
+{
+  AVInputFormat* iformat = NULL;
+  std::string strFile;
+  m_iCurrentPts = DVD_NOPTS_VALUE;
+  m_speed = DVD_PLAYSPEED_NORMAL;
+  g_demuxer = this;
+
+  if (!pInput) return false;
+
+  if (!m_dllAvUtil.Load() || !m_dllAvCodec.Load() || !m_dllAvFormat.Load())  {
+    CLog::Log(LOGERROR,"CDVDDemuxFFmpeg::Open - failed to load ffmpeg libraries");
+    return false;
+  }
+
+  // register codecs
+  m_dllAvFormat.av_register_all();
+  m_dllAvFormat.url_set_interrupt_cb(interrupt_cb);
+
+  // could be used for interupting ffmpeg while opening a file (eg internet streams)
+  // url_set_interrupt_cb(NULL);
+
+  m_pInput = pInput;
+  strFile = m_pInput->GetFileName();
+
+  bool streaminfo = true; /* set to true if we want to look for streams before playback*/
+
+  if( m_pInput->GetContent().length() > 0 )
+  {
+    std::string content = m_pInput->GetContent();
+
+    /* check if we can get a hint from content */
+    if( content.compare("audio/aacp") == 0 )
+      iformat = m_dllAvFormat.av_find_input_format("aac");
+    else if( content.compare("audio/aac") == 0 )
+      iformat = m_dllAvFormat.av_find_input_format("aac");
+    else if( content.compare("video/x-vobsub") == 0 )
+      iformat = m_dllAvFormat.av_find_input_format("mpeg");
+    else if( content.compare("video/x-dvd-mpeg") == 0 )
+      iformat = m_dllAvFormat.av_find_input_format("mpeg");
+    else if( content.compare("video/flv") == 0 )
+      iformat = m_dllAvFormat.av_find_input_format("flv");
+    else if( content.compare("video/x-flv") == 0 )
+      iformat = m_dllAvFormat.av_find_input_format("flv");
+
+    /* these are likely pure streams, and as such we don't */
+    /* want to try to look for streaminfo before playback */
+    if( iformat )
+      streaminfo = false;
+  }
+
+  if( m_pInput->IsStreamType(DVDSTREAM_TYPE_FFMPEG) )
+  {
+    m_timeout = CTimeUtils::GetTimeMS() + 10000;
+
+    // special stream type that makes avformat handle file opening
+    // allows internal ffmpeg protocols to be used
+    if( m_dllAvFormat.av_open_input_file(&m_pFormatContext, strFile.c_str(), iformat, FFMPEG_FILE_BUFFER_SIZE, NULL) < 0 )
+    {
+      CLog::Log(LOGDEBUG, "Error, could not open file %s", strFile.c_str());
+      Dispose();
+      return false;
+    }
+  }
+  else
+  {
+    m_timeout = 0;
+
+    // initialize url context to be used as filedevice
+    URLContext* context = (URLContext*)m_dllAvUtil.av_mallocz(sizeof(struct URLContext) + strFile.length() + 1);
+    context->prot = &dvd_file_protocol;
+    context->priv_data = (void*)m_pInput;
+    context->max_packet_size = FFMPEG_FILE_BUFFER_SIZE;
+
+    if (m_pInput->IsStreamType(DVDSTREAM_TYPE_DVD))
+    {
+      context->max_packet_size = FFMPEG_DVDNAV_BUFFER_SIZE;
+      context->is_streamed = 1;
+    }
+    else if ((m_pInput->IsStreamType(DVDSTREAM_TYPE_TV)) ||
+             (m_pInput->IsStreamType(DVDSTREAM_TYPE_PVRMANAGER)))
+    {
+      if(m_pInput->Seek(0, SEEK_POSSIBLE) == 0)
+        context->is_streamed = 1;
+
+      // this actually speeds up channel changes by almost a second
+      // however, it alsa makes player not buffer anything, this
+      // leads to buffer underruns in audio renderer
+      //if(context->is_streamed)
+      //  streaminfo = false;
+    }
+    else
+    {
+      if(m_pInput->Seek(0, SEEK_POSSIBLE) == 0)
+        context->is_streamed = 1;
+    }
+
+#if LIBAVFORMAT_VERSION_INT >= (52<<16)
+    context->filename = (char *) &context[1];
+#endif
+
+    strcpy(context->filename, strFile.c_str());
+
+    // open our virtual file device
+    if(m_dllAvFormat.url_fdopen(&m_ioContext, context) < 0)
+    {
+      CLog::Log(LOGERROR, "%s - Unable to init io context", __FUNCTION__);
+      m_dllAvUtil.av_free(context);
+      Dispose();
+      return false;
+    }
+
+    if( iformat == NULL )
+    {
+      // let ffmpeg decide which demuxer we have to open
+      AVProbeData pd;
+      BYTE probe_buffer[FFMPEG_FILE_BUFFER_SIZE + AVPROBE_PADDING_SIZE];
+
+      // init probe data
+      pd.buf = probe_buffer;
+      pd.filename = strFile.c_str();
+
+      // read data using avformat's buffers
+      if(context->is_streamed)
+        pd.buf_size = m_dllAvFormat.get_partial_buffer(m_ioContext, pd.buf, context->max_packet_size);
+      else
+        pd.buf_size = m_dllAvFormat.get_buffer(m_ioContext, pd.buf, context->max_packet_size);
+
+      if (pd.buf_size <= 0)
+      {
+        CLog::Log(LOGERROR, "%s - error reading from input stream, %s", __FUNCTION__, strFile.c_str());
+        return false;
+      }
+      memset(pd.buf+pd.buf_size, 0, AVPROBE_PADDING_SIZE);
+
+      // restore position again
+      m_dllAvFormat.url_fseek(m_ioContext , 0, SEEK_SET);
+
+      iformat = m_dllAvFormat.av_probe_input_format(&pd, 1);
+      if (!iformat)
+      {
+        // av_probe_input_format failed, re-probe the ffmpeg/ffplay method.
+        // av_open_input_file uses av_probe_input_format2 for probing format,
+        // starting at 2048, up to max buffer size of 1048576. We just probe to
+        // the buffer size allocated above so as to avoid seeks on content that
+        // might not be seekable.
+        int max_buf_size = pd.buf_size;
+        for (int probe_size=std::min(2048, pd.buf_size); probe_size <= max_buf_size && !iformat; probe_size<<=1)
+        {
+          CLog::Log(LOGDEBUG, "%s - probing failed, re-probing with probe size [%d]", __FUNCTION__, probe_size);
+          int score= probe_size < max_buf_size ? AVPROBE_SCORE_MAX/4 : 0;
+          pd.buf_size = probe_size;
+          iformat = m_dllAvFormat.av_probe_input_format2(&pd, 1, &score);
+        }
+      }
+      if (!iformat)
+      {
+        CLog::Log(LOGERROR, "%s - error probing input format, %s", __FUNCTION__, strFile.c_str());
+        return false;
+      }
+      else
+      {
+        if (iformat->name)
+          CLog::Log(LOGDEBUG, "%s - probing detected format [%s]", __FUNCTION__, iformat->name);
+        else
+          CLog::Log(LOGDEBUG, "%s - probing detected unnamed format", __FUNCTION__);
+      }
+    }
+
+
+    // open the demuxer
+    if (m_dllAvFormat.av_open_input_stream(&m_pFormatContext, m_ioContext, strFile.c_str(), iformat, NULL) < 0)
+    {
+      CLog::Log(LOGERROR, "%s - Error, could not open file %s", __FUNCTION__, strFile.c_str());
+      Dispose();
+      return false;
+    }
+  }
+
+  // we need to know if this is matroska later
+  m_bMatroska = strcmp(m_pFormatContext->iformat->name, "matroska") == 0;
+
+  // in combination with libdvdnav seek, av_find_stream_info wont work
+  // so we do this for files only
+  if (streaminfo)
+  {
+    /* too speed up live sources, only analyse very short */
+    if(m_pInput->Seek(0, SEEK_POSSIBLE) == 0)
+      m_pFormatContext->max_analyze_duration = 500000;
+
+
+    CLog::Log(LOGDEBUG, "%s - av_find_stream_info starting", __FUNCTION__);
+    int iErr = m_dllAvFormat.av_find_stream_info(m_pFormatContext);
+    if (iErr < 0)
+    {
+      CLog::Log(LOGWARNING,"could not find codec parameters for %s", strFile.c_str());
+      if (m_pFormatContext->nb_streams == 1 && m_pFormatContext->streams[0]->codec->codec_id == CODEC_ID_AC3)
+      {
+        // special case, our codecs can still handle it.
+      }
+      else
+      {
+        Dispose();
+        return false;
+      }
+    }
+    CLog::Log(LOGDEBUG, "%s - av_find_stream_info finished", __FUNCTION__);
+  }
+  // reset any timeout
+  m_timeout = 0;
+
+  // if format can be nonblocking, let's use that
+  m_pFormatContext->flags |= AVFMT_FLAG_NONBLOCK;
+
+  // print some extra information
+  m_dllAvFormat.dump_format(m_pFormatContext, 0, strFile.c_str(), 0);
+
+  UpdateCurrentPTS();
+
+  if (m_pInput->IsStreamType(DVDSTREAM_TYPE_MMS)) // HACK: until we figure out how to detect which mms streams are active
+    return true;
+
+  // add the ffmpeg streams to our own stream array
+  if (m_pFormatContext->nb_programs)
+  {
+    m_program = UINT_MAX;
+    // look for first non empty stream and discard nonselected programs
+    for (unsigned int i = 0; i < m_pFormatContext->nb_programs; i++)
+    {
+      if(m_program == UINT_MAX && m_pFormatContext->programs[i]->nb_stream_indexes > 0)
+        m_program = i;
+
+      if(i != m_program)
+        m_pFormatContext->programs[i]->discard = AVDISCARD_ALL;
+    }
+    if(m_program == UINT_MAX)
+      m_program = 0;
+
+    // add streams from selected program
+    for (unsigned int i = 0; i < m_pFormatContext->programs[m_program]->nb_stream_indexes; i++)
+      AddStream(m_pFormatContext->programs[m_program]->stream_index[i]);
+  }
+  else
+  {
+    for (unsigned int i = 0; i < m_pFormatContext->nb_streams; i++)
+      AddStream(i);
+  }
+
+  return true;
+}
+
+void CDVDDemuxFFmpeg::Dispose()
+{
+  g_demuxer = this;
+
+  if (m_pFormatContext)
+  {
+    if (m_ioContext)
+    {
+      if(m_pFormatContext->pb && m_pFormatContext->pb != m_ioContext)
+      {
+        CLog::Log(LOGWARNING, "CDVDDemuxFFmpeg::Dispose - demuxer changed our byte context behind our back, possible memleak");
+        m_ioContext = m_pFormatContext->pb;
+      }
+      m_dllAvFormat.av_close_input_stream(m_pFormatContext);
+      m_dllAvFormat.url_fclose(m_ioContext);
+    }
+    else
+      m_dllAvFormat.av_close_input_file(m_pFormatContext);
+  }
+  m_ioContext = NULL;
+  m_pFormatContext = NULL;
+  m_speed = DVD_PLAYSPEED_NORMAL;
+
+  for (int i = 0; i < MAX_STREAMS; i++)
+  {
+    if (m_streams[i])
+    {
+      if (m_streams[i]->ExtraData)
+        delete[] (BYTE*)(m_streams[i]->ExtraData);
+      delete m_streams[i];
+    }
+    m_streams[i] = NULL;
+  }
+  m_pInput = NULL;
+
+  m_dllAvFormat.Unload();
+  m_dllAvCodec.Unload();
+  m_dllAvUtil.Unload();
+}
+
+void CDVDDemuxFFmpeg::Reset()
+{
+  CDVDInputStream* pInputStream = m_pInput;
+  Dispose();
+  Open(pInputStream);
+}
+
+void CDVDDemuxFFmpeg::Flush()
+{
+  g_demuxer = this;
+
+#if (!defined USE_EXTERNAL_FFMPEG)
+  if (m_pFormatContext)
+    m_dllAvFormat.av_read_frame_flush(m_pFormatContext);
+#endif
+
+  m_iCurrentPts = DVD_NOPTS_VALUE;
+}
+
+void CDVDDemuxFFmpeg::Abort()
+{
+  m_timeout = 1;
+}
+
+void CDVDDemuxFFmpeg::SetSpeed(int iSpeed)
+{
+  g_demuxer = this;
+
+  if(!m_pFormatContext)
+    return;
+
+  if(m_speed != DVD_PLAYSPEED_PAUSE && iSpeed == DVD_PLAYSPEED_PAUSE)
+  {
+    m_pInput->Pause((double)m_iCurrentPts);
+    m_dllAvFormat.av_read_pause(m_pFormatContext);
+  }
+  else if(m_speed == DVD_PLAYSPEED_PAUSE && iSpeed != DVD_PLAYSPEED_PAUSE)
+  {
+    m_pInput->Pause((double)m_iCurrentPts);
+    m_dllAvFormat.av_read_play(m_pFormatContext);
+  }
+  m_speed = iSpeed;
+
+  AVDiscard discard = AVDISCARD_NONE;
+  if(m_speed > 4*DVD_PLAYSPEED_NORMAL)
+    discard = AVDISCARD_NONKEY;
+  else if(m_speed > 2*DVD_PLAYSPEED_NORMAL)
+    discard = AVDISCARD_BIDIR;
+  else if(m_speed < DVD_PLAYSPEED_PAUSE)
+    discard = AVDISCARD_NONKEY;
+
+
+  for(unsigned int i = 0; i < m_pFormatContext->nb_streams; i++)
+  {
+    if(m_pFormatContext->streams[i])
+    {
+      if(m_pFormatContext->streams[i]->discard != AVDISCARD_ALL)
+        m_pFormatContext->streams[i]->discard = discard;
+    }
+  }
+}
+
+double CDVDDemuxFFmpeg::ConvertTimestamp(int64_t pts, int den, int num)
+{
+  if (pts == (int64_t)AV_NOPTS_VALUE)
+    return DVD_NOPTS_VALUE;
+
+  // do calculations in floats as they can easily overflow otherwise
+  // we don't care for having a completly exact timestamp anyway
+  double timestamp = (double)pts * num  / den;
+  double starttime = 0.0f;
+
+  if (m_pFormatContext->start_time != (int64_t)AV_NOPTS_VALUE)
+    starttime = (double)m_pFormatContext->start_time / AV_TIME_BASE;
+
+  if(timestamp > starttime)
+    timestamp -= starttime;
+  else if( timestamp + 0.1f > starttime )
+    timestamp = 0;
+
+  return timestamp*DVD_TIME_BASE;
+}
+
+DemuxPacket* CDVDDemuxFFmpeg::Read()
+{
+  g_demuxer = this;
+
+  AVPacket pkt;
+  DemuxPacket* pPacket = NULL;
+  // on some cases where the received packet is invalid we will need to return an empty packet (0 length) otherwise the main loop (in CDVDPlayer)
+  // would consider this the end of stream and stop.
+  bool bReturnEmpty = false;
+  Lock();
+  if (m_pFormatContext)
+  {
+    // assume we are not eof
+    if(m_pFormatContext->pb)
+      m_pFormatContext->pb->eof_reached = 0;
+
+    // keep track if ffmpeg doesn't always set these
+    pkt.size = 0;
+    pkt.data = NULL;
+    pkt.stream_index = MAX_STREAMS;
+
+    // timeout reads after 100ms
+    m_timeout = CTimeUtils::GetTimeMS() + 20000;
+    int result = 0;
+    try
+    {
+      result = m_dllAvFormat.av_read_frame(m_pFormatContext, &pkt);
+    }
+    catch(const win32_exception &e)
+    {
+      e.writelog(__FUNCTION__);
+      result = AVERROR(EFAULT);
+    }
+    m_timeout = 0;
+
+    if (result == AVERROR(EINTR) || result == AVERROR(EAGAIN))
+    {
+      // timeout, probably no real error, return empty packet
+      bReturnEmpty = true;
+    }
+    else if (result < 0)
+    {
+      Flush();
+    }
+    else if (pkt.size < 0 || pkt.stream_index >= MAX_STREAMS)
+    {
+      // XXX, in some cases ffmpeg returns a negative packet size
+      if(m_pFormatContext->pb && !m_pFormatContext->pb->eof_reached)
+      {
+        CLog::Log(LOGERROR, "CDVDDemuxFFmpeg::Read() no valid packet");
+        bReturnEmpty = true;
+        Flush();
+      }
+      else
+        CLog::Log(LOGERROR, "CDVDDemuxFFmpeg::Read() returned invalid packet and eof reached");
+
+      m_dllAvCodec.av_free_packet(&pkt);
+    }
+    else
+    {
+      AVStream *stream = m_pFormatContext->streams[pkt.stream_index];
+
+      if (m_pFormatContext->nb_programs)
+      {
+        /* check so packet belongs to selected program */
+        for (unsigned int i = 0; i < m_pFormatContext->programs[m_program]->nb_stream_indexes; i++)
+        {
+          if(pkt.stream_index == (int)m_pFormatContext->programs[m_program]->stream_index[i])
+          {
+            pPacket = CDVDDemuxUtils::AllocateDemuxPacket(pkt.size);
+            break;
+          }
+        }
+
+        if (!pPacket)
+          bReturnEmpty = true;
+      }
+      else
+        pPacket = CDVDDemuxUtils::AllocateDemuxPacket(pkt.size);
+
+      if (pPacket)
+      {
+        // lavf sometimes bugs out and gives 0 dts/pts instead of no dts/pts
+        // since this could only happens on initial frame under normal
+        // circomstances, let's assume it is wrong all the time
+        if(pkt.dts == 0)
+          pkt.dts = AV_NOPTS_VALUE;
+        if(pkt.pts == 0)
+          pkt.pts = AV_NOPTS_VALUE;
+
+        if(m_bMatroska && stream->codec && stream->codec->codec_type == CODEC_TYPE_VIDEO)
+        { // matroska can store different timestamps
+          // for different formats, for native stored
+          // stuff it is pts, but for ms compatibility
+          // tracks, it is really dts. sadly ffmpeg
+          // sets these two timestamps equal all the
+          // time, so we select it here instead
+          if(stream->codec->codec_tag == 0)
+            pkt.dts = AV_NOPTS_VALUE;
+          else
+            pkt.pts = AV_NOPTS_VALUE;
+        }
+
+        // we need to get duration slightly different for matroska embedded text subtitels
+        if(m_bMatroska && stream->codec->codec_id == CODEC_ID_TEXT && pkt.convergence_duration != 0)
+            pkt.duration = pkt.convergence_duration;
+
+        // copy contents into our own packet
+        pPacket->iSize = pkt.size;
+
+        // maybe we can avoid a memcpy here by detecting where pkt.destruct is pointing too?
+        if (pkt.data)
+          memcpy(pPacket->pData, pkt.data, pPacket->iSize);
+
+        pPacket->pts = ConvertTimestamp(pkt.pts, stream->time_base.den, stream->time_base.num);
+        pPacket->dts = ConvertTimestamp(pkt.dts, stream->time_base.den, stream->time_base.num);
+        pPacket->duration =  DVD_SEC_TO_TIME((double)pkt.duration * stream->time_base.num / stream->time_base.den);
+
+        // used to guess streamlength
+        if (pPacket->dts != DVD_NOPTS_VALUE && (pPacket->dts > m_iCurrentPts || m_iCurrentPts == DVD_NOPTS_VALUE))
+          m_iCurrentPts = pPacket->dts;
+
+
+        // check if stream has passed full duration, needed for live streams
+        if(pkt.dts != (int64_t)AV_NOPTS_VALUE)
+        {
+            int64_t duration;
+            duration = pkt.dts;
+            if(stream->start_time != (int64_t)AV_NOPTS_VALUE)
+              duration -= stream->start_time;
+
+            if(duration > stream->duration)
+            {
+              stream->duration = duration;
+              duration = m_dllAvUtil.av_rescale_rnd(stream->duration, stream->time_base.num * AV_TIME_BASE, stream->time_base.den, AV_ROUND_NEAR_INF);
+              if ((m_pFormatContext->duration == (int64_t)AV_NOPTS_VALUE && m_pFormatContext->file_size > 0)
+              ||  (m_pFormatContext->duration != (int64_t)AV_NOPTS_VALUE && duration > m_pFormatContext->duration))
+                m_pFormatContext->duration = duration;
+            }
+        }
+
+        // check if stream seem to have grown since start
+        if(m_pFormatContext->file_size > 0 && m_pFormatContext->pb)
+        {
+          if(m_pFormatContext->pb->pos > m_pFormatContext->file_size)
+            m_pFormatContext->file_size = m_pFormatContext->pb->pos;
+        }
+
+        pPacket->iStreamId = pkt.stream_index; // XXX just for now
+      }
+      m_dllAvCodec.av_free_packet(&pkt);
+    }
+  }
+  Unlock();
+
+  if (bReturnEmpty && !pPacket)
+    pPacket = CDVDDemuxUtils::AllocateDemuxPacket(0);
+
+  if (!pPacket) return NULL;
+
+  // check streams, can we make this a bit more simple?
+  if (pPacket && pPacket->iStreamId >= 0 && pPacket->iStreamId <= MAX_STREAMS)
+  {
+    if (!m_streams[pPacket->iStreamId] ||
+        m_streams[pPacket->iStreamId]->pPrivate != m_pFormatContext->streams[pPacket->iStreamId] ||
+        m_streams[pPacket->iStreamId]->codec != m_pFormatContext->streams[pPacket->iStreamId]->codec->codec_id)
+    {
+      // content has changed, or stream did not yet exist
+      AddStream(pPacket->iStreamId);
+    }
+    // we already check for a valid m_streams[pPacket->iStreamId] above
+    else if (m_streams[pPacket->iStreamId]->type == STREAM_AUDIO)
+    {
+      if (((CDemuxStreamAudio*)m_streams[pPacket->iStreamId])->iChannels != m_pFormatContext->streams[pPacket->iStreamId]->codec->channels ||
+          ((CDemuxStreamAudio*)m_streams[pPacket->iStreamId])->iSampleRate != m_pFormatContext->streams[pPacket->iStreamId]->codec->sample_rate)
+      {
+        // content has changed
+        AddStream(pPacket->iStreamId);
+      }
+    }
+    else if (m_streams[pPacket->iStreamId]->type == STREAM_VIDEO)
+    {
+      if (((CDemuxStreamVideo*)m_streams[pPacket->iStreamId])->iWidth != m_pFormatContext->streams[pPacket->iStreamId]->codec->width ||
+          ((CDemuxStreamVideo*)m_streams[pPacket->iStreamId])->iHeight != m_pFormatContext->streams[pPacket->iStreamId]->codec->height)
+      {
+        // content has changed
+        AddStream(pPacket->iStreamId);
+      }
+    }
+  }
+  return pPacket;
+}
+
+bool CDVDDemuxFFmpeg::SeekTime(int time, bool backwords, double *startpts)
+{
+  g_demuxer = this;
+
+  if(time < 0)
+    time = 0;
+
+  if (m_pInput->IsStreamType(DVDSTREAM_TYPE_DVD))
+  {
+    CLog::Log(LOGDEBUG, "%s - seeking using navigator", __FUNCTION__);
+    if (!((CDVDInputStreamNavigator*)m_pInput)->SeekTime(time))
+      return false;
+
+    if(startpts)
+      *startpts = DVD_NOPTS_VALUE;
+
+    Flush();
+    return true;
+  }
+
+#ifdef HAS_FILESYSTEM_MMS
+  if (m_pInput->IsStreamType(DVDSTREAM_TYPE_MMS))
+  {
+    if (!((CDVDInputStreamMMS*)m_pInput)->SeekTime(time))
+      return false;
+
+    Flush();
+    return true;
+  }
+#endif
+
+  if (m_pInput->IsStreamType(DVDSTREAM_TYPE_RTMP))
+  {
+    if (!((CDVDInputStreamRTMP*)m_pInput)->SeekTime(time))
+      return false;
+
+    Flush();
+    return true;
+  }
+
+  if(!m_pInput->Seek(0, SEEK_POSSIBLE)
+  && !m_pInput->IsStreamType(DVDSTREAM_TYPE_FFMPEG))
+  {
+    CLog::Log(LOGDEBUG, "%s - input stream reports it is not seekable", __FUNCTION__);
+    return false;
+  }
+
+  __int64 seek_pts = (__int64)time * (AV_TIME_BASE / 1000);
+  if (m_pFormatContext->start_time != (int64_t)AV_NOPTS_VALUE)
+    seek_pts += m_pFormatContext->start_time;
+
+  Lock();
+  int ret = m_dllAvFormat.av_seek_frame(m_pFormatContext, -1, seek_pts, backwords ? AVSEEK_FLAG_BACKWARD : 0);
+
+  if(ret >= 0)
+    UpdateCurrentPTS();
+  Unlock();
+
+  if(m_iCurrentPts == DVD_NOPTS_VALUE)
+    CLog::Log(LOGDEBUG, "%s - unknown position after seek", __FUNCTION__);
+  else
+    CLog::Log(LOGDEBUG, "%s - seek ended up on time %d", __FUNCTION__, (int)(m_iCurrentPts / DVD_TIME_BASE * 1000));
+
+  // in this case the start time is requested time
+  if(startpts)
+    *startpts = DVD_MSEC_TO_TIME(time);
+
+  // demuxer will return failure, if you seek to eof
+  if (m_pInput->IsEOF() && ret <= 0)
+    return true;
+
+  return (ret >= 0);
+}
+
+bool CDVDDemuxFFmpeg::SeekByte(__int64 pos)
+{
+  g_demuxer = this;
+
+  Lock();
+  int ret = m_dllAvFormat.av_seek_frame(m_pFormatContext, -1, pos, AVSEEK_FLAG_BYTE);
+
+  if(ret >= 0)
+    UpdateCurrentPTS();
+
+  Unlock();
+  return (ret >= 0);
+}
+
+void CDVDDemuxFFmpeg::UpdateCurrentPTS()
+{
+  m_iCurrentPts = DVD_NOPTS_VALUE;
+  for(unsigned int i = 0; i < m_pFormatContext->nb_streams; i++)
+  {
+    AVStream *stream = m_pFormatContext->streams[i];
+    if(stream && stream->cur_dts != (int64_t)AV_NOPTS_VALUE)
+    {
+      double ts = ConvertTimestamp(stream->cur_dts, stream->time_base.den, stream->time_base.num);
+      if(m_iCurrentPts == DVD_NOPTS_VALUE || m_iCurrentPts > ts )
+        m_iCurrentPts = ts;
+    }
+  }
+}
+
+int CDVDDemuxFFmpeg::GetStreamLength()
+{
+  if (!m_pFormatContext)
+    return 0;
+
+  /* apperently ffmpeg messes up sometimes, so check for negative value too */
+  if (m_pFormatContext->duration == (int64_t)AV_NOPTS_VALUE || m_pFormatContext->duration < 0LL)
+  {
+    // no duration is available for us
+    // try to calculate it
+    int iLength = 0;
+    if (m_iCurrentPts != DVD_NOPTS_VALUE && m_pFormatContext->file_size > 0 && m_pFormatContext->pb && m_pFormatContext->pb->pos > 0)
+    {
+      iLength = (int)(((m_iCurrentPts * m_pFormatContext->file_size) / m_pFormatContext->pb->pos) / 1000) & 0xFFFFFFFF;
+    }
+    return iLength;
+  }
+
+  return (int)(m_pFormatContext->duration / (AV_TIME_BASE / 1000));
+}
+
+CDemuxStream* CDVDDemuxFFmpeg::GetStream(int iStreamId)
+{
+  if (iStreamId < 0 || iStreamId >= MAX_STREAMS) return NULL;
+  return m_streams[iStreamId];
+}
+
+int CDVDDemuxFFmpeg::GetNrOfStreams()
+{
+  int i = 0;
+  while (i < MAX_STREAMS && m_streams[i]) i++;
+  return i;
+}
+
+void CDVDDemuxFFmpeg::AddStream(int iId)
+{
+  AVStream* pStream = m_pFormatContext->streams[iId];
+  if (pStream)
+  {
+    if (m_streams[iId])
+    {
+      if( m_streams[iId]->ExtraData ) delete[] (BYTE*)(m_streams[iId]->ExtraData);
+      delete m_streams[iId];
+    }
+
+    switch (pStream->codec->codec_type)
+    {
+    case CODEC_TYPE_AUDIO:
+      {
+        CDemuxStreamAudioFFmpeg* st = new CDemuxStreamAudioFFmpeg(this, pStream);
+        m_streams[iId] = st;
+        st->iChannels = pStream->codec->channels;
+        st->iSampleRate = pStream->codec->sample_rate;
+        st->iBlockAlign = pStream->codec->block_align;
+        st->iBitRate = pStream->codec->bit_rate;
+        st->iBitsPerSample = pStream->codec->bits_per_coded_sample;
+
+        if(m_bMatroska && m_dllAvFormat.av_metadata_get(pStream->metadata, "description", NULL, 0))
+          st->m_description = m_dllAvFormat.av_metadata_get(pStream->metadata, "description", NULL, 0)->value;
+
+        break;
+      }
+    case CODEC_TYPE_VIDEO:
+      {
+        CDemuxStreamVideoFFmpeg* st = new CDemuxStreamVideoFFmpeg(this, pStream);
+        m_streams[iId] = st;
+        if(strcmp(m_pFormatContext->iformat->name, "flv") == 0)
+          st->bVFR = true;
+        else
+          st->bVFR = false;
+
+        if(pStream->r_frame_rate.den && pStream->r_frame_rate.num)
+        {
+          st->iFpsRate = pStream->r_frame_rate.num;
+          st->iFpsScale = pStream->r_frame_rate.den;
+        }
+        else
+        {
+          st->iFpsRate  = 0;
+          st->iFpsScale = 0;
+        }
+        st->iWidth = pStream->codec->width;
+        st->iHeight = pStream->codec->height;
+        if (pStream->sample_aspect_ratio.num == 0)
+          st->fAspect = 0.0;
+        else
+          st->fAspect = av_q2d(pStream->sample_aspect_ratio) * pStream->codec->width / pStream->codec->height;
+
+        break;
+      }
+    case CODEC_TYPE_DATA:
+      {
+        m_streams[iId] = new CDemuxStream();
+        m_streams[iId]->type = STREAM_DATA;
+        break;
+      }
+    case CODEC_TYPE_SUBTITLE:
+      {
+#if LIBAVCODEC_VERSION_INT >= AV_VERSION_INT(52,38,1)
+        if (pStream->codec->codec_id == CODEC_ID_DVB_TELETEXT && g_guiSettings.GetBool("videoplayer.teletextenabled"))
+        {
+          CDemuxStreamTeletext* st = new CDemuxStreamTeletext();
+          m_streams[iId] = st;
+          m_streams[iId]->type = STREAM_TELETEXT;
+          break;
+        }
+        else
+#endif
+        {
+          CDemuxStreamSubtitleFFmpeg* st = new CDemuxStreamSubtitleFFmpeg(this, pStream);
+          m_streams[iId] = st;
+          if(pStream->codec)
+            st->identifier = pStream->codec->sub_id;
+
+          if(m_bMatroska && m_dllAvFormat.av_metadata_get(pStream->metadata, "description", NULL, 0))
+            st->m_description = m_dllAvFormat.av_metadata_get(pStream->metadata, "description", NULL, 0)->value;
+
+          break;
+        }
+      }
+    case CODEC_TYPE_ATTACHMENT:
+      { //mkv attachments. Only bothering with fonts for now.
+        if(pStream->codec->codec_id == CODEC_ID_TTF)
+        {
+          std::string fileName = "special://temp/fonts/";
+          XFILE::CDirectory::Create(fileName);
+          fileName += pStream->filename;
+          XFILE::CFile file;
+          if(pStream->codec->extradata && file.OpenForWrite(fileName))
+          {
+            file.Write(pStream->codec->extradata, pStream->codec->extradata_size);
+            file.Close();
+          }
+        }
+        m_streams[iId] = new CDemuxStream();
+        m_streams[iId]->type = STREAM_NONE;
+        break;
+      }
+    default:
+      {
+        m_streams[iId] = new CDemuxStream();
+        m_streams[iId]->type = STREAM_NONE;
+        break;
+      }
+    }
+
+    // generic stuff
+    if (pStream->duration != (int64_t)AV_NOPTS_VALUE) m_streams[iId]->iDuration = (int)((pStream->duration / AV_TIME_BASE) & 0xFFFFFFFF);
+
+    m_streams[iId]->codec = pStream->codec->codec_id;
+    m_streams[iId]->codec_fourcc = pStream->codec->codec_tag;
+    m_streams[iId]->iId = iId;
+    m_streams[iId]->source = STREAM_SOURCE_DEMUX;
+    m_streams[iId]->pPrivate = pStream;
+
+    strcpy( m_streams[iId]->language, pStream->language );
+
+    if( pStream->codec->extradata && pStream->codec->extradata_size > 0 )
+    {
+      m_streams[iId]->ExtraSize = pStream->codec->extradata_size;
+      m_streams[iId]->ExtraData = new BYTE[pStream->codec->extradata_size];
+      memcpy(m_streams[iId]->ExtraData, pStream->codec->extradata, pStream->codec->extradata_size);
+    }
+
+    //FFMPEG has an error doesn't set type properly for DTS
+    if( m_streams[iId]->codec == CODEC_ID_AC3 && (pStream->id >= 136 && pStream->id <= 143) )
+      m_streams[iId]->codec = CODEC_ID_DTS;
+
+    if( m_pInput->IsStreamType(DVDSTREAM_TYPE_DVD) )
+    {
+      // this stuff is really only valid for dvd's.
+      // this is so that the physicalid matches the
+      // id's reported from libdvdnav
+      switch(m_streams[iId]->codec)
+      {
+        case CODEC_ID_AC3:
+          m_streams[iId]->iPhysicalId = pStream->id - 128;
+          break;
+        case CODEC_ID_DTS:
+          m_streams[iId]->iPhysicalId = pStream->id - 136;
+          break;
+        case CODEC_ID_MP2:
+          m_streams[iId]->iPhysicalId = pStream->id - 448;
+          break;
+        case CODEC_ID_PCM_S16BE:
+          m_streams[iId]->iPhysicalId = pStream->id - 160;
+          break;
+        case CODEC_ID_DVD_SUBTITLE:
+          m_streams[iId]->iPhysicalId = pStream->id - 0x20;
+          break;
+        default:
+          m_streams[iId]->iPhysicalId = pStream->id & 0x1f;
+          break;
+      }
+    }
+    else
+      m_streams[iId]->iPhysicalId = pStream->id;
+  }
+}
+
+std::string CDVDDemuxFFmpeg::GetFileName()
+{
+  if(m_pInput && m_pInput)
+    return m_pInput->GetFileName();
+  else
+    return "";
+}
+
+int CDVDDemuxFFmpeg::GetChapterCount()
+{
+  if(m_pInput && m_pInput->IsStreamType(DVDSTREAM_TYPE_DVD))
+    return ((CDVDInputStreamNavigator*)m_pInput)->GetChapterCount();
+
+  if(m_pFormatContext == NULL)
+    return 0;
+  #if (LIBAVFORMAT_VERSION_MAJOR == 52) && (LIBAVFORMAT_VERSION_MINOR >= 14)
+    return m_pFormatContext->nb_chapters;
+  #else
+    return 0;
+  #endif
+}
+
+int CDVDDemuxFFmpeg::GetChapter()
+{
+  if(m_pInput && m_pInput->IsStreamType(DVDSTREAM_TYPE_DVD))
+    return ((CDVDInputStreamNavigator*)m_pInput)->GetChapter();
+
+  if(m_pFormatContext == NULL
+  || m_iCurrentPts == DVD_NOPTS_VALUE)
+    return 0;
+
+  #if (LIBAVFORMAT_VERSION_MAJOR == 52) && (LIBAVFORMAT_VERSION_MINOR >= 14)
+    for(unsigned i = 0; i < m_pFormatContext->nb_chapters; i++)
+    {
+      AVChapter *chapter = m_pFormatContext->chapters[i];
+      if(m_iCurrentPts >= ConvertTimestamp(chapter->start, chapter->time_base.den, chapter->time_base.num)
+      && m_iCurrentPts <  ConvertTimestamp(chapter->end,   chapter->time_base.den, chapter->time_base.num))
+        return i + 1;
+    }
+  #endif
+  return 0;
+}
+
+void CDVDDemuxFFmpeg::GetChapterName(std::string& strChapterName)
+{
+  if(m_pInput && m_pInput->IsStreamType(DVDSTREAM_TYPE_DVD))
+    return;
+  else
+  {
+    #if (LIBAVFORMAT_VERSION_MAJOR == 52) && (LIBAVFORMAT_VERSION_MINOR >= 14)
+      int chapterIdx = GetChapter();
+      if(chapterIdx > 0 && m_pFormatContext->chapters[chapterIdx-1]->title)
+        strChapterName = m_pFormatContext->chapters[chapterIdx-1]->title;
+    #endif
+  }
+}
+
+bool CDVDDemuxFFmpeg::SeekChapter(int chapter, double* startpts)
+{
+  if(chapter < 1)
+    chapter = 1;
+
+  if(m_pInput && m_pInput->IsStreamType(DVDSTREAM_TYPE_DVD))
+  {
+    CLog::Log(LOGDEBUG, "%s - chapter seeking using navigator", __FUNCTION__);
+    if(!((CDVDInputStreamNavigator*)m_pInput)->SeekChapter(chapter))
+      return false;
+
+    if(startpts)
+      *startpts = DVD_NOPTS_VALUE;
+
+    Flush();
+    return true;
+  }
+
+  if(m_pFormatContext == NULL)
+    return false;
+
+    #if (LIBAVFORMAT_VERSION_MAJOR == 52) && (LIBAVFORMAT_VERSION_MINOR >= 14)
+        if(chapter < 1 || chapter > (int)m_pFormatContext->nb_chapters)
+            return false;
+
+        AVChapter *ch = m_pFormatContext->chapters[chapter-1];
+        double dts = ConvertTimestamp(ch->start, ch->time_base.den, ch->time_base.num);
+        return SeekTime(DVD_TIME_TO_MSEC(dts), false, startpts);
+    #else
+        return false;
+    #endif
+}
+
+void CDVDDemuxFFmpeg::GetStreamCodecName(int iStreamId, CStdString &strName)
+{
+  CDemuxStream *stream = GetStream(iStreamId);
+  if (stream)
+  {
+    unsigned int in = stream->codec_fourcc;
+    // FourCC codes are only valid on video streams, audio codecs in AVI/WAV
+    // are 2 bytes and audio codecs in transport streams have subtle variation
+    // e.g AC-3 instead of ac3
+    if (stream->type == STREAM_VIDEO && in != 0)
+    {
+      char fourcc[5];
+#if defined(__powerpc__)
+      fourcc[0] = in & 0xff;
+      fourcc[1] = (in >> 8) & 0xff;
+      fourcc[2] = (in >> 16) & 0xff;
+      fourcc[3] = (in >> 24) & 0xff;
+#else
+      memcpy(fourcc, &in, 4);
+#endif
+      fourcc[4] = 0;
+      // fourccs have to be 4 characters
+      if (strlen(fourcc) == 4)
+      {
+        strName = fourcc;
+        strName.MakeLower();
+        return;
+      }
+    }
+
+    if (m_dllAvCodec.IsLoaded())
+    {
+      AVCodec *codec = m_dllAvCodec.avcodec_find_decoder(stream->codec);
+      if (codec)
+        strName = codec->name;
+    }
+  }
+}
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDPlayerAudio.cpp xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDPlayerAudio.cpp
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDPlayerAudio.cpp	2010-02-08 18:53:24.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDPlayerAudio.cpp	2010-02-09 07:32:53.966806838 +0100
@@ -356,7 +356,7 @@
     if (m_messageQueue.ReceivedAbortRequest()) return DECODE_FLAG_ABORT;
 
     CDVDMsg* pMsg;
-    int priority = (m_speed == DVD_PLAYSPEED_PAUSE) && m_started ? 1 : 0;
+    int priority = (m_speed == DVD_PLAYSPEED_PAUSE && m_started) ? 1 : 0;
 
     int timeout;
     if(m_duration > 0)
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDPlayerVideo.cpp xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDPlayerVideo.cpp
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDPlayerVideo.cpp	2010-02-08 18:53:24.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDPlayerVideo.cpp	2010-02-09 07:33:01.060899554 +0100
@@ -158,15 +158,9 @@
 {
 
   if (hint.fpsrate && hint.fpsscale)
-  {
     m_fFrameRate = (float)hint.fpsrate / hint.fpsscale;
-    m_autosync = 10;
-  }
   else
-  {
     m_fFrameRate = 25;
-    m_autosync = 1; // avoid using frame time as we don't know it accurate
-  }
 
   //if adjust refreshrate is used, or if sync playback to display is on,
   //we try to calculate the framerate from the pts', because the codec fps
@@ -182,15 +176,12 @@
 
   m_iDroppedRequest = 0;
   m_iLateFrames = 0;
-
-  if (hint.vfr)
-    m_autosync = 1;
+  m_autosync = 1;
 
   if( m_fFrameRate > 100 || m_fFrameRate < 5 )
   {
     CLog::Log(LOGERROR, "CDVDPlayerVideo::OpenStream - Invalid framerate %d, using forced 25fps and just trust timestamps", (int)m_fFrameRate);
     m_fFrameRate = 25;
-    m_autosync = 1; // avoid using frame time as we don't know it accurate
   }
 
   // use aspect in stream if available
@@ -570,13 +561,6 @@
               if(mDeinterlace.Process(&picture))
                 mDeinterlace.GetPicture(&picture);
             }
-            else if( mInt == VS_INTERLACEMETHOD_RENDER_WEAVE
-                  || mInt == VS_INTERLACEMETHOD_RENDER_WEAVE_INVERTED )
-            {
-              /* if we are syncing frames, dvdplayer will be forced to play at a given framerate */
-              /* unless we directly sync to the correct pts, we won't get a/v sync as video can never catch up */
-              picture.iFlags |= DVP_FLAG_NOAUTOSYNC;
-            }
 
             /* if frame has a pts (usually originiating from demux packet), use that */
             if(picture.pts != DVD_NOPTS_VALUE)
@@ -1025,17 +1009,9 @@
   iFrameSleep = min(iFrameSleep, DVD_MSEC_TO_TIME(500));
 
   if( m_stalled )
-  { // when we render a still, we can't sync to clock anyway
     iSleepTime = iFrameSleep;
-  }
   else
-  {
-    // try to decide on how to sync framerate
-    if( pPicture->iFlags & DVP_FLAG_NOAUTOSYNC )
-      iSleepTime = iClockSleep;
-    else
-      iSleepTime = iFrameSleep + (iClockSleep - iFrameSleep) / m_autosync;
-  }
+    iSleepTime = iFrameSleep + (iClockSleep - iFrameSleep) / m_autosync;
 
 #ifdef PROFILE /* during profiling, try to play as fast as possible */
   iSleepTime = 0;
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleLineCollection.cpp xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleLineCollection.cpp
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleLineCollection.cpp	2010-01-14 06:15:47.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleLineCollection.cpp	2010-02-09 07:31:57.962897211 +0100
@@ -58,6 +58,25 @@
   m_iSize++;
 }
 
+void CDVDSubtitleLineCollection::Sort()
+{
+  if (!m_pHead || !m_pHead->pNext)
+    return;
+  
+  for (ListElement* p1 = m_pHead; p1->pNext->pNext != NULL; p1 = p1->pNext)
+  {
+    for (ListElement* p2 = p1->pNext; p2->pNext != NULL; p2 = p2->pNext)
+    {
+      if (p1->pOverlay->iPTSStartTime > p2->pOverlay->iPTSStartTime)
+      {
+        CDVDOverlay* temp = p1->pOverlay;
+        p1->pOverlay = p2->pOverlay;
+        p2->pOverlay = temp;
+      }
+    }
+  }
+}
+
 CDVDOverlay* CDVDSubtitleLineCollection::Get(double iPts)
 {
   CDVDOverlay* pOverlay = NULL;
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleLineCollection.h xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleLineCollection.h
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleLineCollection.h	2010-01-14 06:15:47.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleLineCollection.h	2010-02-09 07:31:57.962897211 +0100
@@ -40,6 +40,7 @@
   //void Unlock() { LeaveCriticalSection(&m_critSection); }
 
   void Add(CDVDOverlay* pSubtitle);
+  void Sort();
 
   CDVDOverlay* Get(double iPts = 0LL); // get the first overlay in this fifo
 
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSami.cpp xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSami.cpp
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSami.cpp	2010-01-14 06:15:47.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSami.cpp	2010-02-09 07:31:57.963904804 +0100
@@ -82,7 +82,7 @@
     if(pOverlay)
       TagConv.ConvertLine(pOverlay, text, strlen(text));
   }
-
+  m_collection.Sort();
   return true;
 }
 
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSSA.cpp xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSSA.cpp
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSSA.cpp	2010-01-14 06:15:47.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSSA.cpp	2010-02-09 07:31:57.963904804 +0100
@@ -64,6 +64,7 @@
       m_collection.Add(overlay);
     }
   }
+  m_collection.Sort();
   return true;
 }
 
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSubrip.cpp xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSubrip.cpp
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSubrip.cpp	2010-01-14 06:15:47.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDSubtitles/DVDSubtitleParserSubrip.cpp	2010-02-09 07:31:57.964897381 +0100
@@ -98,7 +98,7 @@
       }
     }
   }
-
+  m_collection.Sort();
   return true;
 }
 
diff -Naur xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDTSCorrection.cpp xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDTSCorrection.cpp
--- xbmc-pvr-27594.orig/xbmc/cores/dvdplayer/DVDTSCorrection.cpp	2010-01-14 06:16:15.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/cores/dvdplayer/DVDTSCorrection.cpp	2010-02-09 07:33:15.293899500 +0100
@@ -77,6 +77,9 @@
   if (!CheckPattern(pattern))
   {
     m_ptscorrection = 0.0; //no pattern no correction
+    m_pattern = pattern;   //save the current pattern
+    m_patternpos = 0;      //reset the position
+
     if (m_haspattern)
     {
       m_haspattern = false;
@@ -232,11 +235,7 @@
 {
   //if no pattern was detected or if the size of the patterns differ we don't have a match
   if (pattern.size() != m_pattern.size() || pattern.size() < 1 || (pattern.size() == 1 && pattern[0] <= MAXERR))
-  {
-    m_pattern = pattern; //save the current pattern
-    m_patternpos = 0;    //reset the position
     return false;
-  }
 
   //the saved pattern should have moved 1 diff into the past
   m_patternpos = (m_patternpos + 1) % m_pattern.size();
@@ -247,15 +246,13 @@
     double diff = pattern[(m_patternpos + i) % pattern.size()];
 
     if (!MatchDiff(diff, m_pattern[i]))
-    {
-      m_pattern = pattern; //save the current pattern
-      m_patternpos = 0;    //reset the position
       return false;
-    }
-    //we save the pattern, in case it changes very slowly
-    m_pattern[i] = diff;
   }
 
+  //we save the pattern, in case it changes very slowly
+  for (unsigned int i = 0; i < m_pattern.size(); i++)
+    m_pattern[i] = pattern[(m_patternpos + i) % pattern.size()];
+
   return true;
 }
 
diff -Naur xbmc-pvr-27594.orig/xbmc/GUIWindowMusicBase.cpp xbmc-pvr-27594.patch/xbmc/GUIWindowMusicBase.cpp
--- xbmc-pvr-27594.orig/xbmc/GUIWindowMusicBase.cpp	2010-02-08 18:53:42.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/GUIWindowMusicBase.cpp	2010-02-09 07:32:42.283806859 +0100
@@ -711,10 +711,7 @@
     FormatAndSort(items);
     SetupFanart(items);
     for (int i = 0; i < items.Size(); ++i)
-    {
-      m_musicdatabase.SetPropertiesForFileItem(*items[i]);
       AddItemToPlayList(items[i], queuedItems);
-    }
   }
   else
   {
@@ -752,7 +749,9 @@
       CFileItemPtr itemCheck = queuedItems.Get(pItem->m_strPath);
       if (!itemCheck || itemCheck->m_lStartOffset != pItem->m_lStartOffset)
       { // add item
-        queuedItems.Add(pItem);
+        CFileItemPtr item(new CFileItem(*pItem));
+        m_musicdatabase.SetPropertiesForFileItem(*item);
+        queuedItems.Add(item);
       }
     }
   }
diff -Naur xbmc-pvr-27594.orig/xbmc/utils/Makefile xbmc-pvr-27594.patch/xbmc/utils/Makefile
--- xbmc-pvr-27594.orig/xbmc/utils/Makefile	2010-02-08 18:53:42.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/utils/Makefile	2010-02-09 07:31:57.964897381 +0100
@@ -73,7 +73,8 @@
      Semaphore.cpp \
      FileOperationJob.cpp \
      FileUtils.cpp \
-     Variant.cpp
+     Variant.cpp \
+     PCMLimiter.cpp
 
 LIB=utils.a
 
diff -Naur xbmc-pvr-27594.orig/xbmc/utils/PCMLimiter.cpp xbmc-pvr-27594.patch/xbmc/utils/PCMLimiter.cpp
--- xbmc-pvr-27594.orig/xbmc/utils/PCMLimiter.cpp	1970-01-01 01:00:00.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/utils/PCMLimiter.cpp	2010-02-09 07:31:57.965897221 +0100
@@ -0,0 +1,119 @@
+/*
+ *      Copyright (C) 2005-2008 Team XBMC
+ *      http://www.xbmc.org
+ *
+ *  This Program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2, or (at your option)
+ *  any later version.
+ *
+ *  This Program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ *  GNU General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with XBMC; see the file COPYING.  If not, write to
+ *  the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.
+ *  http://www.gnu.org/copyleft/gpl.html
+ *
+ */
+
+//based on the fast lookahead limiter from http://plugin.org.uk/
+
+//original description:
+
+/*
+This is a limiter with an attack time of 5ms. It adds just over 5ms of
+lantecy to the input signal, but it guatantees that there will be no signals
+over the limit, and tries to get the minimum ammount of distortion.
+*/
+
+#include "system.h"
+#include "MathUtils.h"
+#include "PCMLimiter.h"
+
+CPCMLimiter::CPCMLimiter(int samplerate, int channels)
+{
+  //delay buffer of 5 milliseconds
+  m_delaybuffsize = MathUtils::round_int((double)samplerate * DELAYTIME);
+  m_channels      = channels;
+  m_samplerate    = samplerate; //save samplerate as float so we don't cast every sample
+  m_release       = 2.0; //default release time 2 seconds
+
+  m_delaybuff = new float[m_delaybuffsize * m_channels];
+  memset(m_delaybuff, 0, m_delaybuffsize * m_channels * sizeof(float));
+  m_delaybuffpos = 0;
+
+  m_chunknum = 0;
+  m_chunkpos = 0;
+  m_chunksize = m_delaybuffsize / 10; //chunk size of roughly 0.5 ms
+  memset(m_chunks, 0, sizeof(m_chunks));
+
+  m_peak    = 0.0f;
+  m_atten   = 1.0f;
+  m_attenlp = 1.0f;
+  m_delta   = 0.0f;
+}
+
+CPCMLimiter::~CPCMLimiter()
+{
+  delete [] m_delaybuff;
+}
+
+void CPCMLimiter::Run(float* insamples, float* outsamples, int frames)
+{
+  float* inptr = insamples;
+  float* outptr = outsamples;
+  float* delayptr;
+
+  for (int i = 0; i < frames; i++)
+  {
+    if (m_chunkpos++ == m_chunksize)
+    { //we have a full chunk, apparently the attenuation is calculated here
+      //I'm not completely sure what this does, it seems to base the attenuation on the rate of change
+      m_delta = (1.0f - m_atten) / (m_samplerate / m_release);
+      for (int j = 0; j < 10; j++)
+      {
+        int p = (m_chunknum - 9 + j) & (CHUNKS - 1);
+        float thisdelta = (1.0f / m_chunks[p] - m_atten) / ((float)(j + 1) * m_samplerate * (DELAYTIME / 10.0f) + 1.0f);
+        if (thisdelta < m_delta)
+          m_delta = thisdelta;
+      }
+      m_chunks[m_chunknum++ & (CHUNKS - 1)] = m_peak;
+      m_peak = 0.0f;
+      m_chunkpos = 0;
+    }
+
+    delayptr = m_delaybuff + m_delaybuffpos * m_channels;
+
+    for (int j = 0; j < m_channels; j++)
+    {
+      //store input at the beginning of the delay buffer
+      delayptr[j] = *inptr++;
+
+      //get the maximum absolute value of all the channels
+      if (fabs(delayptr[j]) > m_peak)
+        m_peak = fabs(delayptr[j]);
+    }
+
+    //calculate attenuation
+    m_atten += m_delta;
+    m_attenlp = m_atten * 0.1f + m_attenlp * 0.9f;
+
+    //not sure what this is for
+    if (m_delta > 0.0f && m_atten > 1.0f)
+    {
+      m_atten = 1.0f;
+      m_delta = 0.0;
+    }
+
+    //increase delaybuffer position
+    m_delaybuffpos = (m_delaybuffpos + 1) % m_delaybuffsize;
+
+    //write from the end of the delay buffer to the output with attenuation
+    for (int j = 0; j < m_channels; j++)
+      *outptr++ = delayptr[j] * m_attenlp;
+  }
+}
+
diff -Naur xbmc-pvr-27594.orig/xbmc/utils/PCMLimiter.h xbmc-pvr-27594.patch/xbmc/utils/PCMLimiter.h
--- xbmc-pvr-27594.orig/xbmc/utils/PCMLimiter.h	1970-01-01 01:00:00.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/utils/PCMLimiter.h	2010-02-09 07:31:57.966906769 +0100
@@ -0,0 +1,53 @@
+#pragma once
+/*
+ *      Copyright (C) 2005-2008 Team XBMC
+ *      http://www.xbmc.org
+ *
+ *  This Program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2, or (at your option)
+ *  any later version.
+ *
+ *  This Program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ *  GNU General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with XBMC; see the file COPYING.  If not, write to
+ *  the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.
+ *  http://www.gnu.org/copyleft/gpl.html
+ *
+ */
+
+#define CHUNKS 16
+#define DELAYTIME 0.005f
+
+class CPCMLimiter
+{
+  public:
+    CPCMLimiter(int samplerate, int channels);
+    ~CPCMLimiter();
+
+    void   Run(float* insamples, float* outsamples, int frames);
+    void   SetRelease(float release) { m_release = release; }
+    double GetDelay() { return DELAYTIME; }
+
+  private:
+    float* m_delaybuff;
+    int    m_delaybuffsize; //buffer size in frames
+    int    m_delaybuffpos;  //m_delaybuff is used as a ringbuffer
+    float  m_samplerate;
+    int    m_channels;
+    float  m_release; //release time in seconds
+
+    int    m_chunknum;
+    int    m_chunkpos;
+    int    m_chunksize;
+    float  m_chunks[CHUNKS];
+
+    float  m_peak;
+    float  m_atten;
+    float  m_attenlp;
+    float  m_delta;
+};
diff -Naur xbmc-pvr-27594.orig/xbmc/utils/PCMRemap.cpp xbmc-pvr-27594.patch/xbmc/utils/PCMRemap.cpp
--- xbmc-pvr-27594.orig/xbmc/utils/PCMRemap.cpp	2010-02-08 18:53:42.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/utils/PCMRemap.cpp	2010-02-09 07:32:57.658786358 +0100
@@ -48,42 +48,6 @@
   /* 7.1 */ {PCM_FRONT_LEFT, PCM_FRONT_RIGHT, PCM_FRONT_CENTER, PCM_SIDE_LEFT, PCM_SIDE_RIGHT, PCM_BACK_LEFT, PCM_BACK_RIGHT, PCM_LOW_FREQUENCY, PCM_INVALID}
 };
 
-static const char* PCMChannelName[PCM_MAX_CH] =
-{
-  "FL",
-  "FR",
-  "CE",
-  "LFE",
-  "BL",
-  "BR",
-  "FLOC",
-  "FROC",
-  "BC",
-  "SL",
-  "SR",
-  "TFL",
-  "TFR",
-  "TFC",
-  "TC",
-  "TBL",
-  "TBR",
-  "TBC",
-};
-
-static const char* PCMLayoutName[PCM_MAX_LAYOUT] =
-{
-  "2.0",
-  "2.1",
-  "3.0",
-  "3.1",
-  "4.0",
-  "4.1",
-  "5.0",
-  "5.1",
-  "7.0",
-  "7.1"
-};
-
 /*
   map missing output into channel @ volume level
   the order of this table is important, mix tables can not depend on channels that have not been defined yet
@@ -269,6 +233,8 @@
   if (!m_inSet || !m_outSet) return;
 
   unsigned int in_ch, out_ch;
+  bool hasSide = false;
+  bool hasBack = false;
 
   m_inStride  = m_inSampleSize * m_inChannels ;
   m_outStride = m_inSampleSize * m_outChannels;
@@ -285,6 +251,32 @@
       }
   }
 
+  /* see if our input has side/back channels */
+  for(in_ch = 0; in_ch < m_inChannels; ++in_ch)
+    switch(m_inMap[in_ch])
+    {
+      case PCM_SIDE_LEFT:
+      case PCM_SIDE_RIGHT:
+        hasSide = true;
+        break;
+
+      case PCM_BACK_LEFT:
+      case PCM_BACK_RIGHT:
+        hasBack = true;
+        break;
+
+      default:;
+    }
+
+  /* if our input has side, and not back channels, and our output doesnt have side channels */
+  if (hasSide && !hasBack && (!m_useable[PCM_SIDE_LEFT] || !m_useable[PCM_SIDE_RIGHT]))
+  {
+    CLog::Log(LOGDEBUG, "CPCMRemap: Forcing side channel map to back channels");
+    for(in_ch = 0; in_ch < m_inChannels; ++in_ch)
+           if (m_inMap[in_ch] == PCM_SIDE_LEFT ) m_inMap[in_ch] = PCM_BACK_LEFT;
+      else if (m_inMap[in_ch] == PCM_SIDE_RIGHT) m_inMap[in_ch] = PCM_BACK_RIGHT;   
+  }
+
   /* see if we need to normalize the levels */
   bool dontnormalize = g_guiSettings.GetBool("audiooutput.dontnormalizelevels");
   CLog::Log(LOGDEBUG, "CPCMRemap: Downmix normalization is %s", (dontnormalize ? "disabled" : "enabled"));
@@ -313,6 +305,9 @@
   }
 
   /* convert the levels into RMS values */
+  float loudest    = 0.0;
+  bool  hasLoudest = false;
+
   for(out_ch = 0; out_ch < m_outChannels; ++out_ch)
   {
     float scale = 0;
@@ -333,19 +328,33 @@
     /* normalize the levels if it is turned on */
     if (!dontnormalize)
       for(dst = m_lookupMap[m_outMap[out_ch]]; dst->channel != PCM_INVALID; ++dst)
+      {
         dst->level /= scale;
+        /* find the loudest output level we have that is not 1-1 */
+        if (dst->level < 1.0 && loudest < dst->level)
+        {
+          loudest    = dst->level;
+          hasLoudest = true;
+        }
+      }
   }
   
-  /* output the final map for debugging */
+  /* adjust the channels that are too loud */
   for(out_ch = 0; out_ch < m_outChannels; ++out_ch)
   {
     CStdString s = "", f;
     for(dst = m_lookupMap[m_outMap[out_ch]]; dst->channel != PCM_INVALID; ++dst)
     {
-      f.Format("%s(%f%s) ",  PCMChannelName[dst->channel], dst->level, dst->copy ? "*" : "");
+      if (hasLoudest && dst->copy)
+      {
+        dst->level = loudest;
+        dst->copy  = false;
+      }
+
+      f.Format("%s(%f%s) ",  PCMChannelStr(dst->channel).c_str(), dst->level, dst->copy ? "*" : "");
       s += f;
     }
-    CLog::Log(LOGDEBUG, "CPCMRemap: %s = %s\n", PCMChannelName[m_outMap[out_ch]], s.c_str());
+    CLog::Log(LOGDEBUG, "CPCMRemap: %s = %s\n", PCMChannelStr(m_outMap[out_ch]).c_str(), s.c_str());
   }
 }
 
@@ -357,17 +366,15 @@
     return;
   }
 
-  CStdString mapping = "";
+  CStdString mapping;
   for(unsigned int i = 0; i < channels; ++i)
-    mapping += ((i == 0) ? "" : ",") + (CStdString)PCMChannelName[channelMap[i]];
+    mapping += ((i == 0) ? "" : ",") + PCMChannelStr(channelMap[i]);
 
   CLog::Log(LOGINFO, "CPCMRemap: %s channel map: %s\n", info.c_str(), mapping.c_str());
 }
 
 void CPCMRemap::Reset()
 {
-  m_inMap  = NULL;
-  m_outMap = NULL;
   m_inSet  = false;
   m_outSet = false;
   Dispose();
@@ -377,9 +384,10 @@
 enum PCMChannels *CPCMRemap::SetInputFormat(unsigned int channels, enum PCMChannels *channelMap, unsigned int sampleSize)
 {
   m_inChannels   = channels;
-  m_inMap        = channelMap;
   m_inSampleSize = sampleSize;
   m_inSet        = channelMap != NULL;
+  if (channelMap)
+    memcpy(m_inMap, channelMap, sizeof(enum PCMChannels) * channels);
 
   /* fix me later */
   assert(sampleSize == 2);
@@ -388,7 +396,7 @@
   m_channelLayout  = (enum PCMLayout)g_guiSettings.GetInt("audiooutput.channellayout");
   if (m_channelLayout >= PCM_MAX_LAYOUT) m_channelLayout = PCM_LAYOUT_2_0;
 
-  CLog::Log(LOGINFO, "CPCMRemap: Channel Layout: %s\n", PCMLayoutName[m_channelLayout]);
+  CLog::Log(LOGINFO, "CPCMRemap: Channel Layout: %s\n", PCMLayoutStr(m_channelLayout).c_str());
   m_layoutMap      = PCMLayoutMap[m_channelLayout];
 
   DumpMap("I", channels, channelMap);
@@ -401,8 +409,9 @@
 void CPCMRemap::SetOutputFormat(unsigned int channels, enum PCMChannels *channelMap)
 {
   m_outChannels   = channels;
-  m_outMap        = channelMap;
   m_outSet        = channelMap != NULL;
+  if (channelMap)
+    memcpy(m_outMap, channelMap, sizeof(enum PCMChannels) * channels);
 
   DumpMap("O", channels, channelMap);
   BuildMap();
@@ -484,3 +493,79 @@
   return frames * m_inSampleSize * m_inChannels;
 }
 
+CStdString CPCMRemap::PCMChannelStr(enum PCMChannels ename)
+{
+  static const char* PCMChannelName[] =
+  {
+    "FL",
+    "FR",
+    "CE",
+    "LFE",
+    "BL",
+    "BR",
+    "FLOC",
+    "FROC",
+    "BC",
+    "SL",
+    "SR",
+    "TFL",
+    "TFR",
+    "TFC",
+    "TC",
+    "TBL",
+    "TBR",
+    "TBC",
+  };
+
+  int namepos = (int)ename;
+  CStdString namestr;
+
+  if (namepos < 0 || namepos >= (int)(sizeof(PCMChannelName) / sizeof(const char*)))
+  {
+    namestr.Format("UNKNOWN CHANNEL:%i", namepos);
+  }
+  else
+  {
+    if (PCMChannelName[namepos])
+      namestr = PCMChannelName[namepos];
+    else
+      namestr.Format("CHANNEL %i IS NULL", namepos);
+  }
+
+  return namestr;
+}
+
+CStdString CPCMRemap::PCMLayoutStr(enum PCMLayout ename)
+{
+  static const char* PCMLayoutName[] =
+  {
+    "2.0",
+    "2.1",
+    "3.0",
+    "3.1",
+    "4.0",
+    "4.1",
+    "5.0",
+    "5.1",
+    "7.0",
+    "7.1"
+  };
+
+  int namepos = (int)ename;
+  CStdString namestr;
+
+  if (namepos < 0 || namepos >= (int)(sizeof(PCMLayoutName) / sizeof(const char*)))
+  {
+    namestr.Format("UNKNOWN LAYOUT:%i", namepos);
+  }
+  else
+  {
+    if (PCMLayoutName[namepos])
+      namestr = PCMLayoutName[namepos];
+    else
+      namestr.Format("LAYOUT %i IS NULL", namepos);
+  }
+
+  return namestr;
+}
+
diff -Naur xbmc-pvr-27594.orig/xbmc/utils/PCMRemap.h xbmc-pvr-27594.patch/xbmc/utils/PCMRemap.h
--- xbmc-pvr-27594.orig/xbmc/utils/PCMRemap.h	2010-02-08 18:53:42.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/utils/PCMRemap.h	2010-02-09 07:32:57.656929012 +0100
@@ -81,7 +81,9 @@
   enum PCMLayout     m_channelLayout;
   unsigned int       m_inChannels, m_outChannels;
   unsigned int       m_inSampleSize;
-  enum PCMChannels  *m_inMap, *m_outMap, *m_layoutMap;
+  enum PCMChannels   m_inMap [PCM_MAX_CH];
+  enum PCMChannels   m_outMap[PCM_MAX_CH];
+  enum PCMChannels  *m_layoutMap;
 
   bool               m_useable  [PCM_MAX_CH];
   int                m_inStride, m_outStride;
@@ -91,6 +93,8 @@
   void               BuildMap();
   void               DumpMap(CStdString info, int unsigned channels, enum PCMChannels *channelMap);
   void               Dispose();
+  CStdString         PCMChannelStr(enum PCMChannels ename);
+  CStdString         PCMLayoutStr(enum PCMLayout ename);
 public:
 
   CPCMRemap();
diff -Naur xbmc-pvr-27594.orig/xbmc/utils/RingBuffer.cpp xbmc-pvr-27594.patch/xbmc/utils/RingBuffer.cpp
--- xbmc-pvr-27594.orig/xbmc/utils/RingBuffer.cpp	2010-02-08 18:53:42.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/utils/RingBuffer.cpp	2010-02-09 07:32:34.316928213 +0100
@@ -20,6 +20,8 @@
  */
 
 #include "RingBuffer.h"
+#include "SingleLock.h"
+
 #include <cstring>
 #include <cstdlib>
 #include <algorithm>
@@ -27,7 +29,6 @@
 /* Constructor */
 CRingBuffer::CRingBuffer()
 {
-  InitializeCriticalSection(&m_critSection);
   m_buffer = NULL;
   m_size = 0;
   m_readPtr = 0;
@@ -39,28 +40,25 @@
 CRingBuffer::~CRingBuffer()
 {
   Destroy();
-  DeleteCriticalSection(&m_critSection);
 }
 
 /* Create a ring buffer with the specified 'size' */
 bool CRingBuffer::Create(unsigned int size)
 {
-  EnterCriticalSection(&m_critSection);
+  CSingleLock lock(m_critSection);
   m_buffer = (char*)malloc(size);
   if (m_buffer != NULL)
   {
     m_size = size;
-    LeaveCriticalSection(&m_critSection);
     return true;
   }
-  LeaveCriticalSection(&m_critSection);
   return false;
 }
 
 /* Free the ring buffer and set all values to NULL or 0 */
 void CRingBuffer::Destroy()
 {
-  EnterCriticalSection(&m_critSection);
+  CSingleLock lock(m_critSection);
   if (m_buffer != NULL)
   {
     free(m_buffer);
@@ -70,17 +68,15 @@
   m_readPtr = 0;
   m_writePtr = 0;
   m_fillCount = 0;
-  LeaveCriticalSection(&m_critSection);
 }
 
 /* Clear the ring buffer */
 void CRingBuffer::Clear()
 {
-  EnterCriticalSection(&m_critSection);
+  CSingleLock lock(m_critSection);
   m_readPtr = 0;
   m_writePtr = 0;
   m_fillCount = 0;
-  LeaveCriticalSection(&m_critSection);
 }
 
 /* Read in data from the ring buffer to the supplied buffer 'buf'. The amount
@@ -88,10 +84,9 @@
  */
 bool CRingBuffer::ReadData(char *buf, unsigned int size)
 {
-  EnterCriticalSection(&m_critSection);
+  CSingleLock lock(m_critSection);
   if (size > m_fillCount)
   {
-    LeaveCriticalSection(&m_critSection);
     return false;
   }
   if (size + m_readPtr > m_size)
@@ -109,7 +104,6 @@
   if (m_readPtr == m_size)
     m_readPtr = 0;
   m_fillCount -= size;
-  LeaveCriticalSection(&m_critSection);
   return true;
 }
 
@@ -118,7 +112,7 @@
  */
 bool CRingBuffer::ReadData(CRingBuffer &rBuf, unsigned int size)
 {
-  EnterCriticalSection(&m_critSection);
+  CSingleLock lock(m_critSection);
   if (rBuf.getBuffer() == NULL)
     rBuf.Create(size);
 
@@ -133,7 +127,6 @@
       SkipBytes(size);
   }
 
-  LeaveCriticalSection(&m_critSection);
   return bOk;
 }
 
@@ -142,10 +135,9 @@
  */
 bool CRingBuffer::WriteData(char *buf, unsigned int size)
 {
-  EnterCriticalSection(&m_critSection);
+  CSingleLock lock(m_critSection);
   if (size > m_size - m_fillCount)
   {
-    LeaveCriticalSection(&m_critSection);
     return false;
   }
   if (size + m_writePtr > m_size)
@@ -163,7 +155,6 @@
   if (m_writePtr == m_size)
     m_writePtr = 0;
   m_fillCount += size;
-  LeaveCriticalSection(&m_critSection);
   return true;
 }
 
@@ -172,7 +163,7 @@
  */
 bool CRingBuffer::WriteData(CRingBuffer &rBuf, unsigned int size)
 {
-  EnterCriticalSection(&m_critSection);
+  CSingleLock lock(m_critSection);
   if (m_buffer == NULL)
     Create(size);
 
@@ -186,24 +177,21 @@
       bOk = WriteData(&rBuf.getBuffer()[0], size - chunksize);
   }
 
-  LeaveCriticalSection(&m_critSection);
   return bOk;
 }
 
 /* Skip bytes in buffer to be read */
 bool CRingBuffer::SkipBytes(int skipSize)
 {
-  EnterCriticalSection(&m_critSection);
+  CSingleLock lock(m_critSection);
   if (skipSize < 0)
   {
-    LeaveCriticalSection(&m_critSection);
     return false; // skipping backwards is not supported
   }
 
   unsigned int size = skipSize;
   if (size > m_fillCount)
   {
-    LeaveCriticalSection(&m_critSection);
     return false;
   }
   if (size + m_readPtr > m_size)
@@ -218,7 +206,6 @@
   if (m_readPtr == m_size)
     m_readPtr = 0;
   m_fillCount -= size;
-  LeaveCriticalSection(&m_critSection);
   return true;
 }
 
@@ -243,6 +230,7 @@
 
 unsigned int CRingBuffer::getSize()
 {
+  CSingleLock lock(m_critSection);
   return m_size;
 }
 
@@ -253,15 +241,18 @@
 
 unsigned int CRingBuffer::getWritePtr()
 {
+  CSingleLock lock(m_critSection);
   return m_writePtr;
 }
 
 unsigned int CRingBuffer::getMaxReadSize()
 {
+  CSingleLock lock(m_critSection);
   return m_fillCount;
 }
 
 unsigned int CRingBuffer::getMaxWriteSize()
 {
+  CSingleLock lock(m_critSection);
   return m_size - m_fillCount;
 }
diff -Naur xbmc-pvr-27594.orig/xbmc/utils/RingBuffer.h xbmc-pvr-27594.patch/xbmc/utils/RingBuffer.h
--- xbmc-pvr-27594.orig/xbmc/utils/RingBuffer.h	2010-01-24 11:50:44.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/utils/RingBuffer.h	2010-02-09 07:32:34.316928213 +0100
@@ -24,7 +24,7 @@
 
 class CRingBuffer
 {
-  CRITICAL_SECTION m_critSection;
+  CCriticalSection m_critSection;
   char *m_buffer;
   unsigned int m_size;
   unsigned int m_readPtr;
diff -Naur xbmc-pvr-27594.orig/xbmc/VideoDatabase.cpp xbmc-pvr-27594.patch/xbmc/VideoDatabase.cpp
--- xbmc-pvr-27594.orig/xbmc/VideoDatabase.cpp	2010-02-08 18:53:42.000000000 +0100
+++ xbmc-pvr-27594.patch/xbmc/VideoDatabase.cpp	2010-02-09 07:31:57.984772386 +0100
@@ -7035,7 +7035,7 @@
               CStdString strFanart;
               CUtil::ReplaceExtension(item.GetTBNFile(), "-fanart.jpg", strFanart);
 
-              if (CFile::Exists(item.GetCachedFanart(), false) && (overwrite || !CFile::Exists(strFanart), false))
+              if (CFile::Exists(item.GetCachedFanart(), false) && (overwrite || !CFile::Exists(strFanart, false)))
                 if (!CFile::Cache(item.GetCachedFanart(),strFanart))
                   CLog::Log(LOGERROR, "%s: Movie fanart export failed! ('%s' -> '%s')", __FUNCTION__, item.GetCachedFanart().c_str(), strFanart.c_str());
 
