#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build alsa
$SCRIPTS/build lame
$SCRIPTS/build libX11
$SCRIPTS/build libXinerama
$SCRIPTS/build freetype
$SCRIPTS/build qt-x11-opensource
#$SCRIPTS/build lirc
#$SCRIPTS/build lcd4linux

cd $PKG_BUILD

QMAKE=$ROOT/$TOOLCHAIN/bin/qmake \
QMAKESPEC=$SYSROOT_PREFIX/usr/mkspecs/linux-g++-cross \
QTDIR=$SYSROOT_PREFIX/usr \
  ./configure \
    --prefix=/usr \
    --enable-cross-compile \
    --sysroot=$SYSROOT_PREFIX \
    --cc=$TARGET_CC \
    --cxx=$TARGET_CXX \
    --qmake=$ROOT/$TOOLCHAIN/bin/qmake \
    --enable-proc-opt \
    --disable-audio-oss \
    --enable-audio-alsa \
    --disable-audio-arts \
    --disable-audio-jack \
    --disable-valgrind \
    --disable-lirc \
    --enable-joystick-menu \
    --enable-firewire \
    --enable-iptv \
    --disable-hdhomerun \
    --enable-v4l \
    --enable-ivtv \
    --enable-dvb --dvb-path=$LIB_PREFIX/include \
    --enable-x11 \
    --enable-xrandr \
    --enable-xv \
    --enable-xvmc \
    --disable-xvmcw \
    --disable-xvmc-pro \
    --disable-xvmc-vld \
    --disable-vdpau \
    --enable-opengl-video \
    --enable-opengl-vsync \
    --disable-mac-accel \
    --disable-directfb \
    --without-bindings=python,perl \

  $ROOT/$TOOLCHAIN/bin/qmake mythtv.pro

  make

  make INSTALL_ROOT=$SYSROOT_PREFIX install
