#!/bin/sh

. config/options

$SCRIPTS/build toolchain

# fribidi fails to compile with GCC 4.5.0's link time optimization.
  CFLAGS=`echo $CFLAGS | sed -e "s|-flto||" -e "s|-fuse-linker-plugin||" -e "s|-fwhole-program||"`
  CXXFLAGS=`echo $CXXFLAGS | sed -e "s|-flto||" -e "s|-fuse-linker-plugin||" -e "s|-fwhole-program||"`
  LDFLAGS=`echo $LDFLAGS | sed -e "s|-flto||" -e "s|-fuse-linker-plugin||" -e "s|-fwhole-program||"`

PKG_DIR=`find $PACKAGES -type d -name $1`

cd $PKG_BUILD
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=/usr \
            --disable-debug \
            --enable-malloc \
            --with-glib=no \
            --enable-shared \
            --disable-static \

make

$MAKEINSTALL
cp -f $ROOT/$PKG_DIR/scripts/$1-config $ROOT/$TOOLCHAIN/bin/$1-config
