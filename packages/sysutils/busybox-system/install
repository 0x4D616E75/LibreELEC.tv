#!/bin/sh

. config/options

$SCRIPTS/build busybox-hosttools

PKG_DIR=`find $PACKAGES -type d -name $1`

ROOT_PWD="`$ROOT/$TOOLCHAIN/bin/mkpasswd $ROOT_PASSWORD`"

  add_user root "$ROOT_PWD" 0 0 "Root User" "/storage" "/bin/sh"
  add_group root 0

  cp -PR $BUILD/busybox*/_install-system/* $INSTALL

  mkdir -p $INSTALL/bin
  ln -sf /bin/sh $INSTALL/bin/bash

  mkdir -p $INSTALL/etc
  cp $PKG_DIR/config/sysconfig $INSTALL/etc
  echo $ISSUE >  $INSTALL/etc/issue

  mkdir -p $INSTALL/usr/share/udhcpc
  cp $PKG_DIR/scripts/udhcp.script $INSTALL/usr/share/udhcpc/default.script

  mkdir -p $INSTALL/sbin
  cp $PKG_DIR/scripts/init $INSTALL/sbin/init.system

  # acpid specific
  mkdir -p $INSTALL/etc/acpi/PWRF
  cp $PKG_DIR/scripts/acpi_powerbtn $INSTALL/etc/acpi/PWRF/00000080
