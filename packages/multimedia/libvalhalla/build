#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build sqlite
$SCRIPTS/build ffmpeg-mt
$SCRIPTS/build libexif
$SCRIPTS/build libxml2
$SCRIPTS/build libnfo
$SCRIPTS/build curl

cd $PKG_BUILD
./configure --prefix=/usr \
            --disable-static \
            --enable-shared \
            --disable-optimize \
            --cross-compile \
            --disable-debug \
            --disable-doc \
            --enable-logcolor \
            --disable-grabber-dummy \
            --enable-grabber-allocine \
            --enable-grabber-amazon \
            --enable-grabber-exif \
            --enable-grabber-imdb \
            --enable-grabber-lastfm \
            --enable-grabber-local \
            --enable-grabber-lyricsfly \
            --enable-grabber-lyricwiki \
            --enable-grabber-nfo \
            --enable-grabber-tvdb \
            --enable-grabber-tmdb \
            --enable-grabber-tvrage \

make -C src
make test

$MAKEINSTALL -C src
cp -f libvalhalla.pc $SYSROOT_PREFIX/usr/lib/pkgconfig/
