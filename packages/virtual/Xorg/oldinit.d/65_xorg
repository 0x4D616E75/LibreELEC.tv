#!/bin/sh
#
# configure X.Org video settings
#
# runlevels: openelec, debug, configure

. /etc/sysconfig

echo "### starting Xorg ###"

#  modprobe drm
  mkdir -p /var/lib/xkb/

mount -o bind /storage /var/log
mount -o bind /storage /var/tmp

  # use Screen0 if present to workaround a bug with some graphic drivers
  # that report 2 screens and prevent Xorg from loading correctly
  SCREEN=
  [ -f /etc/X11/xorg.conf ] && grep -q Screen0 /etc/X11/xorg.conf && SCREEN="-screen Screen0"

  # starts X.org
  Xorg vt$TTY $SCREEN > /dev/null 2>&1 &
