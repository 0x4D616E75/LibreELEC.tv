#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build expat
$SCRIPTS/build libdaemon
$SCRIPTS/build dbus
$SCRIPTS/build Python
$SCRIPTS/build dbus-python
$SCRIPTS/build pygtk

. config/options.python

cd $BUILD/$1*

py_cv_mod_gtk_=yes \
py_cv_mod_dbus_=yes \
ac_cv_func_bind_textdomain_codeset=no \
ac_func_bind_textdomain_codeset=no \
ac_cv_lib_intl_bindtextdomain=no \
ac_cv_lib_intl_dcgettext=no \
ac_cv_lib_intl_ngettext=no \
gt_cv_func_ngettext_libc=no \
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=/usr \
            --sysconfdir=/etc \
            --localstatedir=/var \
            --disable-static \
            --enable-shared \
            --with-distro=none \
            --disable-glib \
            --disable-gobject \
            --disable-qt3 \
            --disable-qt4 \
            --disable-gtk \
            --enable-dbus \
            --disable-dbm \
            --disable-gdbm \
            --enable-libdaemon \
            --enable-python \
            --enable-pygtk \
            --enable-python-dbus \
            --disable-mono \
            --disable-monodoc \
            --enable-autoipd \
            --disable-doxygen-doc \
            --disable-doxygen-dot \
            --disable-doxygen-man \
            --disable-doxygen-rtf \
            --disable-doxygen-xml \
            --disable-doxygen-chm \
            --disable-doxygen-chi \
            --disable-doxygen-html \
            --disable-doxygen-ps \
            --disable-doxygen-pdf \
            --disable-core-docs \
            --disable-manpages \
            --disable-xmltoman \
            --disable-tests \
            --disable-compat-libdns_sd \
            --disable-compat-howl \
            --with-xml=expat \
            --with-avahi-user=root \
            --with-avahi-group=root \
            --with-autoipd-user=root \
            --with-autoipd-group=root \
            --disable-nls

make

#$STRIP plugins/.libs/*.so

$MAKEINSTALL

$PYTHON -Wi -t $PYTHON_LIBDIR/compileall.py avahi-python/avahi
