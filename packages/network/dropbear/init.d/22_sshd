# start telnet daemon
#
# runlevels: openelec, text, debug

(
  # Check for the Dropbear RSA key
    if [ ! -f /etc/dropbear/dropbear_rsa_host_key ] ; then
      progress "SSH: generating rsa key"

      mkdir -p /etc/dropbear
      /usr/bin/dropbearkey -t rsa -f /etc/dropbear/dropbear_rsa_host_key > /dev/null 2>&1
    fi

  # Check for the Dropbear DSS key
    if [ ! -f /etc/dropbear/dropbear_dss_host_key ] ; then
      progress "SSH: generating dsa key"

      mkdir -p /etc/dropbear
      /usr/bin/dropbearkey -t dss -f /etc/dropbear/dropbear_dss_host_key > /dev/null 2>&1
    fi

  progress "Starting SSH Server"

  mkdir -p /var/log
    touch /var/log/lastlog
    touch /var/log/wtmp

  dropbear -b /etc/issue -P /var/run/dropbear.pid

)&
