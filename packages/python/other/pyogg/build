#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build Python
$SCRIPTS/build libogg

. config/options.python

PYTHON_LIB_DIR=`ls -d $SYSROOT_PREFIX/usr/lib/python*`

cd $BUILD/$1*

echo "ogg_include_dir = $SYSROOT_PREFIX/usr/include" > Setup
echo "ogg_lib_dir = $SYSROOT_PREFIX/usr/lib" >> Setup
echo "ogg_libs = ogg" >> Setup

$PYTHON setup.py build

$PYTHON -Wi -t $PYTHON_LIBDIR/compileall.py build

mkdir -p $PYTHON_LIB_DIR/site-packages/ogg
cp build/lib*/ogg/*.so $PYTHON_LIB_DIR/site-packages/ogg
cp build/lib*/ogg/*.pyc $PYTHON_LIB_DIR/site-packages/ogg

cp -PR include/* $SYSROOT_PREFIX/usr/include
