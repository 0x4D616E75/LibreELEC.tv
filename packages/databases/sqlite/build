#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build readline
$SCRIPTS/build ncurses

export config_BUILD_CC="$HOST_CC"
export config_BUILD_CFLAGS="$HOST_CFLAGS"
export config_BUILD_LIBS="$HOST_LDFLAGS"
export config_TARGET_CC="$CC"
export config_TARGET_LINK="$LD"
export config_TARGET_CFLAGS="$CFLAGS"
export config_TARGET_LFLAGS="$LDFLAGS"
export config_TARGET_LIBS="-lncurses"
export config_TARGET_READLINE_LIBS="-L$SYSROOT_PREFIX/usr/lib"
export config_TARGET_READLINE_INC="-I$SYSROOT_PREFIX/usr/include/readline -lreadline"

cd $BUILD/$1*

./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=/usr \
            --sysconfdir=/etc \
            --disable-static \
            --enable-shared \
            --disable-tcl \
            --enable-threadsafe

make

$STRIP .libs/*.so*
$STRIP .libs/sqlite3

$MAKEINSTALL
